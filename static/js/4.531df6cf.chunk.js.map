{"version":3,"sources":["../node_modules/framer-motion/dist/es/utils/shallow-compare.js","../node_modules/popmotion/dist/es/utils/clamp.js","../node_modules/popmotion/dist/es/animations/utils/find-spring.js","../node_modules/popmotion/dist/es/animations/generators/spring.js","../node_modules/popmotion/dist/es/utils/progress.js","../node_modules/popmotion/dist/es/utils/mix.js","../node_modules/style-value-types/dist/es/color/utils.js","../node_modules/style-value-types/dist/es/color/rgba.js","../node_modules/style-value-types/dist/es/color/hex.js","../node_modules/style-value-types/dist/es/color/hsla.js","../node_modules/popmotion/dist/es/utils/mix-color.js","../node_modules/style-value-types/dist/es/color/index.js","../node_modules/style-value-types/dist/es/complex/index.js","../node_modules/popmotion/dist/es/utils/inc.js","../node_modules/popmotion/dist/es/utils/pipe.js","../node_modules/popmotion/dist/es/utils/mix-complex.js","../node_modules/popmotion/dist/es/utils/interpolate.js","../node_modules/popmotion/dist/es/easing/utils.js","../node_modules/popmotion/dist/es/easing/index.js","../node_modules/popmotion/dist/es/animations/generators/keyframes.js","../node_modules/popmotion/dist/es/animations/utils/detect-animation-from-options.js","../node_modules/popmotion/dist/es/animations/generators/decay.js","../node_modules/framesync/dist/es/on-next-frame.js","../node_modules/framesync/dist/es/index.js","../node_modules/framesync/dist/es/create-render-step.js","../node_modules/popmotion/dist/es/animations/utils/elapsed.js","../node_modules/popmotion/dist/es/animations/index.js","../node_modules/popmotion/dist/es/utils/velocity-per-second.js","../node_modules/framer-motion/dist/es/utils/time-conversion.js","../node_modules/popmotion/dist/es/easing/cubic-bezier.js","../node_modules/framer-motion/dist/es/animation/utils/easing.js","../node_modules/framer-motion/dist/es/animation/utils/is-animatable.js","../node_modules/framer-motion/dist/es/animation/utils/default-transitions.js","../node_modules/style-value-types/dist/es/complex/filter.js","../node_modules/framer-motion/dist/es/render/dom/value-types/defaults.js","../node_modules/framer-motion/dist/es/render/dom/value-types/animatable-none.js","../node_modules/framer-motion/dist/es/animation/utils/transitions.js","../node_modules/popmotion/dist/es/animations/inertia.js","../node_modules/framer-motion/dist/es/utils/is-numerical-string.js","../node_modules/framer-motion/dist/es/utils/array.js","../node_modules/framer-motion/dist/es/utils/subscription-manager.js","../node_modules/framer-motion/dist/es/value/index.js","../node_modules/framer-motion/dist/es/render/dom/value-types/test.js","../node_modules/framer-motion/dist/es/render/utils/types.js","../node_modules/framer-motion/dist/es/render/dom/value-types/dimensions.js","../node_modules/framer-motion/dist/es/render/dom/value-types/type-auto.js","../node_modules/framer-motion/dist/es/render/dom/value-types/find.js","../node_modules/framer-motion/dist/es/render/utils/setters.js","../node_modules/framer-motion/dist/es/render/utils/animation.js","../node_modules/framer-motion/dist/es/render/utils/animation-state.js","../node_modules/framer-motion/dist/es/motion/utils/make-renderless-component.js","../node_modules/framer-motion/dist/es/motion/features/animations.js","../node_modules/framer-motion/dist/es/events/use-dom-event.js","../node_modules/framer-motion/dist/es/gestures/utils/event-type.js","../node_modules/framer-motion/dist/es/events/event-info.js","../node_modules/framer-motion/dist/es/events/use-pointer-event.js","../node_modules/framer-motion/dist/es/events/utils.js","../node_modules/framer-motion/dist/es/gestures/drag/utils/lock.js","../node_modules/framer-motion/dist/es/gestures/use-hover-gesture.js","../node_modules/framer-motion/dist/es/gestures/utils/is-node-or-child.js","../node_modules/framer-motion/dist/es/motion/features/gestures.js","../node_modules/framer-motion/dist/es/components/AnimateSharedLayout/types.js","../node_modules/framer-motion/dist/es/gestures/use-tap-gesture.js","../node_modules/framer-motion/dist/es/utils/use-unmount-effect.js","../node_modules/framer-motion/dist/es/gestures/use-focus-gesture.js","../node_modules/framer-motion/dist/es/utils/each-axis.js","../node_modules/framer-motion/dist/es/utils/noop.js","../node_modules/framer-motion/dist/es/utils/geometry/index.js","../node_modules/framer-motion/dist/es/render/utils/is-draggable.js","../node_modules/framer-motion/dist/es/utils/geometry/delta-apply.js","../node_modules/popmotion/dist/es/utils/is-point.js","../node_modules/popmotion/dist/es/utils/is-point-3d.js","../node_modules/popmotion/dist/es/utils/distance.js","../node_modules/framer-motion/dist/es/utils/geometry/delta-calc.js","../node_modules/framer-motion/dist/es/render/utils/state.js","../node_modules/framer-motion/dist/es/render/html/utils/build-projection-transform.js","../node_modules/framer-motion/dist/es/render/utils/lifecycles.js","../node_modules/framer-motion/dist/es/render/utils/projection.js","../node_modules/framer-motion/dist/es/render/utils/compare-by-depth.js","../node_modules/framer-motion/dist/es/render/utils/flat-tree.js","../node_modules/framer-motion/dist/es/motion/features/layout/utils.js","../node_modules/framer-motion/dist/es/render/dom/projection/relative-set.js","../node_modules/framer-motion/dist/es/render/index.js","../node_modules/framer-motion/dist/es/render/utils/motion-values.js","../node_modules/framer-motion/dist/es/render/dom/projection/measure.js","../node_modules/framer-motion/dist/es/render/dom/utils/css-variables-conversion.js","../node_modules/framer-motion/dist/es/render/dom/utils/unit-conversion.js","../node_modules/framer-motion/dist/es/render/dom/utils/parse-dom-variant.js","../node_modules/framer-motion/dist/es/render/html/visual-element.js","../node_modules/framer-motion/dist/es/render/svg/visual-element.js","../node_modules/framer-motion/dist/es/render/dom/features-animation.js","../node_modules/framer-motion/dist/es/render/dom/create-visual-element.js"],"names":["shallowCompare","next","prev","Array","isArray","prevLength","length","i","clamp","min","max","v","Math","safeMin","findSpring","_a","envelope","derivative","_b","duration","_c","bounce","_d","velocity","_e","mass","warning","maxDuration","dampingRatio","undampedFreq","exponentialDecay","delta","a","b","calcAngularFreq","c","exp","d","e","pow","f","g","initialGuess","result","approximateRoot","isNaN","stiffness","damping","sqrt","durationKeys","physicsKeys","isSpringType","options","keys","some","key","undefined","spring","from","to","restSpeed","restDelta","__rest","state","done","value","springOptions","__assign","isResolvedFromDuration","derived","getSpringOptions","resolveSpring","zero","resolveVelocity","createSpring","initialVelocity","initialDelta","undampedAngularFreq","abs","angularFreq_1","t","sin","cos","dampedAngularFreq_1","freqForT","sinh","cosh","current","currentVelocity","isBelowVelocityThreshold","isBelowDisplacementThreshold","flipTarget","needsInterpolation","_t","progress","toFromDifference","mix","isColorString","type","testProp","Boolean","isString","singleColorRegex","test","startsWith","Object","prototype","hasOwnProperty","call","splitColor","aName","bName","cName","match","floatRegex","alpha","parseFloat","clampRgbUnit","rgbUnit","number","transform","round","rgba","parse","red","green","blue","alpha$1","sanitize","hex","r","substr","parseInt","hsla","hue","saturation","lightness","percent","mixLinearColor","fromExpo","toExpo","colorTypes","getColorType","find","notAnimatable","color","mixColor","fromColorType","toColorType","invariant","fromColor","toColor","blended","mixFunc","colorToken","numberToken","analyse","values","numColors","colors","colorRegex","replace","push","apply","map","numbers","tokenised","createTransformer","numValues","output","convertNumbersToZero","complex","getAnimatableNone","parsed","transformer","isNum","combineFunctions","pipe","transformers","_i","arguments","reduce","getMixer","origin","target","mixComplex","mixArray","__spreadArray","blendValue","fromThis","mixObject","numNumbers","numRGB","numHSL","template","originStats","targetStats","mixNumber","p","createMixers","ease","customMixer","mixers","mixerFactory","numMixers","mixer","easingFunction","interpolate","input","isClamp","inputLength","concat","reverse","interpolator","fastInterpolate","lastInputIndex","mixerIndex","foundMixerIndex","progressInRange","slowInterpolate","power","reverseEasing","easing","mirrorEasing","createBackIn","linear","easeIn","easeOut","easeInOut","circIn","acos","circOut","circInOut","backIn","backOut","backInOut","anticipate","backEasing","createAnticipate","bounceOut","p2","bounceIn","defaultEasing","splice","keyframes","offset","times","o","convertOffsetToTimes","_value","defaultOffset","createInterpolator","types","decay","timeConstant","_f","modifyTarget","amplitude","ideal","defaultTimestep","getCurrentTime","performance","now","Date","onNextFrame","window","callback","requestAnimationFrame","setTimeout","useDefaultElapsed","runNextFrame","isProcessing","frame","timestamp","stepsOrder","steps","acc","toRun","toRunNextFrame","numToRun","toKeepAlive","WeakSet","step","schedule","keepAlive","immediate","addToCurrentFrame","buffer","add","indexOf","cancel","index","delete","process","frameData","has","createRenderStep","sync","startLoop","cancelSync","processStep","stepId","processFrame","forEach","getFrameData","loopElapsed","elapsed","delay","framesync","update","passTimestamp","start","stop","animate","driverControls","latest","interpolateFromNumber","autoplay","driver","_g","repeat","repeatMax","_h","repeatType","_j","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate","repeatCount","computedDuration","isComplete","isForwardPlayback","animator","config","Set","detectAnimationFromOptions","animation","reverseElapsed","hasRepeatDelayElapsed","velocityPerSecond","frameDuration","secondsToMilliseconds","seconds","a1","a2","calcBezier","getSlope","kSampleStepSize","cubicBezier","mX1","mY1","mX2","mY2","sampleValues","Float32Array","getTForX","aX","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","binarySubdivide","easingLookup","bounceInOut","easingDefinitionToFunction","definition","__read","isAnimatable","underDampedSpring","criticallyDampedSpring","linearTween","defaultTransitions","x","y","z","rotate","rotateX","rotateY","rotateZ","scaleX","scaleY","scale","opacity","backgroundColor","default","maxDefaults","applyDefaultFilter","slice","split","name","unit","defaultValue","functionRegex","filter","functions","join","defaultValueTypes","numberValueTypes","outlineColor","fill","stroke","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","WebkitFilter","getDefaultValueType","defaultValueType","legacyRepeatWarning","convertTransitionToAnimationOptions","yoyo","flip","loop","transition","isEasingArray","getPopmotionAnimationOptions","hydrateKeyframes","when","delayChildren","staggerChildren","staggerDirection","isTransitionDefined","valueKey","transitionFactory","isKeyframesTarget","getDefaultTransition","getAnimation","valueTransition","getValueTransition","get","isTargetAnimatable","isZero","getZeroUnit","isOriginAnimatable","getVelocity","set","currentAnimation","bounceStiffness","bounceDamping","isOutOfBounds","boundaryNearest","startAnimation","startSpring","prev_1","current_1","boundary_1","heading_1","inertia","potentialUnitType","delayTimer","controls","getDelayFromTransition","clearTimeout","addUniqueItem","arr","item","removeItem","SubscriptionManager","this","subscriptions","handler","_this","notify","numSubscriptions","getSize","clear","MotionValue","init","timeDelta","lastUpdated","updateSubscribers","velocityUpdateSubscribers","renderSubscribers","canTrackVelocity","updateAndNotify","render","postRender","scheduleVelocityCheck","velocityCheck","hasAnimated","onChange","subscription","clearListeners","onRenderRequest","attach","passiveEffect","getPrevious","Promise","resolve","stopAnimation","then","clearAnimation","isAnimating","destroy","motionValue","AnimationType","testValueType","dimensionValueTypes","px","degrees","vw","vh","findDimensionValueType","valueTypes","findValueType","setMotionValue","visualElement","hasValue","getValue","addValue","setTarget","resolved","resolveVariant","makeTargetAnimatable","transitionEnd","resolveFinalValueInKeyframes","getOriginFromTransition","animateVariant","variant","custom","transitionOverride","animateTarget","getChildAnimations","variantChildren","size","forwardDelay","animations","maxStaggerDuration","generateStaggerDuration","sort","sortByTreeOrder","child","notifyAnimationComplete","all","animateChildren","first","last","animationTypeState","animationState","getState","valueTarget","shouldBlockAnimation","sortNodePosition","protectedKeys","needsAnimating","shouldBlock","variantPriorityOrder","Animate","Hover","Tap","Drag","Focus","Exit","reversePriorityOrder","numAnimationTypes","animateList","notifyAnimationStart","resolvedDefinition","animateVisualElement","createAnimationState","createTypeState","createState","allAnimatedKeys","isInitialRender","buildResolvedTypeValues","animateChanges","changedActiveType","props","getProps","context","getVariantContext","removedKeys","encounteredKeys","removedVariantIndex","Infinity","_loop_1","typeState","prop","propIsVariant","isVariantLabel","activeDelta","isActive","isInherited","manuallyAnimateOnMount","prevProp","isAnimationControls","shouldAnimateType","isVariantLabels","variantsHaveChanged","definitionList","resolvedValues","prevResolvedValues","allKeys","markToAnimate","blockInitialAnimation","fallbackAnimation_1","fallbackTarget","getBaseTarget","shouldAnimate","initial","isAnimated","setActive","setAnimateFunction","makeAnimator","makeRenderlessComponent","hook","useEffect","subscribe","exit","usePresence","isPresent","onExitComplete","presenceContext","useContext","PresenceContext","addDomEvent","eventName","addEventListener","removeEventListener","useDomEvent","ref","element","isTouchEvent","event","touches","defaultPagePoint","pageX","pageY","pointFromTouch","pointType","point","changedTouches","pointFromMouse","extractEventInfo","wrapHandler","shouldFilterPrimaryPointer","eventHandler","listener","isMouseEvent","MouseEvent","button","mouseEventNames","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","pointerenter","pointerleave","touchEventNames","getPointerEventName","isBrowser","onpointerdown","ontouchstart","onmousedown","addPointerEvent","usePointerEvent","createLock","lock","globalHorizontalLock","globalVerticalLock","isDragActive","openGestureLock","drag","openHorizontal_1","openVertical_1","getGlobalLock","createHoverEvent","info","PointerEvent","pointerType","isNodeOrChild","parent","parentElement","Presence","VisibilityAction","gestureAnimations","tap","onTap","onTapStart","onTapCancel","whileTap","hasPressListeners","isPressing","useRef","cancelPointerEndListeners","removePointerEndListener","checkPointerEnd","onPointerUp","getInstance","onPointerCancel","focus","whileFocus","hover","onHoverStart","onHoverEnd","whileHover","eachAxis","noop","any","zeroDelta","translate","originPoint","isDraggable","_dragX","resetAxis","axis","originAxis","scalePoint","applyPointDelta","boxScale","applyAxisDelta","applyBoxDelta","box","applyAxisTransforms","final","transforms","scaleKey","originKey","axisOrigin","xKeys","yKeys","applyBoxTransforms","finalBox","removePointDelta","removeAxisTransforms","removeAxisDelta","isPoint","isPoint3D","distance1D","isNear","maxDistance","xDelta","yDelta","zDelta","distance","calcLength","updateAxisDelta","source","updateBoxDelta","defaultOrigin","originX","originY","calcRelativeAxis","relative","createLayoutState","isHydrated","layout","layoutCorrected","treeScale","deltaFinal","deltaTransform","zeroLayout","buildLayoutProjectionTransform","latestTransform","identityProjection","buildLayoutProjectionTransformOrigin","names","updateLayoutDeltas","treePath","transformOrigin","originBox","treeLength","node","getLayoutState","getLatestValues","applyTreeDeltas","compareByDepth","depth","FlatTree","children","isDirty","remove","calcRelativeOffsetAxis","setCurrentViewportBox","projectionParent","getProjectionParent","relativeOffset","setProjectionTargetAxis","rebaseProjectionTarget","treeType","build","measureViewportBox","renderInstance","readValueFromInstance","resetTransform","restoreTransform","removeValueFromRenderState","scrapeMotionValuesFromProps","presenceId","visualState","instance","unsubscribeFromLeadVisualElement","crossfader","projectionTargetProgress","removeFromVariantTree","latestValues","renderState","lifecycles","managers","propSubscriptions","clearAllListeners","manager","updatePropListeners","on","propListener","args","createLifecycles","projection","isEnabled","isTargetLocked","targetFinal","leadProjection","leadLatestValues","layoutState","hasViewportBoxUpdated","Map","valueSubscriptions","prevMotionValues","baseTarget","isProjectionReady","triggerBuild","valuesToRender","crossfadedValues","getCrossfadeState","notifyUpdate","updateTreeLayoutProjection","layoutTree","fireUpdateLayoutProjection","initialMotionValues","isMotionValue","isControllingVariants","checkIfControllingVariants","isVariantNode","checkIfVariantNode","path","isVisible","isMounted","mount","newInstance","pointTo","addVariantChild","unmount","preRender","updateLayoutProjection","stopLayoutAnimation","closestVariantNode","getClosestVariantNode","other","scheduleUpdateLayoutProjection","getLayoutId","layoutId","getStaticValue","setStaticValue","setVisibility","visibility","scheduleRender","canMutate","removeValue","removeOnChange","latestValue","removeOnRenderRequest","bindToMotionValue","forEachValue","readValue","setBaseTarget","syncRender","setProps","newProps","nextValue","prevValue","existingValue","updateMotionValuesFromProps","getVariant","variants","startAtParent","context_1","numVariantProps","name_1","variantProps","enableLayoutProjection","lockProjectionTarget","unlockProjectionTarget","setCrossfader","newCrossfader","startLayoutAnimation","isRelative","getProjectionAnimationProgress","relativeTarget","animateMotionValue","withTransform","viewportBox","notifySetAxisTarget","force","shouldRebase","notifyLayoutReady","notifyLayoutUpdate","prevViewportBox","prevTreeScaleX","prevTreeScaleY","prevDeltaTransform","notifyViewportBoxUpdate","fireResolveRelativeTargetBox","foundParent","ancestor","resolveRelativeTargetBox","relativeParent","parentProjection","calcRelativeBox","shouldResetTransform","_layoutResetTransform","newLead","onSetAxisTarget","onLayoutAnimationComplete","presence","Present","layoutSafeToRemove","Entering","getBoundingBox","transformPagePoint","top","left","right","bottom","convertBoundingBoxToAxisBox","transformPoint","topLeft","bottomRight","transformBoundingBox","getBoundingClientRect","isCSSVariable","cssVariableRegex","getVariableValue","exec","parseCSSVariable","token","fallback","getComputedStyle","getPropertyValue","trim","BoundingBoxDimension","positionalKeys","isPositionalKey","setAndResetVelocity","isNumOrPxType","getPosFromMatrix","matrix","pos","getTranslateFromMatrix","pos2","pos3","_bbox","matrix3d","transformKeys","nonTranslationalTransformKeys","transformProps","positionalValues","width","height","checkAndConvertChangedValueTypes","targetPositionalKeys","removedTransformValues","hasAttemptedToRemoveTransformValues","changedValueTypeKeys","toType","fromType","numKeyframes","removedTransforms","removeNonTranslationalTransform","convertedTarget","changedKeys","originBbox","elementComputedStyle","display","originComputedStyle","targetBbox","convertChangedValueTypes","unitConversion","hasPositionalKey","parseDomVariant","HTMLElement","resolveCSSVariables","htmlConfig","domElement","isTransformProp","defaultType","computedStyle","compareDocumentPosition","style","transformTemplate","mutableState","vars","transformValues","getOrigin","newValueKeys","numNewValues","targetValue","checkTargetForNewValues","isProjectionTranform","buildHTMLStyles","renderHTML","htmlVisualElement","svgVisualElement","camelCaseAttributes","camelToDash","getAttribute","_element","buildSVGAttrs","renderSVG","domAnimation","renderer","Component","isSVGComponent","enableHardwareAcceleration"],"mappings":"kLAAA,SAASA,EAAeC,EAAMC,GAC1B,IAAKC,MAAMC,QAAQF,GACf,OAAO,EACX,IAAIG,EAAaH,EAAKI,OACtB,GAAID,IAAeJ,EAAKK,OACpB,OAAO,EACX,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAYE,IAC5B,GAAIL,EAAKK,KAAON,EAAKM,GACjB,OAAO,EAEf,OAAO,E,YCVPC,EAAQ,SAAUC,EAAKC,EAAKC,GAC5B,OAAOC,KAAKH,IAAIG,KAAKF,IAAIC,EAAGF,GAAMC,ICElCG,EAAU,KAKd,SAASC,EAAWC,GAChB,IACIC,EACAC,EAFAC,EAAKH,EAAGI,SAAUA,OAAkB,IAAPD,EAAgB,IAAMA,EAAIE,EAAKL,EAAGM,OAAQA,OAAgB,IAAPD,EAAgB,IAAOA,EAAIE,EAAKP,EAAGQ,SAAUA,OAAkB,IAAPD,EAAgB,EAAIA,EAAIE,EAAKT,EAAGU,KAAMA,OAAc,IAAPD,EAAgB,EAAIA,EAG7ME,YAAQP,GAAYQ,IAAoB,8CACxC,IAAIC,EAAe,EAAIP,EACvBO,EAAepB,EARF,IACA,EAOgCoB,GAC7CT,EAAWX,EAXG,IACA,GAU6BW,EAAW,KAClDS,EAAe,GACfZ,EAAW,SAAUa,GACjB,IAAIC,EAAmBD,EAAeD,EAClCG,EAAQD,EAAmBX,EAC3Ba,EAAIF,EAAmBP,EACvBU,EAAIC,EAAgBL,EAAcD,GAClCO,EAAIvB,KAAKwB,KAAKL,GAClB,OAAOlB,EAAWmB,EAAIC,EAAKE,GAE/BlB,EAAa,SAAUY,GACnB,IACIE,EADmBF,EAAeD,EACPT,EAC3BkB,EAAIN,EAAQR,EAAWA,EACvBe,EAAI1B,KAAK2B,IAAIX,EAAc,GAAKhB,KAAK2B,IAAIV,EAAc,GAAKV,EAC5DqB,EAAI5B,KAAKwB,KAAKL,GACdU,EAAIP,EAAgBtB,KAAK2B,IAAIV,EAAc,GAAID,GAEnD,QADcZ,EAASa,GAAgBhB,EAAU,GAAK,EAAI,KACvCwB,EAAIC,GAAKE,GAAMC,KAItCzB,EAAW,SAAUa,GAGjB,OAFQjB,KAAKwB,KAAKP,EAAeV,KACxBU,EAAeN,GAAYJ,EAAW,GACxC,MAEXF,EAAa,SAAUY,GAGnB,OAFQjB,KAAKwB,KAAKP,EAAeV,IACIA,EAAWA,GAAvCI,EAAWM,MAI5B,IACIA,EAmBR,SAAyBb,EAAUC,EAAYyB,GAE3C,IADA,IAAIC,EAASD,EACJnC,EAAI,EAAGA,EAHC,GAGmBA,IAChCoC,GAAkB3B,EAAS2B,GAAU1B,EAAW0B,GAEpD,OAAOA,EAxBYC,CAAgB5B,EAAUC,EAD1B,EAAIE,GAGvB,GADAA,GAAsB,IAClB0B,MAAMhB,GACN,MAAO,CACHiB,UAAW,IACXC,QAAS,GACT5B,SAAUA,GAId,IAAI2B,EAAYlC,KAAK2B,IAAIV,EAAc,GAAKJ,EAC5C,MAAO,CACHqB,UAAWA,EACXC,QAAwB,EAAfnB,EAAmBhB,KAAKoC,KAAKvB,EAAOqB,GAC7C3B,SAAUA,GAYtB,SAASe,EAAgBL,EAAcD,GACnC,OAAOC,EAAejB,KAAKoC,KAAK,EAAIpB,EAAeA,GCzEvD,IAAIqB,EAAe,CAAC,WAAY,UAC5BC,EAAc,CAAC,YAAa,UAAW,QAC3C,SAASC,EAAaC,EAASC,GAC3B,OAAOA,EAAKC,MAAK,SAAUC,GAAO,YAAwBC,IAAjBJ,EAAQG,MAYrD,SAASE,EAAO1C,GACZ,IAAIG,EAAKH,EAAG2C,KAAMA,OAAc,IAAPxC,EAAgB,EAAMA,EAAIE,EAAKL,EAAG4C,GAAIA,OAAY,IAAPvC,EAAgB,EAAMA,EAAIE,EAAKP,EAAG6C,UAAWA,OAAmB,IAAPtC,EAAgB,EAAIA,EAAIuC,EAAY9C,EAAG8C,UAAWT,EAAUU,YAAO/C,EAAI,CAAC,OAAQ,KAAM,YAAa,cAC5NgD,EAAQ,CAAEC,MAAM,EAAOC,MAAOP,GAC9BlC,EAbR,SAA0B4B,GACtB,IAAIc,EAAgBC,YAAS,CAAE5C,SAAU,EAAKuB,UAAW,IAAKC,QAAS,GAAItB,KAAM,EAAK2C,wBAAwB,GAAShB,GACvH,IAAKD,EAAaC,EAASF,IACvBC,EAAaC,EAASH,GAAe,CACrC,IAAIoB,EAAUvD,EAAWsC,IACzBc,EAAgBC,YAASA,YAASA,YAAS,GAAID,GAAgBG,GAAU,CAAE9C,SAAU,EAAKE,KAAM,KAClF2C,wBAAyB,EAE3C,OAAOF,EAKEI,CAAiBlB,GAAUN,EAAYtB,EAAGsB,UAAWC,EAAUvB,EAAGuB,QAAStB,EAAOD,EAAGC,KAAMF,EAAWC,EAAGD,SAAUJ,EAAWK,EAAGL,SAAUiD,EAAyB5C,EAAG4C,uBAC5KG,EAAgBC,EAChBC,EAAkBD,EACtB,SAASE,IACL,IAAIC,EAAkBpD,GAAaA,EAAW,IAAQ,EAClDqD,EAAejB,EAAKD,EACpB9B,EAAemB,GAAW,EAAInC,KAAKoC,KAAKF,EAAYrB,IACpDoD,EAAsBjE,KAAKoC,KAAKF,EAAYrB,GAAQ,IAExD,GADc,OAAdoC,QAAoC,IAAdA,IAAoCA,EAAYjD,KAAKkE,IAAInB,EAAKD,IAAS,EAAI,IAAO,IACpG9B,EAAe,EAAG,CAClB,IAAImD,EAAgB7C,EAAgB2C,EAAqBjD,GACzD2C,EAAgB,SAAUS,GACtB,IAAIhE,EAAWJ,KAAKwB,KAAKR,EAAeiD,EAAsBG,GAC9D,OAAQrB,EACJ3C,IACO2D,EACC/C,EAAeiD,EAAsBD,GACrCG,EACAnE,KAAKqE,IAAIF,EAAgBC,GACzBJ,EAAehE,KAAKsE,IAAIH,EAAgBC,KAExDP,EAAkB,SAAUO,GACxB,IAAIhE,EAAWJ,KAAKwB,KAAKR,EAAeiD,EAAsBG,GAC9D,OAAQpD,EACJiD,EACA7D,GACEJ,KAAKqE,IAAIF,EAAgBC,IACtBL,EACG/C,EACIiD,EACAD,GACRG,EACAH,EAAehE,KAAKsE,IAAIH,EAAgBC,IAC5ChE,GACKJ,KAAKsE,IAAIH,EAAgBC,IACrBL,EACG/C,EACIiD,EACAD,GACRG,EACIH,EACAhE,KAAKqE,IAAIF,EAAgBC,UAG5C,GAAqB,IAAjBpD,EACL2C,EAAgB,SAAUS,GACtB,OAAOrB,EACH/C,KAAKwB,KAAKyC,EAAsBG,IAC3BJ,GACID,EAAkBE,EAAsBD,GACrCI,QAGnB,CACD,IAAIG,EAAsBN,EAAsBjE,KAAKoC,KAAKpB,EAAeA,EAAe,GACxF2C,EAAgB,SAAUS,GACtB,IAAIhE,EAAWJ,KAAKwB,KAAKR,EAAeiD,EAAsBG,GAC1DI,EAAWxE,KAAKH,IAAI0E,EAAsBH,EAAG,KACjD,OAAQrB,EACH3C,IACK2D,EACE/C,EAAeiD,EAAsBD,GACrChE,KAAKyE,KAAKD,GACVD,EACIP,EACAhE,KAAK0E,KAAKF,IAClBD,IAKpB,OADAT,IACO,CACHzE,KAAM,SAAU+E,GACZ,IAAIO,EAAUhB,EAAcS,GAC5B,GAAKZ,EAQDL,EAAMC,KAAOgB,GAAK7D,MARO,CACzB,IAAIqE,EAAuC,IAArBf,EAAgBO,GAClCS,EAA2B7E,KAAKkE,IAAIU,IAAoB5B,EACxD8B,EAA+B9E,KAAKkE,IAAInB,EAAK4B,IAAY1B,EAC7DE,EAAMC,KACFyB,GAA4BC,EAMpC,OADA3B,EAAME,MAAQF,EAAMC,KAAOL,EAAK4B,EACzBxB,GAEX4B,WAAY,WACR,IAAI5E,EACJQ,GAAYA,EACKmC,GAAjB3C,EAAK,CAAC4C,EAAID,IAAiB,GAAIC,EAAK5C,EAAG,GACvC2D,MAIZjB,EAAOmC,mBAAqB,SAAU5D,EAAGC,GACrC,MAAoB,kBAAND,GAA+B,kBAANC,GAE3C,IAAIuC,EAAO,SAAUqB,GAAM,OAAO,GCvH9BC,EAAW,SAAUpC,EAAMC,EAAIM,GAC/B,IAAI8B,EAAmBpC,EAAKD,EAC5B,OAA4B,IAArBqC,EAAyB,GAAK9B,EAAQP,GAAQqC,GCFrDC,EAAM,SAAUtC,EAAMC,EAAImC,GAC1B,OAAQA,EAAWpC,EAAOoC,EAAWnC,EAAKD,G,gBCC1CuC,EAAgB,SAAUC,EAAMC,GAAY,OAAO,SAAUxF,GAC7D,OAAOyF,QAASC,YAAS1F,IAAM2F,IAAiBC,KAAK5F,IAAMA,EAAE6F,WAAWN,IACnEC,GAAYM,OAAOC,UAAUC,eAAeC,KAAKjG,EAAGwF,MAEzDU,EAAa,SAAUC,EAAOC,EAAOC,GAAS,OAAO,SAAUrG,GAC/D,IAAII,EACJ,IAAKsF,YAAS1F,GACV,OAAOA,EACX,IAAIO,EAAKP,EAAEsG,MAAMC,KAAalF,EAAId,EAAG,GAAIe,EAAIf,EAAG,GAAIiB,EAAIjB,EAAG,GAAIiG,EAAQjG,EAAG,GAC1E,OAAOH,EAAK,IACL+F,GAASM,WAAWpF,GACvBjB,EAAGgG,GAASK,WAAWnF,GACvBlB,EAAGiG,GAASI,WAAWjF,GACvBpB,EAAGoG,WAAkB3D,IAAV2D,EAAsBC,WAAWD,GAAS,EACrDpG,ICXJsG,EAAe7G,YAAM,EAAG,KACxB8G,EAAUnD,YAASA,YAAS,GAAIoD,KAAS,CAAEC,UAAW,SAAU7G,GAAK,OAAOC,KAAK6G,MAAMJ,EAAa1G,OACpG+G,EAAO,CACPnB,KAAMN,EAAc,MAAO,OAC3B0B,MAAOd,EAAW,MAAO,QAAS,QAClCW,UAAW,SAAUzG,GACjB,IAAI6G,EAAM7G,EAAG6G,IAAKC,EAAQ9G,EAAG8G,MAAOC,EAAO/G,EAAG+G,KAAM5G,EAAKH,EAAGoG,MAAOY,OAAiB,IAAP7G,EAAgB,EAAIA,EACjG,MAAO,QACHoG,EAAQE,UAAUI,GAClB,KACAN,EAAQE,UAAUK,GAClB,KACAP,EAAQE,UAAUM,GAClB,KACAE,YAASb,IAAMK,UAAUO,IACzB,MCWZ,IAAIE,EAAM,CACN1B,KAAMN,EAAc,KACpB0B,MA9BJ,SAAkBhH,GACd,IAAIuH,EAAI,GACJzF,EAAI,GACJR,EAAI,GACJD,EAAI,GAiBR,OAhBIrB,EAAEL,OAAS,GACX4H,EAAIvH,EAAEwH,OAAO,EAAG,GAChB1F,EAAI9B,EAAEwH,OAAO,EAAG,GAChBlG,EAAItB,EAAEwH,OAAO,EAAG,GAChBnG,EAAIrB,EAAEwH,OAAO,EAAG,KAGhBD,EAAIvH,EAAEwH,OAAO,EAAG,GAChB1F,EAAI9B,EAAEwH,OAAO,EAAG,GAChBlG,EAAItB,EAAEwH,OAAO,EAAG,GAChBnG,EAAIrB,EAAEwH,OAAO,EAAG,GAChBD,GAAKA,EACLzF,GAAKA,EACLR,GAAKA,EACLD,GAAKA,GAEF,CACH4F,IAAKQ,SAASF,EAAG,IACjBL,MAAOO,SAAS3F,EAAG,IACnBqF,KAAMM,SAASnG,EAAG,IAClBkF,MAAOnF,EAAIoG,SAASpG,EAAG,IAAM,IAAM,IAMvCwF,UAAWE,EAAKF,W,QC7BhBa,EAAO,CACP9B,KAAMN,EAAc,MAAO,OAC3B0B,MAAOd,EAAW,MAAO,aAAc,aACvCW,UAAW,SAAUzG,GACjB,IAAIuH,EAAMvH,EAAGuH,IAAKC,EAAaxH,EAAGwH,WAAYC,EAAYzH,EAAGyH,UAAWtH,EAAKH,EAAGoG,MAAOY,OAAiB,IAAP7G,EAAgB,EAAIA,EACrH,MAAQ,QACJN,KAAK6G,MAAMa,GACX,KACAG,IAAQjB,UAAUQ,YAASO,IAC3B,KACAE,IAAQjB,UAAUQ,YAASQ,IAC3B,KACAR,YAASb,IAAMK,UAAUO,IACzB,MCbRW,EAAiB,SAAUhF,EAAMC,EAAIhD,GACrC,IAAIgI,EAAWjF,EAAOA,EAClBkF,EAASjF,EAAKA,EAClB,OAAO/C,KAAKoC,KAAKpC,KAAKF,IAAI,EAAGC,GAAKiI,EAASD,GAAYA,KAEvDE,EAAa,CAACZ,EAAKP,EAAMW,GACzBS,EAAe,SAAUnI,GACzB,OAAOkI,EAAWE,MAAK,SAAU7C,GAAQ,OAAOA,EAAKK,KAAK5F,OAE1DqI,EAAgB,SAAUC,GAC1B,MAAO,IAAMA,EAAQ,wEAErBC,EAAW,SAAUxF,EAAMC,GAC3B,IAAIwF,EAAgBL,EAAapF,GAC7B0F,EAAcN,EAAanF,GAC/B0F,cAAYF,EAAeH,EAActF,IACzC2F,cAAYD,EAAaJ,EAAcrF,IACvC0F,YAAUF,EAAc3B,YAAc4B,EAAY5B,UAAW,uDAC7D,IAAI8B,EAAYH,EAAcxB,MAAMjE,GAChC6F,EAAUH,EAAYzB,MAAMhE,GAC5B6F,EAAUrF,YAAS,GAAImF,GACvBG,EAAUN,IAAkBd,EAAOrC,EAAM0C,EAC7C,OAAO,SAAU/H,GACb,IAAK,IAAI4C,KAAOiG,EACA,UAARjG,IACAiG,EAAQjG,GAAOkG,EAAQH,EAAU/F,GAAMgG,EAAQhG,GAAM5C,IAI7D,OADA6I,EAAQrC,MAAQnB,EAAIsD,EAAUnC,MAAOoC,EAAQpC,MAAOxG,GAC7CwI,EAAc3B,UAAUgC,KC7BnCP,EAAQ,CACR1C,KAAM,SAAU5F,GAAK,OAAO+G,EAAKnB,KAAK5F,IAAMsH,EAAI1B,KAAK5F,IAAM0H,EAAK9B,KAAK5F,IACrEgH,MAAO,SAAUhH,GACb,OAAI+G,EAAKnB,KAAK5F,GACH+G,EAAKC,MAAMhH,GAEb0H,EAAK9B,KAAK5F,GACR0H,EAAKV,MAAMhH,GAGXsH,EAAIN,MAAMhH,IAGzB6G,UAAW,SAAU7G,GACjB,OAAO0F,YAAS1F,GACVA,EACAA,EAAEgG,eAAe,OACbe,EAAKF,UAAU7G,GACf0H,EAAKb,UAAU7G,KCnB7B+I,EAAa,OACbC,EAAc,OAOlB,SAASC,EAAQjJ,GACb,IAAIkJ,EAAS,GACTC,EAAY,EACZC,EAASpJ,EAAEsG,MAAM+C,KACjBD,IACAD,EAAYC,EAAOzJ,OACnBK,EAAIA,EAAEsJ,QAAQD,IAAYN,GAC1BG,EAAOK,KAAKC,MAAMN,EAAQE,EAAOK,IAAInB,EAAMtB,SAE/C,IAAI0C,EAAU1J,EAAEsG,MAAMC,KAKtB,OAJImD,IACA1J,EAAIA,EAAEsJ,QAAQ/C,IAAYyC,GAC1BE,EAAOK,KAAKC,MAAMN,EAAQQ,EAAQD,IAAI7C,IAAOI,SAE1C,CAAEkC,OAAQA,EAAQC,UAAWA,EAAWQ,UAAW3J,GAE9D,SAASgH,EAAMhH,GACX,OAAOiJ,EAAQjJ,GAAGkJ,OAEtB,SAASU,EAAkB5J,GACvB,IAAII,EAAK6I,EAAQjJ,GAAIkJ,EAAS9I,EAAG8I,OAAQC,EAAY/I,EAAG+I,UAAWQ,EAAYvJ,EAAGuJ,UAC9EE,EAAYX,EAAOvJ,OACvB,OAAO,SAAUK,GAEb,IADA,IAAI8J,EAASH,EACJ/J,EAAI,EAAGA,EAAIiK,EAAWjK,IAC3BkK,EAASA,EAAOR,QAAQ1J,EAAIuJ,EAAYJ,EAAaC,EAAapJ,EAAIuJ,EAAYb,EAAMzB,UAAU7G,EAAEJ,IAAMyH,YAASrH,EAAEJ,KAEzH,OAAOkK,GAGf,IAAIC,EAAuB,SAAU/J,GACjC,MAAoB,kBAANA,EAAiB,EAAIA,GAOvC,IAAIgK,EAAU,CAAEpE,KA5ChB,SAAc5F,GACV,IAAII,EAAIG,EAAIE,EAAIE,EAChB,OAAQuB,MAAMlC,IACV0F,YAAS1F,KAC6E,QAApFO,EAAoC,QAA9BH,EAAKJ,EAAEsG,MAAMC,YAAgC,IAAPnG,OAAgB,EAASA,EAAGT,cAA2B,IAAPY,EAAgBA,EAAK,IAA2F,QAApFI,EAAoC,QAA9BF,EAAKT,EAAEsG,MAAM+C,YAAgC,IAAP5I,OAAgB,EAASA,EAAGd,cAA2B,IAAPgB,EAAgBA,EAAK,GAAK,GAwC5NqG,MAAOA,EAAO4C,kBAAmBA,EAAmBK,kBALhF,SAA2BjK,GACvB,IAAIkK,EAASlD,EAAMhH,GAEnB,OADkB4J,EAAkB5J,EAC7BmK,CAAYD,EAAOT,IAAIM,MC3C9BK,EAAQ,SAAUpK,GAAK,MAAoB,kBAANA,GCLrCqK,EAAmB,SAAUhJ,EAAGC,GAAK,OAAO,SAAUtB,GAAK,OAAOsB,EAAED,EAAErB,MACtEsK,EAAO,WAEP,IADA,IAAIC,EAAe,GACVC,EAAK,EAAGA,EAAKC,UAAU9K,OAAQ6K,IACpCD,EAAaC,GAAMC,UAAUD,GAEjC,OAAOD,EAAaG,OAAOL,ICE/B,SAASM,EAASC,EAAQC,GACtB,OAAIT,EAAMQ,GACC,SAAU5K,GAAK,OAAOqF,EAAIuF,EAAQC,EAAQ7K,IAE5CsI,EAAM1C,KAAKgF,GACTrC,EAASqC,EAAQC,GAGjBC,EAAWF,EAAQC,GAGlC,IAAIE,EAAW,SAAUhI,EAAMC,GAC3B,IAAI8G,EAASkB,YAAc,GAAIjI,GAC3B8G,EAAYC,EAAOnK,OACnBsL,EAAalI,EAAK0G,KAAI,SAAUyB,EAAUtL,GAAK,OAAO+K,EAASO,EAAUlI,EAAGpD,OAChF,OAAO,SAAUI,GACb,IAAK,IAAIJ,EAAI,EAAGA,EAAIiK,EAAWjK,IAC3BkK,EAAOlK,GAAKqL,EAAWrL,GAAGI,GAE9B,OAAO8J,IAGXqB,EAAY,SAAUP,EAAQC,GAC9B,IAAIf,EAAStG,YAASA,YAAS,GAAIoH,GAASC,GACxCI,EAAa,GACjB,IAAK,IAAIrI,KAAOkH,OACQjH,IAAhB+H,EAAOhI,SAAsCC,IAAhBgI,EAAOjI,KACpCqI,EAAWrI,GAAO+H,EAASC,EAAOhI,GAAMiI,EAAOjI,KAGvD,OAAO,SAAU5C,GACb,IAAK,IAAI4C,KAAOqI,EACZnB,EAAOlH,GAAOqI,EAAWrI,GAAK5C,GAElC,OAAO8J,IAGf,SAASb,EAAQ3F,GAMb,IALA,IAAI4G,EAASF,EAAQhD,MAAM1D,GACvBuG,EAAYK,EAAOvK,OACnByL,EAAa,EACbC,EAAS,EACTC,EAAS,EACJ1L,EAAI,EAAGA,EAAIiK,EAAWjK,IACvBwL,GAAmC,kBAAdlB,EAAOtK,GAC5BwL,SAGsBvI,IAAlBqH,EAAOtK,GAAG+H,IACV2D,IAGAD,IAIZ,MAAO,CAAEnB,OAAQA,EAAQkB,WAAYA,EAAYC,OAAQA,EAAQC,OAAQA,GAE7E,IAAIR,EAAa,SAAUF,EAAQC,GAC/B,IAAIU,EAAWvB,EAAQJ,kBAAkBiB,GACrCW,EAAcvC,EAAQ2B,GACtBa,EAAcxC,EAAQ4B,GAI1B,OAHAnC,YAAU8C,EAAYF,SAAWG,EAAYH,QACzCE,EAAYH,SAAWI,EAAYJ,QACnCG,EAAYJ,YAAcK,EAAYL,WAAY,mBAAqBR,EAAS,UAAYC,EAAS,mEAClGP,EAAKS,EAASS,EAAYtB,OAAQuB,EAAYvB,QAASqB,IChE9DG,EAAY,SAAU3I,EAAMC,GAAM,OAAO,SAAU2I,GAAK,OAAOtG,EAAItC,EAAMC,EAAI2I,KAoBjF,SAASC,GAAa9B,EAAQ+B,EAAMC,GAIhC,IAHA,IApBwB9L,EAoBpB+L,EAAS,GACTC,EAAeF,IApBF,kBADO9L,EAqB6B8J,EAAO,IAnBjD4B,EAEW,kBAAN1L,EACRsI,EAAM1C,KAAK5F,GACJuI,EAGAuC,EAGNtL,MAAMC,QAAQO,GACZ+K,EAEW,kBAAN/K,EACLmL,OADN,GAODc,EAAYnC,EAAOnK,OAAS,EACvBC,EAAI,EAAGA,EAAIqM,EAAWrM,IAAK,CAChC,IAAIsM,EAAQF,EAAalC,EAAOlK,GAAIkK,EAAOlK,EAAI,IAC/C,GAAIiM,EAAM,CACN,IAAIM,EAAiB3M,MAAMC,QAAQoM,GAAQA,EAAKjM,GAAKiM,EACrDK,EAAQ5B,EAAK6B,EAAgBD,GAEjCH,EAAOxC,KAAK2C,GAEhB,OAAOH,EAiCX,SAASK,GAAYC,EAAOvC,EAAQ1J,GAChC,IAAIG,OAAY,IAAPH,EAAgB,GAAKA,EAAIK,EAAKF,EAAGV,MAAOyM,OAAiB,IAAP7L,GAAuBA,EAAIoL,EAAOtL,EAAGsL,KAAMK,EAAQ3L,EAAG2L,MAC7GK,EAAcF,EAAM1M,OACxB+I,YAAU6D,IAAgBzC,EAAOnK,OAAQ,wDACzC+I,aAAWmD,IAASrM,MAAMC,QAAQoM,IAASA,EAAKlM,SAAW4M,EAAc,EAAG,oIACxEF,EAAM,GAAKA,EAAME,EAAc,KAC/BF,EAAQ,GAAGG,OAAOH,GAClBvC,EAAS,GAAG0C,OAAO1C,GACnBuC,EAAMI,UACN3C,EAAO2C,WAEX,IAAIV,EAASH,GAAa9B,EAAQ+B,EAAMK,GACpCQ,EAA+B,IAAhBH,EA3CvB,SAAyBnM,EAAIG,GACzB,IAAIwC,EAAO3C,EAAG,GAAI4C,EAAK5C,EAAG,GACtB8L,EAAQ3L,EAAG,GACf,OAAO,SAAUP,GAAK,OAAOkM,EAAM/G,EAASpC,EAAMC,EAAIhD,KAyChD2M,CAAgBN,EAAON,GAvCjC,SAAyBM,EAAON,GAC5B,IAAIQ,EAAcF,EAAM1M,OACpBiN,EAAiBL,EAAc,EACnC,OAAO,SAAUvM,GACb,IAAI6M,EAAa,EACbC,GAAkB,EAQtB,GAPI9M,GAAKqM,EAAM,GACXS,GAAkB,EAEb9M,GAAKqM,EAAMO,KAChBC,EAAaD,EAAiB,EAC9BE,GAAkB,IAEjBA,EAAiB,CAElB,IADA,IAAIlN,EAAI,EACDA,EAAI2M,KACHF,EAAMzM,GAAKI,GAAKJ,IAAMgN,GADNhN,KAKxBiN,EAAajN,EAAI,EAErB,IAAImN,EAAkB5H,EAASkH,EAAMQ,GAAaR,EAAMQ,EAAa,GAAI7M,GACzE,OAAO+L,EAAOc,GAAYE,IAiBxBC,CAAgBX,EAAON,GAC7B,OAAOO,EACD,SAAUtM,GAAK,OAAO0M,EAAa7M,EAAMwM,EAAM,GAAIA,EAAME,EAAc,GAAIvM,KAC3E0M,EC3FV,IAI6BO,GAJzBC,GAAgB,SAAUC,GAAU,OAAO,SAAUxB,GAAK,OAAO,EAAIwB,EAAO,EAAIxB,KAChFyB,GAAe,SAAUD,GAAU,OAAO,SAAUxB,GACpD,OAAOA,GAAK,GAAMwB,EAAO,EAAIxB,GAAK,GAAK,EAAIwB,EAAO,GAAK,EAAIxB,KAAO,IAGlE0B,GAAe,SAAUJ,GAAS,OAAO,SAAUtB,GACnD,OAAOA,EAAIA,IAAMsB,EAAQ,GAAKtB,EAAIsB,KCAlCK,GAAS,SAAU3B,GAAK,OAAOA,GAC/B4B,IDHyBN,GCGH,EDHmB,SAAUtB,GAAK,OAAO1L,KAAK2B,IAAI+J,EAAGsB,MCI3EO,GAAUN,GAAcK,IACxBE,GAAYL,GAAaG,IACzBG,GAAS,SAAU/B,GAAK,OAAO,EAAI1L,KAAKqE,IAAIrE,KAAK0N,KAAKhC,KACtDiC,GAAUV,GAAcQ,IACxBG,GAAYT,GAAaQ,IACzBE,GAAST,GAXoB,OAY7BU,GAAUb,GAAcY,IACxBE,GAAYZ,GAAaU,IACzBG,GDRmB,SAAUhB,GAC7B,IAAIiB,EAAab,GAAaJ,GAC9B,OAAO,SAAUtB,GACb,OAAQA,GAAK,GAAK,EACZ,GAAMuC,EAAWvC,GACjB,IAAO,EAAI1L,KAAK2B,IAAI,GAAI,IAAM+J,EAAI,MCG/BwC,CAdgB,OAkB7BC,GAAY,SAAUzC,GACtB,GAAU,IAANA,GAAiB,IAANA,EACX,OAAOA,EACX,IAAI0C,EAAK1C,EAAIA,EACb,OAAOA,EArBkB,mBAsBnB,OAAS0C,EACT1C,EAtBoB,kBAuBhB,MAAQ0C,EAAK,IAAM1C,EAAI,IACvBA,EAvBe,GAYpB,mBAYc0C,EAXd,kBAWwB1C,EAVxB,kBAWS,KAAOA,EAAIA,EAAI,MAAQA,EAAI,OAEzC2C,GAAWpB,GAAckB,IC7B7B,SAASG,GAAcrF,EAAQiE,GAC3B,OAAOjE,EAAOO,KAAI,WAAc,OAAO0D,GAAUM,MAAce,OAAO,EAAGtF,EAAOvJ,OAAS,GAW7F,SAAS8O,GAAUrO,GACf,IAAIG,EAAKH,EAAG2C,KAAMA,OAAc,IAAPxC,EAAgB,EAAIA,EAAIE,EAAKL,EAAG4C,GAAIA,OAAY,IAAPvC,EAAgB,EAAIA,EAAIoL,EAAOzL,EAAGyL,KAAM6C,EAAStO,EAAGsO,OAAQ/N,EAAKP,EAAGI,SAAUA,OAAkB,IAAPG,EAAgB,IAAMA,EAC7KyC,EAAQ,CAAEC,MAAM,EAAOC,MAAOP,GAC9BmG,EAAS1J,MAAMC,QAAQuD,GAAMA,EAAK,CAACD,EAAMC,GACzC2L,EAPR,SAA8BD,EAAQlO,GAClC,OAAOkO,EAAOjF,KAAI,SAAUmF,GAAK,OAAOA,EAAIpO,KAMhCqO,CAAqBH,GAAUA,EAAO/O,SAAWuJ,EAAOvJ,OAC9D+O,EAdV,SAAuBxF,GACnB,IAAIW,EAAYX,EAAOvJ,OACvB,OAAOuJ,EAAOO,KAAI,SAAUqF,EAAQlP,GAChC,OAAa,IAANA,EAAUA,GAAKiK,EAAY,GAAK,KAYrCkF,CAAc7F,GAAS1I,GAC7B,SAASwO,IACL,OAAO5C,GAAYuC,EAAOzF,EAAQ,CAC9B2C,KAAMrM,MAAMC,QAAQoM,GAAQA,EAAO0C,GAAcrF,EAAQ2C,KAGjE,IAAIa,EAAesC,IACnB,MAAO,CACH1P,KAAM,SAAU+E,GAGZ,OAFAjB,EAAME,MAAQoJ,EAAarI,GAC3BjB,EAAMC,KAAOgB,GAAK7D,EACX4C,GAEX4B,WAAY,WACRkE,EAAOuD,UACPC,EAAesC,MChC3B,IAAIC,GAAQ,CAAER,UAAWA,GAAW3L,OAAQA,EAAQoM,MCJpD,SAAe9O,GACX,IAAIG,EAAKH,EAAGQ,SAAUA,OAAkB,IAAPL,EAAgB,EAAIA,EAAIE,EAAKL,EAAG2C,KAAMA,OAAc,IAAPtC,EAAgB,EAAIA,EAAIE,EAAKP,EAAG6M,MAAOA,OAAe,IAAPtM,EAAgB,GAAMA,EAAIE,EAAKT,EAAG+O,aAAcA,OAAsB,IAAPtO,EAAgB,IAAMA,EAAIuO,EAAKhP,EAAG8C,UAAWA,OAAmB,IAAPkM,EAAgB,GAAMA,EAAIC,EAAejP,EAAGiP,aAC7RjM,EAAQ,CAAEC,MAAM,EAAOC,MAAOP,GAC9BuM,EAAYrC,EAAQrM,EACpB2O,EAAQxM,EAAOuM,EACfzE,OAA0BhI,IAAjBwM,EAA6BE,EAAQF,EAAaE,GAG/D,OAFI1E,IAAW0E,IACXD,EAAYzE,EAAS9H,GAClB,CACHzD,KAAM,SAAU+E,GACZ,IAAIjD,GAASkO,EAAYrP,KAAKwB,KAAK4C,EAAI8K,GAGvC,OAFA/L,EAAMC,OAASjC,EAAQ8B,GAAa9B,GAAS8B,GAC7CE,EAAME,MAAQF,EAAMC,KAAOwH,EAASA,EAASzJ,EACtCgC,GAEX4B,WAAY,gBCfpB,IAAIwK,GAAmB,EAAI,GAAM,IAC7BC,GAAwC,qBAAhBC,YACtB,WAAc,OAAOA,YAAYC,OACjC,WAAc,OAAOC,KAAKD,OAC5BE,GAAgC,qBAAXC,OACnB,SAAUC,GACR,OAAOD,OAAOE,sBAAsBD,IAEtC,SAAUA,GACR,OAAOE,YAAW,WAAc,OAAOF,EAASN,QAAsBD,KCN9E,IACIU,IAAoB,EACpBC,IAAe,EACfC,IAAe,EACfC,GAAQ,CACRjP,MAAO,EACPkP,UAAW,GAEXC,GAAa,CAAC,OAAQ,SAAU,YAAa,SAAU,cACvDC,GAAqBD,GAAW7F,QAAO,SAAU+F,EAAK7N,GAItD,OAHA6N,EAAI7N,GCbR,SAA0BuN,GACtB,IAAIO,EAAQ,GACRC,EAAiB,GACjBC,EAAW,EACXR,GAAe,EACfS,EAAc,IAAIC,QAClBC,EAAO,CACPC,SAAU,SAAUjB,EAAUkB,EAAWC,QACnB,IAAdD,IAAwBA,GAAY,QACtB,IAAdC,IAAwBA,GAAY,GACxC,IAAIC,EAAoBD,GAAad,EACjCgB,EAASD,EAAoBT,EAAQC,EAQzC,OAPIM,GACAJ,EAAYQ,IAAItB,IACc,IAA9BqB,EAAOE,QAAQvB,KACfqB,EAAO7H,KAAKwG,GACRoB,GAAqBf,IACrBQ,EAAWF,EAAM/Q,SAElBoQ,GAEXwB,OAAQ,SAAUxB,GACd,IAAIyB,EAAQb,EAAeW,QAAQvB,IACpB,IAAXyB,GACAb,EAAenC,OAAOgD,EAAO,GACjCX,EAAYY,OAAO1B,IAEvB2B,QAAS,SAAUC,GACf,IAAIvR,EAKJ,GAJAgQ,GAAe,EACeM,GAA9BtQ,EAAK,CAACuQ,EAAgBD,IAAmB,IAAIC,EAAiBvQ,EAAG,IAClDT,OAAS,EACxBiR,EAAWF,EAAM/Q,OAEb,IAAK,IAAIC,EAAI,EAAGA,EAAIgR,EAAUhR,IAAK,CAC/B,IAAImQ,EAAWW,EAAM9Q,GACrBmQ,EAAS4B,GACLd,EAAYe,IAAI7B,KAChBgB,EAAKC,SAASjB,GACdI,KAIZC,GAAe,IAGvB,OAAOW,EDjCIc,EAAiB,WACxB,OAAO1B,IAAe,KAEnBM,IACR,IACCqB,GAAoBvB,GAAW7F,QAAO,SAAU+F,EAAK7N,GACrD,IAAImO,EAAOP,GAAM5N,GAWjB,OAVA6N,EAAI7N,GAAO,SAAU8O,EAAST,EAAWC,GAQrC,YAPkB,IAAdD,IACAA,GAAY,QAEE,IAAdC,IACAA,GAAY,GAEXf,IAAc4B,KACZhB,EAAKC,SAASU,EAAST,EAAWC,IAEtCT,IACR,IACCuB,GAA0BzB,GAAW7F,QAAO,SAAU+F,EAAK7N,GAE3D,OADA6N,EAAI7N,GAAO4N,GAAM5N,GAAK2O,OACfd,IACR,IAOCwB,GAAc,SAAUC,GACxB,OAAO1B,GAAM0B,GAAQR,QAAQrB,KAE7B8B,GAAe,SAAfA,EAAyB7B,GACzBH,IAAe,EACfE,GAAMjP,MAAQ8O,GAAoBV,GAAkBvP,KAAKF,IAAIE,KAAKH,IAAIwQ,EAAYD,GAAMC,UA5C3E,IA4CmG,GAChHD,GAAMC,UAAYA,EAClBF,IAAe,EACfG,GAAW6B,QAAQH,IACnB7B,IAAe,EACXD,KACAD,IAAoB,EACpBL,GAAYsC,KAGhBJ,GAAY,WACZ5B,IAAe,EACfD,IAAoB,EACfE,IAAcP,GAAYsC,KAE/BE,GAAe,WACf,OAAOhC,IAGIyB,MElEf,SAASQ,GAAYC,EAAS/R,EAAUgS,GAEpC,YADc,IAAVA,IAAoBA,EAAQ,GACzBD,EAAU/R,EAAWgS,ECIhC,IAAIC,GAAY,SAAUC,GACtB,IAAIC,EAAgB,SAAUvS,GAC1B,IAAIgB,EAAQhB,EAAGgB,MACf,OAAOsR,EAAOtR,IAElB,MAAO,CACHwR,MAAO,WAAc,OAAOd,GAAKY,OAAOC,GAAe,IACvDE,KAAM,WAAc,OAAOb,GAAWU,OAAOC,MAGrD,SAASG,GAAQ1S,GACb,IAAIG,EAAIE,EAGJsS,EAGAC,EAGAC,EARAlQ,EAAO3C,EAAG2C,KAAMpC,EAAKP,EAAG8S,SAAUA,OAAkB,IAAPvS,GAAuBA,EAAIE,EAAKT,EAAG+S,OAAQA,OAAgB,IAAPtS,EAAgB4R,GAAY5R,EAAIuO,EAAKhP,EAAGmS,QAASA,OAAiB,IAAPnD,EAAgB,EAAIA,EAAIgE,EAAKhT,EAAGiT,OAAQC,OAAmB,IAAPF,EAAgB,EAAIA,EAAIG,EAAKnT,EAAGoT,WAAYA,OAAoB,IAAPD,EAAgB,OAASA,EAAIE,EAAKrT,EAAGsT,YAAaA,OAAqB,IAAPD,EAAgB,EAAIA,EAAIE,EAASvT,EAAGuT,OAAQC,EAASxT,EAAGwT,OAAQC,EAAazT,EAAGyT,WAAYC,EAAW1T,EAAG0T,SAAUC,EAAW3T,EAAG2T,SAAUtR,EAAUU,YAAO/C,EAAI,CAAC,OAAQ,WAAY,SAAU,UAAW,SAAU,aAAc,cAAe,SAAU,SAAU,aAAc,WAAY,aACzmB4C,EAAKP,EAAQO,GAEbgR,EAAc,EACdC,EAAmBxR,EAAQjC,SAE3B0T,GAAa,EACbC,GAAoB,EAEpBC,ENtBR,SAAoCC,GAChC,GAAI7U,MAAMC,QAAQ4U,EAAOrR,IACrB,OAAOyL,GAEN,GAAIQ,GAAMoF,EAAO9O,MAClB,OAAO0J,GAAMoF,EAAO9O,MAExB,IAAI7C,EAAO,IAAI4R,IAAIxO,OAAOpD,KAAK2R,IAC/B,OAAI3R,EAAKkP,IAAI,SACRlP,EAAKkP,IAAI,cAAgBlP,EAAKkP,IAAI,gBAC5BnD,GAEF/L,EAAKkP,IAAI,iBACdlP,EAAKkP,IAAI,cACTlP,EAAKkP,IAAI,SACTlP,EAAKkP,IAAI,YACTlP,EAAKkP,IAAI,cACTlP,EAAKkP,IAAI,aACF9O,EAEJ2L,GMEQ8F,CAA2B9R,IACQ,QAA7ChC,GAAMF,EAAK6T,GAAUnP,0BAAuC,IAAPxE,OAAgB,EAASA,EAAGwF,KAAK1F,EAAIwC,EAAMC,MACjGiQ,EAAwB7G,GAAY,CAAC,EAAG,KAAM,CAACrJ,EAAMC,GAAK,CACtDnD,OAAO,IAEXkD,EAAO,EACPC,EAAK,KAET,IAAIwR,EAAYJ,EAAS5Q,YAASA,YAAS,GAAIf,GAAU,CAAEM,KAAMA,EAAMC,GAAIA,KAC3E,SAASqQ,IACLW,IACmB,YAAfR,EAEAjB,EDpCZ,SAAwBA,EAAS/R,EAAUgS,EAAO2B,GAG9C,YAFc,IAAV3B,IAAoBA,EAAQ,QACN,IAAtB2B,IAAgCA,GAAoB,GACjDA,EACD7B,GAAY9R,GAAY+R,EAAS/R,EAAUgS,GAC3ChS,GAAY+R,EAAU/R,GAAYgS,EC+BtBiC,CAAelC,EAAS0B,EAAkBP,EADpDS,EAAoBH,EAAc,IAAM,IAIxCzB,EAAUD,GAAYC,EAAS0B,EAAkBP,GAC9B,WAAfF,GACAgB,EAAUxP,cAElBkP,GAAa,EACbJ,GAAYA,IAMhB,SAASpB,EAAOtR,GAIZ,GAHK+S,IACD/S,GAASA,GACbmR,GAAWnR,GACN8S,EAAY,CACb,IAAI9Q,EAAQoR,EAAUlV,KAAKW,KAAKF,IAAI,EAAGwS,IACvCS,EAAS5P,EAAME,MACX2P,IACAD,EAASC,EAAsBD,IACnCkB,EAAaC,EAAoB/Q,EAAMC,KAAOkP,GAAW,EAEhD,OAAbwB,QAAkC,IAAbA,GAA+BA,EAASf,GACzDkB,IACoB,IAAhBF,IACqB,OAArBC,QAAkD,IAArBA,IAAkDA,EAAmB1B,IAClGyB,EAAcV,ED1D9B,SAA+Bf,EAAS/R,EAAUgS,EAAO2B,GACrD,OAAOA,EAAoB5B,GAAW/R,EAAWgS,EAAQD,IAAYC,EC0DzDkC,CAAsBnC,EAAS0B,EAAkBP,EAAaS,IAAsBd,KAnB5FN,EAAeF,OACfgB,GAAcA,MA+BlB,OADAX,IAJe,OAAXS,QAA8B,IAAXA,GAA6BA,KAChDZ,EAAiBI,EAAOT,IACTE,SAGZ,CACHC,KAAM,WACS,OAAXe,QAA8B,IAAXA,GAA6BA,IAChDb,EAAeF,SCtF3B,SAAS8B,GAAkB/T,EAAUgU,GACjC,OAAOA,EAAgBhU,GAAY,IAAOgU,GAAiB,ECK/D,IAAIC,GAAwB,SAAUC,GAAW,OAAiB,IAAVA,GCJpDzT,GAAI,SAAU0T,EAAIC,GAAM,OAAO,EAAM,EAAMA,EAAK,EAAMD,GACtDzT,GAAI,SAAUyT,EAAIC,GAAM,OAAO,EAAMA,EAAK,EAAMD,GAChDvT,GAAI,SAAUuT,GAAM,OAAO,EAAMA,GACjCE,GAAa,SAAU5Q,EAAG0Q,EAAIC,GAC9B,QAAS3T,GAAE0T,EAAIC,GAAM3Q,EAAI/C,GAAEyT,EAAIC,IAAO3Q,EAAI7C,GAAEuT,IAAO1Q,GAEnD6Q,GAAW,SAAU7Q,EAAG0Q,EAAIC,GAC5B,OAAO,EAAM3T,GAAE0T,EAAIC,GAAM3Q,EAAIA,EAAI,EAAM/C,GAAEyT,EAAIC,GAAM3Q,EAAI7C,GAAEuT,IAkC7D,IACII,GAAkB,GACtB,SAASC,GAAYC,EAAKC,EAAKC,EAAKC,GAChC,GAAIH,IAAQC,GAAOC,IAAQC,EACvB,OAAOlI,GAEX,IADA,IAAImI,EAAe,IAAIC,aALJ,IAMV9V,EAAI,EAAGA,EANG,KAMqBA,EACpC6V,EAAa7V,GAAKqV,GAAWrV,EAAIuV,GAAiBE,EAAKE,GAE3D,SAASI,EAASC,GAId,IAHA,IAAIC,EAAgB,EAChBC,EAAgB,EACHC,KACVD,GAAgCL,EAAaK,IAAkBF,IAAME,EACxED,GAAiBV,KAEnBW,EACF,IAEIE,EAAYH,GAFJD,EAAKH,EAAaK,KACzBL,EAAaK,EAAgB,GAAKL,EAAaK,IACbX,GACnCc,EAAef,GAASc,EAAWX,EAAKE,GAC5C,OAAIU,GAjCS,KACrB,SAA8BL,EAAIM,EAASb,EAAKE,GAC5C,IAAK,IAAI3V,EAAI,EAAGA,EAHG,IAGqBA,EAAG,CACvC,IAAIuW,EAAejB,GAASgB,EAASb,EAAKE,GAC1C,GAAqB,IAAjBY,EACA,OAAOD,EAGXA,IADejB,GAAWiB,EAASb,EAAKE,GAAOK,GACzBO,EAE1B,OAAOD,EAwBQE,CAAqBR,EAAII,EAAWX,EAAKE,GAE1B,IAAjBU,EACED,EAvDnB,SAAyBJ,EAAIS,EAAIC,EAAIjB,EAAKE,GACtC,IAAIgB,EACAC,EACA5W,EAAI,EACR,IAEI2W,EAAWtB,GADXuB,EAAWH,GAAMC,EAAKD,GAAM,EACIhB,EAAKE,GAAOK,GAC7B,EACXU,EAAKE,EAGLH,EAAKG,QAEJvW,KAAKkE,IAAIoS,GAfK,QAgBjB3W,EAfqB,IAgB3B,OAAO4W,EA2CQC,CAAgBb,EAAIC,EAAeA,EAAgBV,GAAiBE,EAAKE,GAGxF,OAAO,SAAUlR,GACb,OAAa,IAANA,GAAiB,IAANA,EAAUA,EAAI4Q,GAAWU,EAAStR,GAAIiR,EAAKE,ICvErE,IAAIkB,GAAe,CACfpJ,OAAQA,GACRC,OAAQA,GACRE,UAAWA,GACXD,QAASA,GACTE,OAAQA,GACRG,UAAWA,GACXD,QAASA,GACTE,OAAQA,GACRE,UAAWA,GACXD,QAASA,GACTE,WAAYA,GACZK,SAAUA,GACVqI,YZgBc,SAAUhL,GACxB,OAAOA,EAAI,GACL,IAAO,EAAMyC,GAAU,EAAU,EAAJzC,IAC7B,GAAMyC,GAAc,EAAJzC,EAAU,GAAO,IYlBvCyC,UAAWA,IAEXwI,GAA6B,SAAUC,GACvC,GAAIrX,MAAMC,QAAQoX,GAAa,CAE3BnO,YAAgC,IAAtBmO,EAAWlX,OAAc,2DACnC,IAAIS,EAAK0W,YAAOD,EAAY,GAC5B,OAAOzB,GAD8BhV,EAAG,GAASA,EAAG,GAASA,EAAG,GAASA,EAAG,IAG3E,MAA0B,kBAAfyW,GAEZnO,iBAAuC7F,IAA7B6T,GAAaG,GAA2B,wBAA0BA,EAAa,KAClFH,GAAaG,IAEjBA,GCrBPE,GAAe,SAAUnU,EAAKU,GAE9B,MAAY,WAARV,MAKiB,kBAAVU,IAAsB9D,MAAMC,QAAQ6D,OAE1B,kBAAVA,IACP0G,EAAQpE,KAAKtC,IACZA,EAAMuC,WAAW,WCnBtBmR,GAAoB,WAAc,MAAQ,CAC1CzR,KAAM,SACNpD,UAAW,IACXC,QAAS,GACTc,UAAW,GACXD,UAAW,KAEXgU,GAAyB,SAAUjU,GAAM,MAAQ,CACjDuC,KAAM,SACNpD,UAAW,IACXC,QAAgB,IAAPY,EAAW,EAAI/C,KAAKoC,KAAK,KAAO,GACzCa,UAAW,IACXD,UAAW,KAEXiU,GAAc,WAAc,MAAQ,CACpC3R,KAAM,YACNsG,KAAM,SACNrL,SAAU,KAEViO,GAAY,SAAUvF,GAAU,MAAQ,CACxC3D,KAAM,YACN/E,SAAU,GACV0I,OAAQA,IAERiO,GAAqB,CACrBC,EAAGJ,GACHK,EAAGL,GACHM,EAAGN,GACHO,OAAQP,GACRQ,QAASR,GACTS,QAAST,GACTU,QAASV,GACTW,OAAQV,GACRW,OAAQX,GACRY,MAAOZ,GACPa,QAASZ,GACTa,gBAAiBb,GACjB5O,MAAO4O,GACPc,QAASf,ICrCTgB,GAAc,IAAI3D,IAAI,CAAC,aAAc,WAAY,WAAY,YACjE,SAAS4D,GAAmBlY,GACxB,IAAII,EAAKJ,EAAEmY,MAAM,GAAI,GAAGC,MAAM,KAAMC,EAAOjY,EAAG,GAAIkD,EAAQlD,EAAG,GAC7D,GAAa,gBAATiY,EACA,OAAOrY,EACX,IAAI4G,GAAUtD,EAAMgD,MAAMC,MAAe,IAAI,GAC7C,IAAKK,EACD,OAAO5G,EACX,IAAIsY,EAAOhV,EAAMgG,QAAQ1C,EAAQ,IAC7B2R,EAAeN,GAAYrG,IAAIyG,GAAQ,EAAI,EAG/C,OAFIzR,IAAWtD,IACXiV,GAAgB,KACbF,EAAO,IAAME,EAAeD,EAAO,IAE9C,IAAIE,GAAgB,oBAChBC,GAASjV,YAASA,YAAS,GAAIwG,GAAU,CAAEC,kBAAmB,SAAUjK,GACpE,IAAI0Y,EAAY1Y,EAAEsG,MAAMkS,IACxB,OAAOE,EAAYA,EAAUjP,IAAIyO,IAAoBS,KAAK,KAAO3Y,K,SCdrE4Y,GAAoBpV,YAASA,YAAS,GAAIqV,MAAmB,CAE7DvQ,MAAOA,EAAOyP,gBAAiBzP,EAAOwQ,aAAcxQ,EAAOyQ,KAAMzQ,EAAO0Q,OAAQ1Q,EAEhF2Q,YAAa3Q,EAAO4Q,eAAgB5Q,EAAO6Q,iBAAkB7Q,EAAO8Q,kBAAmB9Q,EAAO+Q,gBAAiB/Q,EAAOmQ,OAAQA,GAAQa,aAAcb,KAIpJc,GAAsB,SAAU3W,GAAO,OAAOgW,GAAkBhW,ICZpE,SAASqH,GAAkBrH,EAAKU,GAC5B,IAAIlD,EACAoZ,EAAmBD,GAAoB3W,GAI3C,OAHI4W,IAAqBf,KACrBe,EAAmBxP,GAE8B,QAA7C5J,EAAKoZ,EAAiBvP,yBAAsC,IAAP7J,OAAgB,EAASA,EAAG6F,KAAKuT,EAAkBlW,GCSpH,IAAImW,IAAsB,EAI1B,SAASC,GAAoCtZ,GACzC,IAAIyL,EAAOzL,EAAGyL,KAAM8C,EAAQvO,EAAGuO,MAAOgL,EAAOvZ,EAAGuZ,KAAMC,EAAOxZ,EAAGwZ,KAAMC,EAAOzZ,EAAGyZ,KAAMC,EAAa3W,YAAO/C,EAAI,CAAC,OAAQ,QAAS,OAAQ,OAAQ,SAC5IqC,EAAUe,YAAS,GAAIsW,GA+C3B,OA9CInL,IACAlM,EAAO,OAAakM,GAIpBmL,EAAWtZ,WACXiC,EAAO,SAAeoS,GAAsBiF,EAAWtZ,WACvDsZ,EAAWpG,cACXjR,EAAQiR,YAAcmB,GAAsBiF,EAAWpG,cAIvD7H,IACApJ,EAAO,KNJK,SAAUoJ,GAC1B,OAAOrM,MAAMC,QAAQoM,IAA4B,kBAAZA,EAAK,GMGpBkO,CAAclO,GAC1BA,EAAKpC,IAAImN,IACTA,GAA2B/K,IAKb,UAApBiO,EAAWvU,OACX9C,EAAQ8C,KAAO,cAIfoU,GAAQE,GAAQD,KAChB7Y,aAAS0Y,GAAqB,mGAC9BA,IAAsB,EAClBE,EACAlX,EAAQ+Q,WAAa,UAEhBqG,EACLpX,EAAQ+Q,WAAa,OAEhBoG,IACLnX,EAAQ+Q,WAAa,UAEzB/Q,EAAQ4Q,OAASwG,GAAQF,GAAQC,GAAQE,EAAWzG,QAOhC,WAApByG,EAAWvU,OACX9C,EAAQ8C,KAAO,aACZ9C,EAiBX,SAASuX,GAA6BF,EAAYrX,EAASG,GACvD,IAAIxC,EAWJ,OAVIZ,MAAMC,QAAQgD,EAAQO,MACS,QAA9B5C,EAAK0Z,EAAWtZ,gBAA6B,IAAPJ,IAAsB0Z,EAAWtZ,SAAW,KAV3F,SAA0BiC,GAClBjD,MAAMC,QAAQgD,EAAQO,KAAyB,OAAlBP,EAAQO,GAAG,KACxCP,EAAQO,GAAKgI,YAAc,GAAI8L,YAAOrU,EAAQO,KAC9CP,EAAQO,GAAG,GAAKP,EAAQM,MAS5BkX,CAAiBxX,GA/ErB,SAA6BrC,GACzBA,EAAG8Z,KAAM9Z,EAAGoS,MAAOpS,EAAG+Z,cAAe/Z,EAAGga,gBAAiBha,EAAGia,iBAAkBja,EAAGiT,OAAQjT,EAAGoT,WAAYpT,EAAGsT,YAAatT,EAAG2C,KAAM,IAAI+W,EAAa3W,YAAO/C,EAAI,CAAC,OAAQ,QAAS,gBAAiB,kBAAmB,mBAAoB,SAAU,aAAc,cAAe,SAC9Q,QAAS0F,OAAOpD,KAAKoX,GAAYna,OAiF5B2a,CAAoBR,KACrBA,EAAatW,YAASA,YAAS,GAAIsW,GJvDhB,SAAUS,EAAUvX,GAC3C,IAAIwX,EAQJ,OANIA,EADAC,YAAkBzX,GACEyL,GAIhB0I,GAAmBoD,IAAapD,GAAmBa,QAEpDxU,YAAS,CAAER,GAAIA,GAAMwX,EAAkBxX,II8CM0X,CAAqB9X,EAAKH,EAAQO,MAE/EQ,YAASA,YAAS,GAAIf,GAAUiX,GAAoCI,IAK/E,SAASa,GAAa/X,EAAKU,EAAOuH,EAAQiP,EAAYjG,GAClD,IAAIzT,EACAwa,EAAkBC,GAAmBf,EAAYlX,GACjDgI,EAAyC,QAA/BxK,EAAKwa,EAAgB7X,YAAyB,IAAP3C,EAAgBA,EAAKkD,EAAMwX,MAC5EC,EAAqBhE,GAAanU,EAAKiI,GAC5B,SAAXD,GAAqBmQ,GAAwC,kBAAXlQ,EAKlDD,EAASX,GAAkBrH,EAAKiI,GAE3BmQ,GAAOpQ,IAA6B,kBAAXC,EAC9BD,EAASqQ,GAAYpQ,IAEfrL,MAAMC,QAAQoL,IACpBmQ,GAAOnQ,IACW,kBAAXD,IACPC,EAASoQ,GAAYrQ,IAEzB,IAAIsQ,EAAqBnE,GAAanU,EAAKgI,GA8B3C,OA7BA7J,YAAQma,IAAuBH,EAAoB,6BAA+BnY,EAAM,UAAagI,EAAS,SAAaC,EAAS,MAASD,EAAS,8DAAgEA,EAAS,6BAA+BC,EAAS,8BA6B/PqQ,GACHH,IACwB,IAAzBH,EAAgBrV,KA9BpB,WACI,IAAI9C,EAAU,CACVM,KAAM6H,EACN5H,GAAI6H,EACJjK,SAAU0C,EAAM6X,cAChBtH,WAAYA,EACZE,SAAU,SAAU/T,GAAK,OAAOsD,EAAM8X,IAAIpb,KAE9C,MAAgC,YAAzB4a,EAAgBrV,MACM,UAAzBqV,EAAgBrV,KCnI5B,SAAiBnF,GACb,IACIib,EADA9a,EAAKH,EAAG2C,KAAMA,OAAc,IAAPxC,EAAgB,EAAIA,EAAIE,EAAKL,EAAGQ,SAAUA,OAAkB,IAAPH,EAAgB,EAAIA,EAAIX,EAAMM,EAAGN,IAAKC,EAAMK,EAAGL,IAAKY,EAAKP,EAAG6M,MAAOA,OAAe,IAAPtM,EAAgB,GAAMA,EAAIE,EAAKT,EAAG+O,aAAcA,OAAsB,IAAPtO,EAAgB,IAAMA,EAAIuO,EAAKhP,EAAGkb,gBAAiBA,OAAyB,IAAPlM,EAAgB,IAAMA,EAAIgE,EAAKhT,EAAGmb,cAAeA,OAAuB,IAAPnI,EAAgB,GAAKA,EAAIG,EAAKnT,EAAG8C,UAAWA,OAAmB,IAAPqQ,EAAgB,EAAIA,EAAIlE,EAAejP,EAAGiP,aAAc8D,EAAS/S,EAAG+S,OAAQY,EAAW3T,EAAG2T,SAAUF,EAAazT,EAAGyT,WAE1gB,SAAS2H,EAAcxb,GACnB,YAAgB6C,IAAR/C,GAAqBE,EAAIF,QAAiB+C,IAAR9C,GAAqBC,EAAID,EAEvE,SAAS0b,EAAgBzb,GACrB,YAAY6C,IAAR/C,EACOC,OACC8C,IAAR9C,GAEGE,KAAKkE,IAAIrE,EAAME,GAAKC,KAAKkE,IAAIpE,EAAMC,GAD/BF,EAC0CC,EAEzD,SAAS2b,EAAejZ,GACC,OAArB4Y,QAAkD,IAArBA,GAAuCA,EAAiBxI,OACrFwI,EAAmBvI,GAAQtP,YAASA,YAAS,GAAIf,GAAU,CAAE0Q,OAAQA,EAAQY,SAAU,SAAU/T,GACzF,IAAII,EACS,OAAb2T,QAAkC,IAAbA,GAA+BA,EAAS/T,GACjC,QAA3BI,EAAKqC,EAAQsR,gBAA6B,IAAP3T,GAAyBA,EAAG6F,KAAKxD,EAASzC,IAC/E6T,WAAYA,KAEvB,SAAS8H,EAAYlZ,GACjBiZ,EAAelY,YAAS,CAAE+B,KAAM,SAAUpD,UAAWmZ,EAAiBlZ,QAASmZ,EAAerY,UAAWA,GAAaT,IAE1H,GAAI+Y,EAAczY,GACd4Y,EAAY,CAAE5Y,KAAMA,EAAMnC,SAAUA,EAAUoC,GAAIyY,EAAgB1Y,SAEjE,CACD,IAAI8H,EAASoC,EAAQrM,EAAWmC,EACJ,qBAAjBsM,IACPxE,EAASwE,EAAaxE,IAC1B,IAEI+Q,EACAC,EAHAC,EAAaL,EAAgB5Q,GAC7BkR,EAAYD,IAAehc,GAAO,EAAI,EAY1C4b,EAAe,CACXnW,KAAM,QACNxC,KAAMA,EACNnC,SAAUA,EACVuO,aAAcA,EACdlC,MAAOA,EACP/J,UAAWA,EACXmM,aAAcA,EACd0E,SAAUyH,EAAc3Q,GAjBR,SAAU7K,GAC1B4b,EAASC,EACTA,EAAY7b,EACZY,EAAW+T,GAAkB3U,EAAI4b,EAAQvJ,KAAejR,QACrC,IAAd2a,GAAmB/b,EAAI8b,IACR,IAAfC,GAAoB/b,EAAI8b,IACzBH,EAAY,CAAE5Y,KAAM/C,EAAGgD,GAAI8Y,EAAYlb,SAAUA,UAWHiC,IAG1D,MAAO,CACHgQ,KAAM,WAAc,OAA4B,OAArBwI,QAAkD,IAArBA,OAA8B,EAASA,EAAiBxI,SD4E1GmJ,CAAQxY,YAASA,YAAS,GAAIf,GAAUmY,IACxC9H,GAAQtP,YAASA,YAAS,GAAIwW,GAA6BY,EAAiBnY,EAASG,IAAO,CAAEmR,SAAU,SAAU/T,GAC5G,IAAII,EACJqC,EAAQsR,SAAS/T,GACmB,QAAnCI,EAAKwa,EAAgB7G,gBAA6B,IAAP3T,GAAyBA,EAAG6F,KAAK2U,EAAiB5a,IAC/F6T,WAAY,WACX,IAAIzT,EACJqC,EAAQoR,aAC8B,QAArCzT,EAAKwa,EAAgB/G,kBAA+B,IAAPzT,GAAyBA,EAAG6F,KAAK2U,QAG/F,WACI,IAAIxa,EAIJ,OAHAkD,EAAM8X,IAAIvQ,GACVgJ,IACwG,QAAvGzT,EAAyB,OAApBwa,QAAgD,IAApBA,OAA6B,EAASA,EAAgB/G,kBAA+B,IAAPzT,GAAyBA,EAAG6F,KAAK2U,GAC1I,CAAE/H,KAAM,eAQvB,SAASmI,GAAO1X,GACZ,OAAkB,IAAVA,GACc,kBAAVA,GACkB,IAAtBmD,WAAWnD,KACa,IAAxBA,EAAMgO,QAAQ,KAE1B,SAAS2J,GAAYgB,GACjB,MAAoC,kBAAtBA,EACR,EACAhS,GAAkB,GAAIgS,GAEhC,SAASpB,GAAmBf,EAAYlX,GACpC,OAAOkX,EAAWlX,IAAQkX,EAAU,SAAeA,EAQvD,SAAS4B,GAAe9Y,EAAKU,EAAOuH,EAAQiP,GAExC,YADmB,IAAfA,IAAyBA,EAAa,IACnCxW,EAAMsP,OAAM,SAAUiB,GACzB,IAAIqI,EACAC,EACA3H,EAAYmG,GAAa/X,EAAKU,EAAOuH,EAAQiP,EAAYjG,GACzDrB,EA/GZ,SAAgCsH,EAAYlX,GACxC,IAAIxC,EAEJ,OAAwC,QAAhCA,GADcya,GAAmBf,EAAYlX,IAAQ,IAChC4P,aAA0B,IAAPpS,EAAgBA,EAAK,EA4GrDgc,CAAuBtC,EAAYlX,GAC3CgQ,EAAQ,WAAc,OAAQuJ,EAAW3H,KAO7C,OANIhC,EACA0J,EAAajM,WAAW2C,EAAOiC,GAAsBrC,IAGrDI,IAEG,WACHyJ,aAAaH,GACA,OAAbC,QAAkC,IAAbA,GAA+BA,EAAStJ,WElMzE,I,SCHA,SAASyJ,GAAcC,EAAKC,IACD,IAAvBD,EAAIjL,QAAQkL,IAAgBD,EAAIhT,KAAKiT,GAEzC,SAASC,GAAWF,EAAKC,GACrB,IAAIhL,EAAQ+K,EAAIjL,QAAQkL,GACxBhL,GAAS,GAAK+K,EAAI/N,OAAOgD,EAAO,GCHpC,IAAIkL,GAAqC,WACrC,SAASA,IACLC,KAAKC,cAAgB,GAkCzB,OAhCAF,EAAoB3W,UAAUsL,IAAM,SAAUwL,GAC1C,IAAIC,EAAQH,KAEZ,OADAL,GAAcK,KAAKC,cAAeC,GAC3B,WAAc,OAAOJ,GAAWK,EAAMF,cAAeC,KAEhEH,EAAoB3W,UAAUgX,OAAS,SAAU1b,EAAGC,EAAGE,GACnD,IAAIwb,EAAmBL,KAAKC,cAAcjd,OAC1C,GAAKqd,EAEL,GAAyB,IAArBA,EAIAL,KAAKC,cAAc,GAAGvb,EAAGC,EAAGE,QAG5B,IAAK,IAAI5B,EAAI,EAAGA,EAAIod,EAAkBpd,IAAK,CAKvC,IAAIid,EAAUF,KAAKC,cAAchd,GACjCid,GAAWA,EAAQxb,EAAGC,EAAGE,KAIrCkb,EAAoB3W,UAAUkX,QAAU,WACpC,OAAON,KAAKC,cAAcjd,QAE9B+c,EAAoB3W,UAAUmX,MAAQ,WAClCP,KAAKC,cAAcjd,OAAS,GAEzB+c,EApC8B,GCUrCS,GAA6B,WAS7B,SAASA,EAAYC,GACjB,IAlBgB9Z,EAkBZwZ,EAAQH,KAMZA,KAAKU,UAAY,EAMjBV,KAAKW,YAAc,EAMnBX,KAAKY,kBAAoB,IAAIb,GAM7BC,KAAKa,0BAA4B,IAAId,GAMrCC,KAAKc,kBAAoB,IAAIf,GAQ7BC,KAAKe,kBAAmB,EACxBf,KAAKgB,gBAAkB,SAAU3d,EAAG4d,QACjB,IAAXA,IAAqBA,GAAS,GAClCd,EAAMvd,KAAOud,EAAMlY,QACnBkY,EAAMlY,QAAU5E,EAEhB,IAAII,EAAKiS,KAAgBjR,EAAQhB,EAAGgB,MAAOkP,EAAYlQ,EAAGkQ,UACtDwM,EAAMQ,cAAgBhN,IACtBwM,EAAMO,UAAYjc,EAClB0b,EAAMQ,YAAchN,EACpBwB,GAAK+L,WAAWf,EAAMgB,wBAGtBhB,EAAMvd,OAASud,EAAMlY,SACrBkY,EAAMS,kBAAkBR,OAAOD,EAAMlY,SAGrCkY,EAAMU,0BAA0BP,WAChCH,EAAMU,0BAA0BT,OAAOD,EAAM3B,eAG7CyC,GACAd,EAAMW,kBAAkBV,OAAOD,EAAMlY,UAW7C+X,KAAKmB,sBAAwB,WAAc,OAAOhM,GAAK+L,WAAWf,EAAMiB,gBAUxEpB,KAAKoB,cAAgB,SAAU3d,GACXA,EAAGkQ,YACDwM,EAAMQ,cACpBR,EAAMvd,KAAOud,EAAMlY,QACnBkY,EAAMU,0BAA0BT,OAAOD,EAAM3B,iBAGrDwB,KAAKqB,aAAc,EACnBrB,KAAKpd,KAAOod,KAAK/X,QAAUwY,EAC3BT,KAAKe,kBA5GWpa,EA4GgBqZ,KAAK/X,SA3GjC1C,MAAMuE,WAAWnD,KAoUzB,OAzIA6Z,EAAYpX,UAAUkY,SAAW,SAAUC,GACvC,OAAOvB,KAAKY,kBAAkBlM,IAAI6M,IAEtCf,EAAYpX,UAAUoY,eAAiB,WACnCxB,KAAKY,kBAAkBL,SAU3BC,EAAYpX,UAAUqY,gBAAkB,SAAUF,GAG9C,OADAA,EAAavB,KAAK7B,OACX6B,KAAKc,kBAAkBpM,IAAI6M,IAOtCf,EAAYpX,UAAUsY,OAAS,SAAUC,GACrC3B,KAAK2B,cAAgBA,GAiBzBnB,EAAYpX,UAAUqV,IAAM,SAAUpb,EAAG4d,QACtB,IAAXA,IAAqBA,GAAS,GAC7BA,GAAWjB,KAAK2B,cAIjB3B,KAAK2B,cAActe,EAAG2c,KAAKgB,iBAH3BhB,KAAKgB,gBAAgB3d,EAAG4d,IAahCT,EAAYpX,UAAU+U,IAAM,WACxB,OAAO6B,KAAK/X,SAKhBuY,EAAYpX,UAAUwY,YAAc,WAChC,OAAO5B,KAAKpd,MAShB4d,EAAYpX,UAAUoV,YAAc,WAEhC,OAAOwB,KAAKe,iBAEJ/I,GAAkBlO,WAAWkW,KAAK/X,SAC9B6B,WAAWkW,KAAKpd,MAAOod,KAAKU,WAClC,GAcVF,EAAYpX,UAAU6M,MAAQ,SAAU4B,GACpC,IAAIsI,EAAQH,KAEZ,OADAA,KAAK9J,OACE,IAAI2L,SAAQ,SAAUC,GACzB3B,EAAMkB,aAAc,EACpBlB,EAAM4B,cAAgBlK,EAAUiK,MACjCE,MAAK,WAAc,OAAO7B,EAAM8B,qBAOvCzB,EAAYpX,UAAU8M,KAAO,WACrB8J,KAAK+B,eACL/B,KAAK+B,gBACT/B,KAAKiC,kBAOTzB,EAAYpX,UAAU8Y,YAAc,WAChC,QAASlC,KAAK+B,eAElBvB,EAAYpX,UAAU6Y,eAAiB,WACnCjC,KAAK+B,cAAgB,MAWzBvB,EAAYpX,UAAU+Y,QAAU,WAC5BnC,KAAKY,kBAAkBL,QACvBP,KAAKc,kBAAkBP,QACvBP,KAAK9J,QAEFsK,EA7TsB,GAkUjC,SAAS4B,GAAY3B,GACjB,OAAO,IAAID,GAAYC,GC5U3B,ICHI4B,GDGAC,GAAgB,SAAUjf,GAAK,OAAO,SAAUuF,GAAQ,OAAOA,EAAKK,KAAK5F,KEIzEkf,GAAsB,CAACtY,IAAQuY,IAAIrX,IAASsX,IAASC,IAAIC,ICJlD,CACP1Z,KAAM,SAAU5F,GAAK,MAAa,SAANA,GAC5BgH,MAAO,SAAUhH,GAAK,OAAOA,KDM7Buf,GAAyB,SAAUvf,GACnC,OAAOkf,GAAoB9W,KAAK6W,GAAcjf,KEJ9Cwf,GAAaxU,YAAcA,YAAc,GAAI8L,YAAOoI,KAAuB,CAAC5W,EAAO0B,IAInFyV,GAAgB,SAAUzf,GAAK,OAAOwf,GAAWpX,KAAK6W,GAAcjf,K,QCCxE,SAAS0f,GAAeC,EAAe/c,EAAKU,GACpCqc,EAAcC,SAAShd,GACvB+c,EAAcE,SAASjd,GAAKwY,IAAI9X,GAGhCqc,EAAcG,SAASld,EAAKmc,GAAYzb,IAGhD,SAASyc,GAAUJ,EAAe9I,GAC9B,IAAImJ,EAAWC,aAAeN,EAAe9I,GACzCzW,EAAK4f,EACHL,EAAcO,qBAAqBF,GAAU,GAC7C,GAAIzf,EAAKH,EAAG+f,cAAeA,OAAuB,IAAP5f,EAAgB,GAAKA,EAAIH,EAAG0Z,WAAY,IAAIjP,EAAS1H,YAAO/C,EAAI,CAAC,gBAAiB,eAEnI,IAAK,IAAIwC,KADTiI,EAASrH,YAASA,YAAS,GAAIqH,GAASsV,GAChB,CAEpBT,GAAeC,EAAe/c,EADlBwd,aAA6BvV,EAAOjI,MAsExD,SAASyd,GAAwBzd,EAAKkX,GAClC,GAAKA,EAGL,OADsBA,EAAWlX,IAAQkX,EAAU,SAAeA,GAC3C/W,KCvE3B,SAASud,GAAeX,EAAeY,EAAS9d,GAC5C,IAAIrC,OACY,IAAZqC,IAAsBA,EAAU,IACpC,IAAIud,EAAWC,aAAeN,EAAeY,EAAS9d,EAAQ+d,QAC1DjgB,GAAMyf,GAAY,IAAIlG,WAAYA,OAAoB,IAAPvZ,EAAgBof,EAAcjF,wBAA0B,GAAKna,EAC5GkC,EAAQge,qBACR3G,EAAarX,EAAQge,oBAMzB,IAAI9F,EAAeqF,EACb,WAAc,OAAOU,GAAcf,EAAeK,EAAUvd,IAC5D,WAAc,OAAO+b,QAAQC,WAK/BkC,GAA+D,QAAxCvgB,EAAKuf,EAAciB,uBAAoC,IAAPxgB,OAAgB,EAASA,EAAGygB,MACjG,SAAUC,QACa,IAAjBA,IAA2BA,EAAe,GAC9C,IAAI1gB,EAAK0Z,EAAWK,cAAeA,OAAuB,IAAP/Z,EAAgB,EAAIA,EAAIga,EAAkBN,EAAWM,gBAAiBC,EAAmBP,EAAWO,iBACvJ,OA6CZ,SAAyBsF,EAAeY,EAASpG,EAAeC,EAAiBC,EAAkB5X,QACzE,IAAlB0X,IAA4BA,EAAgB,QACxB,IAApBC,IAA8BA,EAAkB,QAC3B,IAArBC,IAA+BA,EAAmB,GACtD,IAAI0G,EAAa,GACbC,GAAsBrB,EAAciB,gBAAgBC,KAAO,GAAKzG,EAChE6G,EAA+C,IAArB5G,EACxB,SAAUza,GAER,YADU,IAANA,IAAgBA,EAAI,GACjBA,EAAIwa,GAEb,SAAUxa,GAER,YADU,IAANA,IAAgBA,EAAI,GACjBohB,EAAqBphB,EAAIwa,GAOxC,OALA5a,MAAMuD,KAAK4c,EAAciB,iBACpBM,KAAKC,IACL/O,SAAQ,SAAUgP,EAAOxhB,GAC1BmhB,EAAWxX,KAAK+W,GAAec,EAAOb,EAAS/c,YAASA,YAAS,GAAIf,GAAU,CAAE+P,MAAO2H,EAAgB8G,EAAwBrhB,MAAO+e,MAAK,WAAc,OAAOyC,EAAMC,wBAAwBd,UAE5L/B,QAAQ8C,IAAIP,GAjEJQ,CAAgB5B,EAAeY,EAASpG,EAAgB2G,EAAc1G,EAAiBC,EAAkB5X,IAElH,WAAc,OAAO+b,QAAQC,WAK/BvE,EAAOJ,EAAWI,KACtB,GAAIA,EAAM,CACN,IAAIzZ,EAAKqW,YAAgB,mBAAToD,EACV,CAACS,EAAcgG,GACf,CAACA,EAAoBhG,GAAe,GAAI6G,EAAQ/gB,EAAG,GAAIghB,EAAOhhB,EAAG,GACvE,OAAO+gB,IAAQ7C,KAAK8C,GAGpB,OAAOjD,QAAQ8C,IAAI,CAAC3G,IAAgBgG,EAAmBle,EAAQ+P,SAMvE,SAASkO,GAAcf,EAAe9I,EAAYzW,GAC9C,IAAIG,EACAE,OAAY,IAAPL,EAAgB,GAAKA,EAAIO,EAAKF,EAAG+R,MAAOA,OAAe,IAAP7R,EAAgB,EAAIA,EAAI8f,EAAqBhgB,EAAGggB,mBAAoBlb,EAAO9E,EAAG8E,KACnI1E,EAAK8e,EAAcO,qBAAqBrJ,GAAazH,EAAKvO,EAAGiZ,WAAYA,OAAoB,IAAP1K,EAAgBuQ,EAAcjF,uBAAyBtL,EAAI+Q,EAAgBtf,EAAGsf,cAAetV,EAAS1H,YAAOtC,EAAI,CAAC,aAAc,kBACtN4f,IACA3G,EAAa2G,GACjB,IAAIM,EAAa,GACbW,EAAqBnc,IAAiD,QAAvChF,EAAKof,EAAcgC,sBAAmC,IAAPphB,OAAgB,EAASA,EAAGqhB,WAAWrc,IACzH,IAAK,IAAI3C,KAAOiI,EAAQ,CACpB,IAAIvH,EAAQqc,EAAcE,SAASjd,GAC/Bif,EAAchX,EAAOjI,GACzB,MAAKU,QACeT,IAAhBgf,GACCH,GACGI,GAAqBJ,EAAoB9e,IAHjD,CAMA,IAAI4R,EAAYkH,GAAe9Y,EAAKU,EAAOue,EAAare,YAAS,CAAEgP,MAAOA,GAASsH,IACnFiH,EAAWxX,KAAKiL,IAEpB,OAAOgK,QAAQ8C,IAAIP,GAAYpC,MAAK,WAChCwB,GAAiBJ,GAAUJ,EAAeQ,MA4BlD,SAASgB,GAAgB9f,EAAGC,GACxB,OAAOD,EAAE0gB,iBAAiBzgB,GAQ9B,SAASwgB,GAAqB1hB,EAAIwC,GAC9B,IAAIof,EAAgB5hB,EAAG4hB,cAAeC,EAAiB7hB,EAAG6hB,eACtDC,EAAcF,EAAchc,eAAepD,KAAgC,IAAxBqf,EAAerf,GAEtE,OADAqf,EAAerf,IAAO,EACfsf,GLxIX,SAAWlD,GACPA,EAAa,QAAc,UAC3BA,EAAa,MAAY,aACzBA,EAAa,IAAU,WACvBA,EAAa,KAAW,YACxBA,EAAa,MAAY,aACzBA,EAAa,KAAW,OAN5B,CAOGA,KAAkBA,GAAgB,KMArC,IAAImD,GAAuB,CACvBnD,GAAcoD,QACdpD,GAAcqD,MACdrD,GAAcsD,IACdtD,GAAcuD,KACdvD,GAAcwD,MACdxD,GAAcyD,MAEdC,GAAuB1X,YAAc,GAAI8L,YAAOqL,KAAuB1V,UACvEkW,GAAoBR,GAAqBxiB,OAC7C,SAASijB,GAAYjD,GACjB,OAAO,SAAUoB,GACb,OAAOvC,QAAQ8C,IAAIP,EAAWtX,KAAI,SAAUrJ,GACxC,IAAIoU,EAAYpU,EAAGoU,UAAW/R,EAAUrC,EAAGqC,QAC3C,ODdZ,SAA8Bkd,EAAe9I,EAAYpU,GAGrD,IAAI+R,EACJ,QAHgB,IAAZ/R,IAAsBA,EAAU,IACpCkd,EAAckD,uBAEVrjB,MAAMC,QAAQoX,GAAa,CAC3B,IAAIkK,EAAalK,EAAWpN,KAAI,SAAU8W,GACtC,OAAOD,GAAeX,EAAeY,EAAS9d,MAElD+R,EAAYgK,QAAQ8C,IAAIP,QAEvB,GAA0B,kBAAflK,EACZrC,EAAY8L,GAAeX,EAAe9I,EAAYpU,OAErD,CACD,IAAIqgB,EAA2C,oBAAfjM,EAC1BoJ,aAAeN,EAAe9I,EAAYpU,EAAQ+d,QAClD3J,EACNrC,EAAYkM,GAAcf,EAAemD,EAAoBrgB,GAEjE,OAAO+R,EAAUmK,MAAK,WAClB,OAAOgB,EAAc0B,wBAAwBxK,MCNlCkM,CAAqBpD,EAAenL,EAAW/R,QAIlE,SAASugB,GAAqBrD,GAC1B,IAAI7M,EAAU8P,GAAYjD,GACtBvc,EAsSR,WACI,IAAIhD,EACJ,OAAOA,EAAK,IACL4e,GAAcoD,SAAWa,IAAgB,GAC5C7iB,EAAG4e,GAAcqD,OAASY,KAC1B7iB,EAAG4e,GAAcsD,KAAOW,KACxB7iB,EAAG4e,GAAcuD,MAAQU,KACzB7iB,EAAG4e,GAAcwD,OAASS,KAC1B7iB,EAAG4e,GAAcyD,MAAQQ,KACzB7iB,EA/SQ8iB,GACRC,EAAkB,GAClBC,GAAkB,EAKlBC,EAA0B,SAAU5S,EAAKoG,GACzC,IAAImJ,EAAWC,aAAeN,EAAe9I,GAC7C,GAAImJ,EAAU,CACVA,EAASlG,WAAY,IAAIqG,EAAgBH,EAASG,cAAetV,EAAS1H,YAAO6c,EAAU,CAAC,aAAc,kBAC1GvP,EAAMjN,YAASA,YAASA,YAAS,GAAIiN,GAAM5F,GAASsV,GAExD,OAAO1P,GAsBX,SAAS6S,EAAe7gB,EAAS8gB,GAgM7B,IA/LA,IAAInjB,EACAojB,EAAQ7D,EAAc8D,WACtBC,EAAU/D,EAAcgE,mBAAkB,IAAS,GAKnD5C,EAAa,GAKb6C,EAAc,IAAItP,IAMlBuP,EAAkB,GAKlBC,EAAsBC,IACtBC,EAAU,SAAUpkB,GACpB,IAAI2F,EAAOmd,GAAqB9iB,GAC5BqkB,EAAY7gB,EAAMmC,GAClB2e,EAA8B,QAAtB9jB,EAAKojB,EAAMje,UAA0B,IAAPnF,EAAgBA,EAAKsjB,EAAQne,GACnE4e,EAAgBC,aAAeF,GAK/BG,EAAc9e,IAASge,EAAoBU,EAAUK,SAAW,MAChD,IAAhBD,IACAP,EAAsBlkB,GAO1B,IAAI2kB,EAAcL,IAASR,EAAQne,IAAS2e,IAASV,EAAMje,IAAS4e,EAepE,GAXII,GACAnB,GACAzD,EAAc6E,yBACdD,GAAc,GAMlBN,EAAUjC,cAAgBxe,YAAS,GAAIqgB,IAIrCI,EAAUK,UAA4B,OAAhBD,IAElBH,IAASD,EAAUQ,UAErBC,YAAoBR,IACJ,mBAATA,EACP,MAAO,WAOX,IAAIS,EAwKhB,SAA6BplB,EAAMD,GAC/B,GAAoB,kBAATA,EACP,OAAOA,IAASC,EAEf,GAAIqlB,aAAgBtlB,GACrB,OAAQD,EAAeC,EAAMC,GAEjC,OAAO,EA/KyBslB,CAAoBZ,EAAUQ,SAAUP,IAE3D3e,IAASge,GACNU,EAAUK,WACTC,GACDJ,GAEHvkB,EAAIkkB,GAAuBK,EAK5BW,EAAiBtlB,MAAMC,QAAQykB,GAAQA,EAAO,CAACA,GAK/Ca,EAAiBD,EAAepa,OAAO2Y,EAAyB,KAChD,IAAhBgB,IACAU,EAAiB,IAUrB,IAAIxkB,EAAK0jB,EAAUe,mBAAoBA,OAA4B,IAAPzkB,EAAgB,GAAKA,EAC7E0kB,EAAUzhB,YAASA,YAAS,GAAIwhB,GAAqBD,GACrDG,EAAgB,SAAUtiB,GAC1B+hB,GAAoB,EACpBf,EAAYnS,OAAO7O,GACnBqhB,EAAUhC,eAAerf,IAAO,GAEpC,IAAK,IAAIA,KAAOqiB,EAAS,CACrB,IAAI3lB,EAAOylB,EAAeniB,GACtBrD,EAAOylB,EAAmBpiB,GAE1BihB,EAAgB7d,eAAepD,KAK/BtD,IAASC,EAKLkb,YAAkBnb,IAASmb,YAAkBlb,GACxCF,EAAeC,EAAMC,GAQtB0kB,EAAUjC,cAAcpf,IAAO,EAP/BsiB,EAActiB,QAUJC,IAATvD,EAEL4lB,EAActiB,GAIdghB,EAAYvS,IAAIzO,QAGNC,IAATvD,GAAsBskB,EAAYhS,IAAIhP,GAK3CsiB,EAActiB,GAOdqhB,EAAUjC,cAAcpf,IAAO,GAOvCqhB,EAAUQ,SAAWP,EACrBD,EAAUe,mBAAqBD,EAI3Bd,EAAUK,WACVT,EAAkBrgB,YAASA,YAAS,GAAIqgB,GAAkBkB,IAE1D3B,GAAmBzD,EAAcwF,wBACjCR,GAAoB,GAOpBA,IAAsBJ,GACtBxD,EAAWxX,KAAKC,MAAMuX,EAAY/V,YAAc,GAAI8L,YAAOgO,EAAerb,KAAI,SAAU+K,GAAa,MAAQ,CACzGA,UAAWA,EACX/R,QAASe,YAAS,CAAE+B,KAAMA,GAAQ9C,WAUrC7C,EAAI,EAAGA,EAAI+iB,GAAmB/iB,IACnCokB,EAAQpkB,GAQZ,GANAujB,EAAkB3f,YAAS,GAAIqgB,GAM3BD,EAAY/C,KAAM,CAClB,IAAIuE,EAAsB,GAC1BxB,EAAYxR,SAAQ,SAAUxP,GAC1B,IAAIyiB,EAAiB1F,EAAc2F,cAAc1iB,QAC1BC,IAAnBwiB,IACAD,EAAoBxiB,GAAOyiB,MAGnCtE,EAAWxX,KAAK,CAAEiL,UAAW4Q,IAEjC,IAAIG,EAAgB9f,QAAQsb,EAAWphB,QAOvC,OANIyjB,IACkB,IAAlBI,EAAMgC,UACL7F,EAAc6E,yBACfe,GAAgB,GAEpBnC,GAAkB,EACXmC,EAAgBzS,EAAQiO,GAAcvC,QAAQC,UAezD,MAAO,CACHgH,WA9PJ,SAAoB7iB,GAChB,YAAgCC,IAAzBsgB,EAAgBvgB,IA8PvB0gB,eAAgBA,EAChBoC,UAbJ,SAAmBngB,EAAM+e,EAAU7hB,GAC/B,IAAIrC,EAEJ,OAAIgD,EAAMmC,GAAM+e,WAAaA,EAClB9F,QAAQC,WAEsB,QAAxCre,EAAKuf,EAAciB,uBAAoC,IAAPxgB,GAAyBA,EAAGgS,SAAQ,SAAUgP,GAAS,IAAIhhB,EAAI,OAAuC,QAA/BA,EAAKghB,EAAMO,sBAAmC,IAAPvhB,OAAgB,EAASA,EAAGslB,UAAUngB,EAAM+e,MAC3MlhB,EAAMmC,GAAM+e,SAAWA,EAChBhB,EAAe7gB,EAAS8C,KAM/BogB,mBA1PJ,SAA4BC,GACxB9S,EAAU8S,EAAajG,IA0PvBiC,SAAU,WAAc,OAAOxe,IAYvC,SAAS6f,GAAgBqB,GAErB,YADiB,IAAbA,IAAuBA,GAAW,GAC/B,CACHA,SAAUA,EACVtC,cAAe,GACfC,eAAgB,GAChB+C,mBAAoB,IC/T5B,IAAIa,GAA0B,SAAUC,GAAQ,OAAO,SAAUtC,GAE7D,OADAsC,EAAKtC,GACE,OCOPzC,GAAa,CACbvM,UAAWqR,IAAwB,SAAUzlB,GACzC,IAAIuf,EAAgBvf,EAAGuf,cAAe7M,EAAU1S,EAAG0S,QAMnD6M,EAAcgC,iBAAmBhC,EAAcgC,eAAiBqB,GAAqBrD,IAIjF+E,YAAoB5R,IACpBiT,qBAAU,WAAc,OAAOjT,EAAQkT,UAAUrG,KAAmB,CAAC7M,OAG7EmT,KAAMJ,IAAwB,SAAUrC,GACpC,IAAIhD,EAASgD,EAAMhD,OAAQb,EAAgB6D,EAAM7D,cAC7Cvf,EAAK0W,YAAOoP,cAAe,GAAIC,EAAY/lB,EAAG,GAAIgmB,EAAiBhmB,EAAG,GACtEimB,EAAkBC,qBAAWC,KACjCR,qBAAU,WACN,IAAI3lB,EAAIG,EACJiU,EAAoD,QAAvCpU,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,OAAgB,EAASA,EAAGslB,UAAU1G,GAAcyD,MAAO0D,EAAW,CAAE3F,OAA4G,QAAnGjgB,EAAyB,OAApB8lB,QAAgD,IAApBA,OAA6B,EAASA,EAAgB7F,cAA2B,IAAPjgB,EAAgBA,EAAKigB,KAChR2F,IAA4B,OAAd3R,QAAoC,IAAdA,GAAgCA,EAAUmK,KAAKyH,MACrF,CAACD,QC/BZ,SAASK,GAAY3b,EAAQ4b,EAAW5J,EAASpa,GAE7C,OADAoI,EAAO6b,iBAAiBD,EAAW5J,EAASpa,GACrC,WAAc,OAAOoI,EAAO8b,oBAAoBF,EAAW5J,EAASpa,IAuB/E,SAASmkB,GAAYC,EAAKJ,EAAW5J,EAASpa,GAC1CsjB,qBAAU,WACN,IAAIe,EAAUD,EAAIjiB,QAClB,GAAIiY,GAAWiK,EACX,OAAON,GAAYM,EAASL,EAAW5J,EAASpa,KAErD,CAACokB,EAAKJ,EAAW5J,EAASpa,IC1BjC,SAASskB,GAAaC,GAElB,QADmBA,EAAMC,QCQ7B,IAAIC,GAAmB,CAAEC,MAAO,EAAGC,MAAO,GAC1C,SAASC,GAAe1lB,EAAG2lB,QACL,IAAdA,IAAwBA,EAAY,QACxC,IACIC,EADe5lB,EAAEslB,QAAQ,IAAMtlB,EAAE6lB,eAAe,IACxBN,GAC5B,MAAO,CACH9P,EAAGmQ,EAAMD,EAAY,KACrBjQ,EAAGkQ,EAAMD,EAAY,MAG7B,SAASG,GAAeF,EAAOD,GAE3B,YADkB,IAAdA,IAAwBA,EAAY,QACjC,CACHlQ,EAAGmQ,EAAMD,EAAY,KACrBjQ,EAAGkQ,EAAMD,EAAY,MAG7B,SAASI,GAAiBV,EAAOM,GAE7B,YADkB,IAAdA,IAAwBA,EAAY,QACjC,CACHC,MAAOR,GAAaC,GACdK,GAAeL,EAAOM,GACtBG,GAAeT,EAAOM,IAMpC,IAAIK,GAAc,SAAU9K,EAAS+K,QACE,IAA/BA,IAAyCA,GAA6B,GAC1E,IAxC0BC,EAwCtBC,EAAW,SAAUd,GACrB,OAAOnK,EAAQmK,EAAOU,GAAiBV,KAE3C,OAAOY,GA3CmBC,EA4CCC,EA3CpB,SAAUd,GACb,IAAIe,EAAef,aAAiBgB,aACZD,GACnBA,GAAiC,IAAjBf,EAAMiB,SAEvBJ,EAAab,KAuCfc,G,SC/CNI,GAAkB,CAClBC,YAAa,YACbC,YAAa,YACbC,UAAW,UACXC,cAAe,cACfC,YAAa,YACbC,WAAY,WACZC,aAAc,aACdC,aAAc,cAEdC,GAAkB,CAClBR,YAAa,aACbC,YAAa,YACbC,UAAW,WACXC,cAAe,eAEnB,SAASM,GAAoBvQ,GACzB,OCjBOwQ,MAAsC,OAAzB/Y,OAAOgZ,cDkBhBzQ,ECfJwQ,MAAqC,OAAxB/Y,OAAOiZ,aDkBhBJ,GAAgBtQ,GCfpBwQ,MAAoC,OAAvB/Y,OAAOkZ,YDkBhBd,GAAgB7P,GAEpBA,EAEX,SAAS4Q,GAAgBpe,EAAQ4b,EAAW5J,EAASpa,GACjD,OAAO+jB,GAAY3b,EAAQ+d,GAAoBnC,GAAYkB,GAAY9K,EAAuB,gBAAd4J,GAA8BhkB,GAElH,SAASymB,GAAgBrC,EAAKJ,EAAW5J,EAASpa,GAC9C,OAAOmkB,GAAYC,EAAK+B,GAAoBnC,GAAY5J,GAAW8K,GAAY9K,EAAuB,gBAAd4J,GAA8BhkB,GEpC1H,SAAS0mB,GAAW9Q,GAChB,IAAI+Q,EAAO,KACX,OAAO,WAIH,OAAa,OAATA,IACAA,EAAO/Q,EAJI,WACX+Q,EAAO,QASnB,IAAIC,GAAuBF,GAAW,kBAClCG,GAAqBH,GAAW,gBA4BpC,SAASI,KAGL,IAAIC,EA9BR,SAAuBC,GACnB,IAAIL,GAAO,EACX,GAAa,MAATK,EACAL,EAAOE,UAEN,GAAa,MAATG,EACLL,EAAOC,SAEN,CACD,IAAIK,EAAmBL,KACnBM,EAAiBL,KACjBI,GAAoBC,EACpBP,EAAO,WACHM,IACAC,MAKAD,GACAA,IACAC,GACAA,KAGZ,OAAOP,EAKeQ,EAAc,GACpC,OAAKJ,IAELA,KACO,GC5CX,SAASK,GAAiBlK,EAAe2E,EAAUvU,GAC/C,OAAO,SAAUiX,EAAO8C,GACpB,IAAI1pB,GLPZ,SAAsB4mB,GAElB,MAA4B,qBAAjB+C,cAAgC/C,aAAiB+C,eACxB,UAAtB/C,EAAMgD,aAEbhD,aAAiBgB,YKGfD,CAAaf,KAAUuC,OAEf,OAAbxZ,QAAkC,IAAbA,GAA+BA,EAASiX,EAAO8C,GAC5B,QAAvC1pB,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,GAAyBA,EAAGslB,UAAU1G,GAAcqD,MAAOiC,KCJnH,IAAI2F,GAAgB,SAAhBA,EAA0BC,EAAQ9I,GAClC,QAAKA,IAGI8I,IAAW9I,GAIT6I,EAAcC,EAAQ9I,EAAM+I,iBCV3C,ICFIC,GASAC,GDPAC,GAAoB,CACpBC,IAAK1E,IEMT,SAAuBzlB,GACnB,ICXsB2P,EDWlBya,EAAQpqB,EAAGoqB,MAAOC,EAAarqB,EAAGqqB,WAAYC,EAActqB,EAAGsqB,YAAaC,EAAWvqB,EAAGuqB,SAAUhL,EAAgBvf,EAAGuf,cACvHiL,EAAoBJ,GAASC,GAAcC,GAAeC,EAC1DE,EAAaC,kBAAO,GACpBC,EAA4BD,iBAAO,MACvC,SAASE,IACL,IAAI5qB,EACyC,QAA5CA,EAAK2qB,EAA0BnmB,eAA4B,IAAPxE,GAAyBA,EAAG6F,KAAK8kB,GACtFA,EAA0BnmB,QAAU,KAExC,SAASqmB,IACL,IAAI7qB,EAIJ,OAHA4qB,IACAH,EAAWjmB,SAAU,EACmB,QAAvCxE,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,GAAyBA,EAAGslB,UAAU1G,GAAcsD,KAAK,IACjGiH,KAEZ,SAAS2B,EAAYlE,EAAO8C,GACnBmB,MAMJhB,GAActK,EAAcwL,cAAenE,EAAMnc,QAElC,OAAV2f,QAA4B,IAAVA,GAA4BA,EAAMxD,EAAO8C,GAD3C,OAAhBY,QAAwC,IAAhBA,GAAkCA,EAAY1D,EAAO8C,IAGvF,SAASsB,EAAgBpE,EAAO8C,GACvBmB,MAEW,OAAhBP,QAAwC,IAAhBA,GAAkCA,EAAY1D,EAAO8C,IAYjFZ,GAAgBvJ,EAAe,cAAeiL,EAV9C,SAAuB5D,EAAO8C,GAC1B,IAAI1pB,EACJ4qB,IACIH,EAAWjmB,UAEfimB,EAAWjmB,SAAU,EACrBmmB,EAA0BnmB,QAAU0F,EAAK2e,GAAgBnZ,OAAQ,YAAaob,GAAcjC,GAAgBnZ,OAAQ,gBAAiBsb,IACtH,OAAfX,QAAsC,IAAfA,GAAiCA,EAAWzD,EAAO8C,GAClC,QAAvC1pB,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,GAAyBA,EAAGslB,UAAU1G,GAAcsD,KAAK,UAE3Bzf,GCrD5DkN,EDsDLib,ECrDVjF,qBAAU,WAAc,OAAO,WAAc,OAAOhW,OAAkB,OHI7Esb,MAAOxF,IIEX,SAAyBzlB,GACrB,IAAIkrB,EAAalrB,EAAGkrB,WAAY3L,EAAgBvf,EAAGuf,cASnDiH,GAAYjH,EAAe,QAAS2L,EARtB,WACV,IAAIlrB,EACoC,QAAvCA,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,GAAyBA,EAAGslB,UAAU1G,GAAcwD,OAAO,SAMpD3f,GAC3D+jB,GAAYjH,EAAe,OAAQ2L,EALtB,WACT,IAAIlrB,EACoC,QAAvCA,EAAKuf,EAAcgC,sBAAmC,IAAPvhB,GAAyBA,EAAGslB,UAAU1G,GAAcwD,OAAO,SAGtD3f,MJZzD0oB,MAAO1F,IFMX,SAAyBzlB,GACrB,IAAIorB,EAAeprB,EAAGorB,aAAcC,EAAarrB,EAAGqrB,WAAYC,EAAatrB,EAAGsrB,WAAY/L,EAAgBvf,EAAGuf,cAC/GuJ,GAAgBvJ,EAAe,eAAgB6L,GAAgBE,EACzD7B,GAAiBlK,GAAe,EAAM6L,QACtC3oB,GACNqmB,GAAgBvJ,EAAe,eAAgB8L,GAAcC,EACvD7B,GAAiBlK,GAAe,EAAO8L,QACvC5oB,OOpBV,SAAS8oB,GAAS9O,GACd,MAAO,CAACA,EAAQ,KAAMA,EAAQ,MCFlC,SAAS+O,GAAKC,GACV,OAAOA,GLGX,SAAWzB,GACPA,EAASA,EAAQ,SAAe,GAAK,WACrCA,EAASA,EAAQ,QAAc,GAAK,UACpCA,EAASA,EAAQ,QAAc,GAAK,UAHxC,CAIGA,KAAaA,GAAW,KAK3B,SAAWC,GACPA,EAAiBA,EAAgB,KAAW,GAAK,OACjDA,EAAiBA,EAAgB,KAAW,GAAK,OAFrD,CAGGA,KAAqBA,GAAmB,KMwC3C,IAAIyB,GAAY,CACZC,UAAW,EACXlU,MAAO,EACPjN,OAAQ,EACRohB,YAAa,GAEjB,SAAS5qB,KACL,MAAO,CACHgW,EAAG5T,YAAS,GAAIsoB,IAChBzU,EAAG7T,YAAS,GAAIsoB,KCjExB,SAASG,GAAYtM,GACjB,IAAIvf,EAAKuf,EAAc8D,WAAYgG,EAAOrpB,EAAGqpB,KAAMyC,EAAS9rB,EAAG8rB,OAC/D,OAAOzC,IAASyC,ECOpB,SAASC,GAAUC,EAAMC,GACrBD,EAAKtsB,IAAMusB,EAAWvsB,IACtBssB,EAAKrsB,IAAMssB,EAAWtsB,IAc1B,SAASusB,GAAW/E,EAAO1P,EAAOmU,GAG9B,OAAOA,EADMnU,GADY0P,EAAQyE,GAOrC,SAASO,GAAgBhF,EAAOwE,EAAWlU,EAAOmU,EAAaQ,GAI3D,YAHiB3pB,IAAb2pB,IACAjF,EAAQ+E,GAAW/E,EAAOiF,EAAUR,IAEjCM,GAAW/E,EAAO1P,EAAOmU,GAAeD,EAKnD,SAASU,GAAeL,EAAML,EAAWlU,EAAOmU,EAAaQ,QACvC,IAAdT,IAAwBA,EAAY,QAC1B,IAAVlU,IAAoBA,EAAQ,GAChCuU,EAAKtsB,IAAMysB,GAAgBH,EAAKtsB,IAAKisB,EAAWlU,EAAOmU,EAAaQ,GACpEJ,EAAKrsB,IAAMwsB,GAAgBH,EAAKrsB,IAAKgsB,EAAWlU,EAAOmU,EAAaQ,GAKxE,SAASE,GAAcC,EAAKvsB,GACxB,IAAIgX,EAAIhX,EAAGgX,EAAGC,EAAIjX,EAAGiX,EACrBoV,GAAeE,EAAIvV,EAAGA,EAAE2U,UAAW3U,EAAES,MAAOT,EAAE4U,aAC9CS,GAAeE,EAAItV,EAAGA,EAAE0U,UAAW1U,EAAEQ,MAAOR,EAAE2U,aAOlD,SAASY,GAAoBC,EAAOT,EAAMU,EAAY1sB,GAClD,IAAIG,EAAKuW,YAAO1W,EAAI,GAAIwC,EAAMrC,EAAG,GAAIwsB,EAAWxsB,EAAG,GAAIysB,EAAYzsB,EAAG,GAEtEssB,EAAM/sB,IAAMssB,EAAKtsB,IACjB+sB,EAAM9sB,IAAMqsB,EAAKrsB,IACjB,IAAIktB,OAAuCpqB,IAA1BiqB,EAAWE,GAA2BF,EAAWE,GAAa,GAC3EhB,EAAc3mB,EAAI+mB,EAAKtsB,IAAKssB,EAAKrsB,IAAKktB,GAE1CR,GAAeI,EAAOC,EAAWlqB,GAAMkqB,EAAWC,GAAWf,EAAac,EAAWjV,OAKzF,IAAIqV,GAAQ,CAAC,IAAK,SAAU,WACxBC,GAAQ,CAAC,IAAK,SAAU,WAI5B,SAASC,GAAmBC,EAAUV,EAAKG,GACvCF,GAAoBS,EAASjW,EAAGuV,EAAIvV,EAAG0V,EAAYI,IACnDN,GAAoBS,EAAShW,EAAGsV,EAAItV,EAAGyV,EAAYK,IAKvD,SAASG,GAAiB/F,EAAOwE,EAAWlU,EAAOmU,EAAaQ,GAM5D,OAJAjF,EAAQ+E,GADR/E,GAASwE,EACiB,EAAIlU,EAAOmU,QACpBnpB,IAAb2pB,IACAjF,EAAQ+E,GAAW/E,EAAO,EAAIiF,EAAUR,IAErCzE,EAiBX,SAASgG,GAAqBnB,EAAMU,EAAY1sB,GAC5C,IAAIG,EAAKuW,YAAO1W,EAAI,GAAIwC,EAAMrC,EAAG,GAAIwsB,EAAWxsB,EAAG,GAAIysB,EAAYzsB,EAAG,IAb1E,SAAyB6rB,EAAML,EAAWlU,EAAOjN,EAAQ4hB,QACnC,IAAdT,IAAwBA,EAAY,QAC1B,IAAVlU,IAAoBA,EAAQ,QACjB,IAAXjN,IAAqBA,EAAS,IAClC,IAAIohB,EAAc3mB,EAAI+mB,EAAKtsB,IAAKssB,EAAKrsB,IAAK6K,GAAUmhB,EACpDK,EAAKtsB,IAAMwtB,GAAiBlB,EAAKtsB,IAAKisB,EAAWlU,EAAOmU,EAAaQ,GACrEJ,EAAKrsB,IAAMutB,GAAiBlB,EAAKrsB,IAAKgsB,EAAWlU,EAAOmU,EAAaQ,GAQrEgB,CAAgBpB,EAAMU,EAAWlqB,GAAMkqB,EAAWC,GAAWD,EAAWE,GAAYF,EAAWjV,OC/GnG,IAAI4V,GAAU,SAAUlG,GACpB,OAAOA,EAAMvhB,eAAe,MAAQuhB,EAAMvhB,eAAe,MCCzD0nB,GAAY,SAAUnG,GACtB,OAAOkG,GAAQlG,IAAUA,EAAMvhB,eAAe,MCC9C2nB,GAAa,SAAUtsB,EAAGC,GAAK,OAAOrB,KAAKkE,IAAI9C,EAAIC,ICEvD,SAASssB,GAAOtqB,EAAOuH,EAAQgjB,GAG3B,YAFe,IAAXhjB,IAAqBA,EAAS,QACd,IAAhBgjB,IAA0BA,EAAc,KDHhD,SAAkBxsB,EAAGC,GACjB,GAAI8I,EAAM/I,IAAM+I,EAAM9I,GAClB,OAAOqsB,GAAWtsB,EAAGC,GAEpB,GAAImsB,GAAQpsB,IAAMosB,GAAQnsB,GAAI,CAC/B,IAAIwsB,EAASH,GAAWtsB,EAAE+V,EAAG9V,EAAE8V,GAC3B2W,EAASJ,GAAWtsB,EAAEgW,EAAG/V,EAAE+V,GAC3B2W,EAASN,GAAUrsB,IAAMqsB,GAAUpsB,GAAKqsB,GAAWtsB,EAAEiW,EAAGhW,EAAEgW,GAAK,EACnE,OAAOrX,KAAKoC,KAAKpC,KAAK2B,IAAIksB,EAAQ,GAAK7tB,KAAK2B,IAAImsB,EAAQ,GAAK9tB,KAAK2B,IAAIosB,EAAQ,KCJ3EC,CAAS3qB,EAAOuH,GAAUgjB,EAErC,SAASK,GAAW9B,GAChB,OAAOA,EAAKrsB,IAAMqsB,EAAKtsB,IAwB3B,SAASquB,GAAgB/sB,EAAOgtB,EAAQvjB,EAAQD,QAC7B,IAAXA,IAAqBA,EAAS,IAClCxJ,EAAMwJ,OAASA,EACfxJ,EAAM4qB,YAAc3mB,EAAI+oB,EAAOtuB,IAAKsuB,EAAOruB,IAAKqB,EAAMwJ,QACtDxJ,EAAMyW,MAAQqW,GAAWrjB,GAAUqjB,GAAWE,GAC1CR,GAAOxsB,EAAMyW,MAAO,EAAG,QACvBzW,EAAMyW,MAAQ,GAClBzW,EAAM2qB,UACF1mB,EAAIwF,EAAO/K,IAAK+K,EAAO9K,IAAKqB,EAAMwJ,QAAUxJ,EAAM4qB,YAClD4B,GAAOxsB,EAAM2qB,aACb3qB,EAAM2qB,UAAY,GAQ1B,SAASsC,GAAejtB,EAAOgtB,EAAQvjB,EAAQD,GAC3CujB,GAAgB/sB,EAAMgW,EAAGgX,EAAOhX,EAAGvM,EAAOuM,EAAGkX,GAAc1jB,EAAO2jB,UAClEJ,GAAgB/sB,EAAMiW,EAAG+W,EAAO/W,EAAGxM,EAAOwM,EAAGiX,GAAc1jB,EAAO4jB,UAMtE,SAASF,GAAc1jB,GACnB,MAAyB,kBAAXA,EAAsBA,EAAS,GAEjD,SAAS6jB,GAAiB5jB,EAAQ6jB,EAAUxE,GACxCrf,EAAO/K,IAAMoqB,EAAOpqB,IAAM4uB,EAAS5uB,IACnC+K,EAAO9K,IAAM8K,EAAO/K,IAAMouB,GAAWQ,G,YC1DzC,SAASC,KACL,MAAO,CACHC,YAAY,EACZC,OPiCG,CAAEzX,EAAG,CAAEtX,IAAK,EAAGC,IAAK,GAAKsX,EAAG,CAAEvX,IAAK,EAAGC,IAAK,IOhC9C+uB,gBPgCG,CAAE1X,EAAG,CAAEtX,IAAK,EAAGC,IAAK,GAAKsX,EAAG,CAAEvX,IAAK,EAAGC,IAAK,IO/B9CgvB,UAAW,CAAE3X,EAAG,EAAGC,EAAG,GACtBjW,MAAOA,KACP4tB,WAAY5tB,KACZ6tB,eAAgB,IAGxB,IAAIC,GAAaP,KCdjB,SAASQ,GAA+B/uB,EAAI2uB,EAAWK,GACnD,IAAIhY,EAAIhX,EAAGgX,EAAGC,EAAIjX,EAAGiX,EASjBxQ,EAAY,eAFCuQ,EAAE2U,UAAYgD,EAAU3X,EAEK,OAD7BC,EAAE0U,UAAYgD,EAAU1X,EAC2B,UACpE,GAAI+X,EAAiB,CACjB,IAAI7X,EAAS6X,EAAgB7X,OAAQC,EAAU4X,EAAgB5X,QAASC,EAAU2X,EAAgB3X,QAC9FF,IACA1Q,GAAa,UAAY0Q,EAAS,MAClCC,IACA3Q,GAAa,WAAa2Q,EAAU,MACpCC,IACA5Q,GAAa,WAAa4Q,EAAU,MAG5C,OADA5Q,GAAa,SAAWuQ,EAAES,MAAQ,KAAOR,EAAEQ,MAAQ,IAC3CuX,GAAmBvoB,IAAcwoB,GAA0BxoB,EAAL,GAKlE,SAASyoB,GAAqClvB,GAC1C,IAAI4uB,EAAa5uB,EAAG4uB,WACpB,OAA6B,IAAtBA,EAAW5X,EAAExM,OAAe,KAA6B,IAAtBokB,EAAW3X,EAAEzM,OAAe,MAE1E,IAAIykB,GAAqBF,GAA+BD,GAAW9tB,MAAO8tB,GAAWH,UAAW,CAAE3X,EAAG,EAAGC,EAAG,ICjCvGkY,GAAQ,CACR,gBACA,sBACA,eACA,oBACA,SACA,SACA,oBACA,0BACA,iBACA,gBACA,WCXJ,SAASC,GAAmBpvB,EAAIG,EAAIkvB,EAAUC,GAC1C,IRcc/C,EAAKgD,EQdfvuB,EAAQhB,EAAGgB,MAAOytB,EAASzuB,EAAGyuB,OAAQC,EAAkB1uB,EAAG0uB,gBAAiBC,EAAY3uB,EAAG2uB,UAC3FlkB,EAAStK,EAAGsK,ORaG8kB,EQROd,ERS1B1C,IADcQ,EQRLmC,GRSK1X,EAAGuY,EAAUvY,GAC3B+U,GAAUQ,EAAItV,EAAGsY,EAAUtY,GA2G/B,SAAyBsV,EAAKoC,EAAWU,GACrC,IAAIG,EAAaH,EAAS9vB,OAC1B,GAAKiwB,EAAL,CAIA,IAAIC,EACAzuB,EAFJ2tB,EAAU3X,EAAI2X,EAAU1X,EAAI,EAG5B,IAAK,IAAIzX,EAAI,EAAGA,EAAIgwB,EAAYhwB,IAE5BwB,GADAyuB,EAAOJ,EAAS7vB,IACHkwB,iBAAiB1uB,MAE9B2tB,EAAU3X,GAAKhW,EAAMgW,EAAES,MACvBkX,EAAU1X,GAAKjW,EAAMiW,EAAEQ,MAEvB6U,GAAcC,EAAKvrB,GAEf6qB,GAAY4D,IACZzC,GAAmBT,EAAKA,EAAKkD,EAAKE,oBQlI1CC,CAAgBlB,EAAiBC,EAAWU,GAU5CpB,GAAejtB,EAAO0tB,EAAiBjkB,EAAQ6kB,GCzBnD,IAAIO,GAAiB,SAAU5uB,EAAGC,GAC9B,OAAOD,EAAE6uB,MAAQ5uB,EAAE4uB,OCEnBC,GAA0B,WAC1B,SAASA,IACLxT,KAAKyT,SAAW,GAChBzT,KAAK0T,SAAU,EAenB,OAbAF,EAASpqB,UAAUsL,IAAM,SAAU+P,GAC/B9E,GAAcK,KAAKyT,SAAUhP,GAC7BzE,KAAK0T,SAAU,GAEnBF,EAASpqB,UAAUuqB,OAAS,SAAUlP,GAClC3E,GAAWE,KAAKyT,SAAUhP,GAC1BzE,KAAK0T,SAAU,GAEnBF,EAASpqB,UAAUqM,QAAU,SAAUrC,GACnC4M,KAAK0T,SAAW1T,KAAKyT,SAASlP,KAAK+O,IACnCtT,KAAK0T,SAAU,EACf1T,KAAKyT,SAAShe,QAAQrC,IAEnBogB,EAlBmB,GCG9B,SAASI,GAAuBrG,EAAQ9I,GACpC,MAAO,CACHthB,IAAKshB,EAAMthB,IAAMoqB,EAAOpqB,IACxBC,IAAKqhB,EAAMrhB,IAAMmqB,EAAOpqB,KCNhC,SAAS0wB,GAAsB7Q,GAC3B,IAAI8Q,EAAmB9Q,EAAc+Q,sBACrC,GAAKD,EAAL,CAIA,IDGwBvG,EAAQ9I,ECH5BuP,GDGoBzG,ECHgBuG,EAAiBX,iBAAiBjB,ODG1CzN,ECHkDzB,EAAcmQ,iBAAiBjB,ODI1G,CACHzX,EAAGmZ,GAAuBrG,EAAO9S,EAAGgK,EAAMhK,GAC1CC,EAAGkZ,GAAuBrG,EAAO7S,EAAG+J,EAAM/J,KCL9CsU,IAAS,SAAUS,GACfzM,EAAciR,wBAAwBxE,EAAMuE,EAAevE,GAAMtsB,IAAK6wB,EAAevE,GAAMrsB,KAAK,WALhG4f,EAAckR,yBCetB,IAAIlR,GAAgB,SAAUvf,GAC1B,IAAIG,EAAKH,EAAG0wB,SAAUA,OAAkB,IAAPvwB,EAAgB,GAAKA,EAAIwwB,EAAQ3wB,EAAG2wB,MAAOzL,EAAgBllB,EAAGklB,cAAepF,EAAuB9f,EAAG8f,qBAAsB8Q,EAAqB5wB,EAAG4wB,mBAAoBC,EAAiB7wB,EAAGwd,OAAQsT,EAAwB9wB,EAAG8wB,sBAAuBC,EAAiB/wB,EAAG+wB,eAAgBC,EAAmBhxB,EAAGgxB,iBAAkBC,EAA6BjxB,EAAGixB,2BAA4BtP,EAAmB3hB,EAAG2hB,iBAAkBuP,EAA8BlxB,EAAGkxB,4BACze,OAAO,SAAUlxB,EAAIqC,GACjB,IAAIynB,EAAS9pB,EAAG8pB,OAAQ1G,EAAQpjB,EAAGojB,MAAO+N,EAAanxB,EAAGmxB,WAAYpM,EAAwB/kB,EAAG+kB,sBAAuBqM,EAAcpxB,EAAGoxB,iBACzH,IAAZ/uB,IAAsBA,EAAU,IACpC,IAOIgvB,EAgBAhB,EAUAiB,EAYAC,EA6BAC,EAWAC,EArFAC,EAAeN,EAAYM,aAAcC,EAAcP,EAAYO,YAYnEC,ENtBZ,WACI,IAAIC,EAAW1C,GAAM9lB,KAAI,WAAc,OAAO,IAAIiT,MAC9CwV,EAAoB,GACpBF,EAAa,CACbG,kBAAmB,WAAc,OAAOF,EAAS7f,SAAQ,SAAUggB,GAAW,OAAOA,EAAQlV,YAC7FmV,oBAAqB,SAAU7O,GAC3B,OAAO+L,GAAMnd,SAAQ,SAAUiG,GAC3B,IAAIjY,EAC+B,QAAlCA,EAAK8xB,EAAkB7Z,UAA0B,IAAPjY,GAAyBA,EAAG6F,KAAKisB,GAC5E,IAAII,EAAK,KAAOja,EACZka,EAAe/O,EAAM8O,GACrBC,IACAL,EAAkB7Z,GAAQ2Z,EAAWM,GAAIC,SAezD,OAVAN,EAAS7f,SAAQ,SAAUggB,EAASxyB,GAChCoyB,EAAW,KAAOzC,GAAM3vB,IAAM,SAAUid,GAAW,OAAOuV,EAAQ/gB,IAAIwL,IACtEmV,EAAW,SAAWzC,GAAM3vB,IAAM,WAE9B,IADA,IAAI4yB,EAAO,GACFhoB,EAAK,EAAGA,EAAKC,UAAU9K,OAAQ6K,IACpCgoB,EAAKhoB,GAAMC,UAAUD,GAEzB,OAAO4nB,EAAQrV,OAAOvT,MAAM4oB,EAASpnB,YAAc,GAAI8L,YAAO0b,SAG/DR,EMLcS,GAIbC,ERxCsC,CAC9CC,WAAW,EACX/D,YAAY,EACZgE,gBAAgB,EAChB/nB,OPuCO,CAAEuM,EAAG,CAAEtX,IAAK,EAAGC,IAAK,GAAKsX,EAAG,CAAEvX,IAAK,EAAGC,IAAK,IOtClD8yB,YPsCO,CAAEzb,EAAG,CAAEtX,IAAK,EAAGC,IAAK,GAAKsX,EAAG,CAAEvX,IAAK,EAAGC,IAAK,KeY1C+yB,EAAiBJ,EACjBK,EAAmBjB,EASnBkB,EAAcrE,KASdsE,GAAwB,EAMxB/pB,EAAS,IAAIgqB,IAKbC,EAAqB,IAAID,IAMzBE,EAAmB,GAYnBC,EAAa7vB,YAAS,GAAIsuB,GAU9B,SAASlU,IACA6T,IAED3K,EAAQwM,sBAMRlG,GAAmB0F,EAAeD,YAAaC,EAAejoB,OAAQkoB,GAOtE1E,GAAe2E,EAAYhE,WAAYgE,EAAYlE,gBAAiBgE,EAAeD,YAAaf,IAEpGyB,IACAtC,EAAeQ,EAAUM,IAE7B,SAASwB,IACL,IAAIC,EAAiB1B,EACrB,GAAIH,GAAcA,EAAWrN,WAAY,CACrC,IAAImP,EAAmB9B,EAAW+B,kBAAkB5M,GAChD2M,IACAD,EAAiBC,GAEzB1C,EAAMjK,EAASiL,EAAayB,EAAgBV,EAAgBE,EAAavwB,EAAS+gB,GAEtF,SAAS9Q,IACLsf,EAAW2B,aAAa7B,GAsB5B,SAAS8B,IACL9M,EAAQ+M,WAAWzhB,QAAQ0hB,IA0B/B,IAAIC,EAAsBzC,EAA4B9N,GACtD,IAAK,IAAI5gB,KAAOmxB,EAAqB,CACjC,IAAIzwB,EAAQywB,EAAoBnxB,QACNC,IAAtBivB,EAAalvB,IAAsBoxB,aAAc1wB,IACjDA,EAAM8X,IAAI0W,EAAalvB,IAAM,GAMrC,IAAIqxB,EAAwBC,aAA2B1Q,GACnD2Q,EAAgBC,aAAmB5Q,GACnCsD,EAAUtjB,YAASA,YAAS,CAAEstB,SAAUA,EAKxClsB,QAAS,KAITsrB,MAAOhG,EAASA,EAAOgG,MAAQ,EAAI,EAAGhG,OAAQA,EAAQkG,SAAU,IAAI9b,IAKpE+f,KAAMnK,EAASlf,YAAcA,YAAc,GAAI8L,YAAOoT,EAAOmK,OAAQ,CAACnK,IAAW,GAAI2J,WAAY3J,EAASA,EAAO2J,WAAa,IAAI1D,GAIlIoB,WAAYA,EACZmB,WAAYA,EAMZ9R,gBAAiBuT,EAAgB,IAAI7f,SAAQzR,EAO7CyxB,eAAWzxB,EASX2hB,uBAAwB/e,QAAmB,OAAXykB,QAA8B,IAAXA,OAAoB,EAASA,EAAOqK,aAKvFpP,sBAAuBA,EAMvBoP,UAAW,WAAc,OAAO9uB,QAAQgsB,IAAc+C,MAAO,SAAUC,GACnEhD,EAAW3K,EAAQliB,QAAU6vB,EAC7B3N,EAAQ4N,QAAQ5N,GACZqN,GAAiBjK,IAAW+J,IAC5BpC,EAAmC,OAAX3H,QAA8B,IAAXA,OAAoB,EAASA,EAAOyK,gBAAgB7N,IAExF,OAAXoD,QAA8B,IAAXA,GAA6BA,EAAOkG,SAAS/e,IAAIyV,IAKxE8N,QAAS,WACL5iB,GAAWU,OAAOA,GAClBV,GAAW4L,OAAOA,GAClB5L,GAAW6iB,UAAU/N,EAAQgO,wBAC7B3B,EAAmB/gB,SAAQ,SAAUke,GAAU,OAAOA,OACtDxJ,EAAQiO,sBACRjO,EAAQ+M,WAAWvD,OAAOxJ,GACA,OAA1B+K,QAA4D,IAA1BA,GAA4CA,IACnE,OAAX3H,QAA8B,IAAXA,GAA6BA,EAAOkG,SAAS3e,OAAOqV,GAClC,OAArC4K,QAAkF,IAArCA,GAAuDA,IACpGM,EAAWG,qBAKfwC,gBAAiB,SAAUvT,GACvB,IAAIhhB,EACA40B,EAAqBlO,EAAQmO,wBACjC,GAAID,EAEA,OAD8C,QAA7C50B,EAAK40B,EAAmBpU,uBAAoC,IAAPxgB,GAAyBA,EAAGiR,IAAI+P,GAC/E,WAAc,OAAO4T,EAAmBpU,gBAAgBnP,OAAO2P,KAG9EW,iBAAkB,SAAUmT,GAIxB,OAAKnT,GAAoB+O,IAAaoE,EAAMpE,SAErC/O,EAAiB+E,EAAQqE,cAAe+J,EAAM/J,eAD1C,GAOf8J,sBAAuB,WACnB,OAAOd,EAAgBrN,EAAqB,OAAXoD,QAA8B,IAAXA,OAAoB,EAASA,EAAO+K,yBAO5FE,+BAAgCjL,EAC1BA,EAAOiL,+BACP,WACE,OAAOrjB,GAAK+iB,UAAU/N,EAAQ8M,4BAA4B,GAAO,IAKzEwB,YAAa,WAAc,OAAO5R,EAAM6R,UAIxClK,YAAa,WAAc,OAAOsG,GAIlC6D,eAAgB,SAAU1yB,GAAO,OAAOkvB,EAAalvB,IAAS2yB,eAAgB,SAAU3yB,EAAKU,GAAS,OAAQwuB,EAAalvB,GAAOU,GAMlIysB,gBAAiB,WAAc,OAAO+B,GAKtC0D,cAAe,SAAUC,GACjB3O,EAAQwN,YAAcmB,IAE1B3O,EAAQwN,UAAYmB,EACpB3O,EAAQ4O,mBASZxV,qBAAsB,SAAUrV,EAAQ8qB,GAEpC,YADkB,IAAdA,IAAwBA,GAAY,GACjCzV,EAAqB4G,EAASjc,EAAQ2Y,EAAOmS,IAMxD7V,SAAU,SAAUld,EAAKU,GAEjBwjB,EAAQlH,SAAShd,IACjBkkB,EAAQ8O,YAAYhzB,GACxBsG,EAAOkS,IAAIxY,EAAKU,GAChBwuB,EAAalvB,GAAOU,EAAMwX,MAhMlC,SAA2BlY,EAAKU,GAC5B,IAAIuyB,EAAiBvyB,EAAM2a,UAAS,SAAU6X,GAC1ChE,EAAalvB,GAAOkzB,EACpBtS,EAAMzP,UAAYjC,GAAKY,OAAOA,GAAQ,GAAO,MAE7CqjB,EAAwBzyB,EAAM8a,gBAAgB0I,EAAQ4O,gBAC1DvC,EAAmB/X,IAAIxY,GAAK,WACxBizB,IACAE,OAyLAC,CAAkBpzB,EAAKU,IAK3BsyB,YAAa,SAAUhzB,GACnB,IAAIxC,EACJ8I,EAAOuI,OAAO7O,GACyB,QAAtCxC,EAAK+yB,EAAmBrY,IAAIlY,UAAyB,IAAPxC,GAAyBA,IACxE+yB,EAAmB1hB,OAAO7O,UACnBkvB,EAAalvB,GACpByuB,EAA2BzuB,EAAKmvB,IAKpCnS,SAAU,SAAUhd,GAAO,OAAOsG,EAAO0I,IAAIhP,IAK7Cid,SAAU,SAAUjd,EAAK2V,GACrB,IAAIjV,EAAQ4F,EAAO4R,IAAIlY,GAKvB,YAJcC,IAAVS,QAAwCT,IAAjB0V,IACvBjV,EAAQyb,GAAYxG,GACpBuO,EAAQhH,SAASld,EAAKU,IAEnBA,GAKX2yB,aAAc,SAAUlmB,GAAY,OAAO7G,EAAOkJ,QAAQrC,IAM1DmmB,UAAW,SAAUtzB,GAAO,IAAIxC,EAAI,OAAoC,QAA5BA,EAAK0xB,EAAalvB,UAAyB,IAAPxC,EAAgBA,EAAK8wB,EAAsBO,EAAU7uB,EAAKH,IAK1I0zB,cAAe,SAAUvzB,EAAKU,GAC1B+vB,EAAWzwB,GAAOU,GAMtBgiB,cAAe,SAAU1iB,GACrB,GAAI0iB,EAAe,CACf,IAAIza,EAASya,EAAc9B,EAAO5gB,GAClC,QAAeC,IAAXgI,IAAyBmpB,aAAcnpB,GACvC,OAAOA,EAEf,OAAOwoB,EAAWzwB,KACjBovB,GAAa,CAIlBjB,MAAO,WAEH,OADAwC,IACOxB,GAKX2D,eAAgB,WACZ5jB,GAAK8L,OAAOA,GAAQ,GAAO,IAQ/BwY,WAAYxY,EAKZyY,SAAU,SAAUC,GAChB9S,EAAQ8S,EACRtE,EAAWK,oBAAoBiE,GAC/BlD,ECjchB,SAAqCtM,EAASxnB,EAAMC,GAChD,IAAIa,EACJ,IAAK,IAAIwC,KAAOtD,EAAM,CAClB,IAAIi3B,EAAYj3B,EAAKsD,GACjB4zB,EAAYj3B,EAAKqD,GACrB,GAAIoxB,aAAcuC,GAKdzP,EAAQhH,SAASld,EAAK2zB,QAErB,GAAIvC,aAAcwC,GAKnB1P,EAAQhH,SAASld,EAAKmc,GAAYwX,SAEjC,GAAIC,IAAcD,EAMnB,GAAIzP,EAAQlH,SAAShd,GAAM,CACvB,IAAI6zB,EAAgB3P,EAAQjH,SAASjd,IAEpC6zB,EAAczY,aAAeyY,EAAcrb,IAAImb,QAGhDzP,EAAQhH,SAASld,EAAKmc,GAAmD,QAAtC3e,EAAK0mB,EAAQwO,eAAe1yB,UAAyB,IAAPxC,EAAgBA,EAAKm2B,IAKlH,IAAK,IAAI3zB,KAAOrD,OACMsD,IAAdvD,EAAKsD,IACLkkB,EAAQ8O,YAAYhzB,GAE5B,OAAOtD,EDyZwBo3B,CAA4B5P,EAASwK,EAA4B9N,GAAQ4P,IAC7F3P,SAAU,WAAc,OAAOD,GAKlCmT,WAAY,SAAUte,GAAQ,IAAIjY,EAAI,OAAiC,QAAzBA,EAAKojB,EAAMoT,gBAA6B,IAAPx2B,OAAgB,EAASA,EAAGiY,IAI3GqC,qBAAsB,WAAc,OAAO8I,EAAM1J,YAIjD6J,kBAAmB,SAAUkT,GAEzB,QADsB,IAAlBA,IAA4BA,GAAgB,GAC5CA,EACA,OAAkB,OAAX3M,QAA8B,IAAXA,OAAoB,EAASA,EAAOvG,oBAClE,IAAKsQ,EAAuB,CACxB,IAAI6C,GAAwB,OAAX5M,QAA8B,IAAXA,OAAoB,EAASA,EAAOvG,sBAAwB,GAIhG,YAHsB9gB,IAAlB2gB,EAAMgC,UACNsR,EAAUtR,QAAUhC,EAAMgC,SAEvBsR,EAGX,IADA,IAAIpT,EAAU,GACL9jB,EAAI,EAAGA,EAAIm3B,GAAiBn3B,IAAK,CACtC,IAAIo3B,EAASC,GAAar3B,GACtBskB,EAAOV,EAAMwT,IACb5S,aAAeF,KAAkB,IAATA,KACxBR,EAAQsT,GAAU9S,GAG1B,OAAOR,GAOXwT,uBAAwB,WACpBxE,EAAWC,WAAY,EACvB7L,EAAQ+M,WAAWxiB,IAAIyV,IAM3BqQ,qBAAsB,WAClBzE,EAAWE,gBAAiB,GAEhCwE,uBAAwB,WACpBtQ,EAAQiO,sBACRrC,EAAWE,gBAAiB,GAC7B9C,eAAgB,WAAc,OAAOkD,GAAgBqE,cAAe,SAAUC,GAC7E3F,EAAa2F,GACdhE,kBAAmB,WAClB,OAAOZ,EAAWC,WACdD,EAAW9D,YACXoE,EAAYpE,YAKpB2I,qBAAsB,SAAUnL,EAAMtS,EAAY0d,QAC3B,IAAfA,IAAyBA,GAAa,GAC1C,IAAIryB,EAAW2hB,EAAQ2Q,iCAAiCrL,GACpDhsB,EAAKo3B,EACH9E,EAAWgF,eAAetL,GAC1BsG,EAAW7nB,OAAOuhB,GAAOtsB,EAAMM,EAAGN,IACpCH,EAD+CS,EAAGL,IACnCD,EAOnB,OANAqF,EAASgZ,iBACThZ,EAASiW,IAAItb,GACbqF,EAASiW,IAAItb,GACbqF,EAAS8Y,UAAS,SAAUje,GACxB8mB,EAAQ8J,wBAAwBxE,EAAMpsB,EAAGA,EAAIL,EAAQ63B,MAElD1Q,EAAQ6Q,mBAAmBvL,EAAMjnB,EAAU,EAAG2U,IAKzDib,oBAAqB,WACjBpJ,IAAS,SAAUS,GACf,OAAOtF,EAAQ2Q,iCAAiCrL,GAAMvZ,WAQ9Dme,mBAAoB,SAAU4G,QACJ,IAAlBA,IAA4BA,GAAgB,GAChD,Ib7aajL,EAAKG,Ea6ad+K,EAAc7G,EAAmBS,EAAUhvB,GAG/C,OAFKm1B,Ib9aa9K,Ea+amBgF,Eb9ajDvE,IADyBZ,Ea+aWkL,Gb9aXzgB,EAAG0V,EAAYI,IACxCK,GAAqBZ,EAAItV,EAAGyV,EAAYK,Ka8arB0K,GAMXJ,+BAAgC,WAK5B,OAJA7F,IAA6BA,EAA2B,CACpDxa,EAAG2H,GAAY,GACf1H,EAAG0H,GAAY,KAEZ6S,GAMXhB,wBAAyB,SAAUxE,EAAMtsB,EAAKC,EAAKy3B,GAE/C,IAAI3sB,OADe,IAAf2sB,IAAyBA,GAAa,GAEtCA,GACK9E,EAAWgF,iBACZhF,EAAWgF,ef9gBxB,CAAEtgB,EAAG,CAAEtX,IAAK,EAAGC,IAAK,GAAKsX,EAAG,CAAEvX,IAAK,EAAGC,IAAK,KeghBlC8K,EAAS6nB,EAAWgF,eAAetL,KAGnCsG,EAAWgF,oBAAiB70B,EAC5BgI,EAAS6nB,EAAW7nB,OAAOuhB,IAE/BsG,EAAW9D,YAAa,EACxB/jB,EAAO/K,IAAMA,EACb+K,EAAO9K,IAAMA,EAEbkzB,GAAwB,EACxBjB,EAAW8F,uBAQfjH,uBAAwB,SAAUkH,EAAOpL,QACzB,IAARA,IAAkBA,EAAMqG,EAAYnE,QACxC,IAAIzuB,EAAK0mB,EAAQ2Q,iCAAkCrgB,EAAIhX,EAAGgX,EAAGC,EAAIjX,EAAGiX,EAChE2gB,GAAgBtF,EAAWgF,iBAC1BhF,EAAWE,iBACXxb,EAAEyH,gBACFxH,EAAEwH,eACHkZ,GAASC,IACTrM,IAAS,SAAUS,GACf,IAAIhsB,EAAKusB,EAAIP,GAAOtsB,EAAMM,EAAGN,IAAKC,EAAMK,EAAGL,IAC3C+mB,EAAQ8J,wBAAwBxE,EAAMtsB,EAAKC,OASvDk4B,kBAAmB,SAAU5jB,GACzBmc,GAAsB1J,GACtBA,EAAQoR,mBAAmBlF,EAAYnE,OAAQ/H,EAAQqR,iBAAmBnF,EAAYnE,OAAQxa,IAKlG8c,eAAgB,WAAc,OAAOA,EAAerK,EAAS2K,EAAUjO,IAAW4N,iBAAkB,WAAc,OAAOA,EAAiBK,EAAUM,IAAiB+C,uBAtdzK,WACI,GAAKhO,EAAQwM,oBAAb,CAEA,IAAIlyB,EAAQ4xB,EAAY5xB,MAAO2tB,EAAYiE,EAAYjE,UACnDqJ,EAAiBrJ,EAAU3X,EAC3BihB,EAAiBtJ,EAAU1X,EAC3BihB,EAAqBtF,EAAY/D,eACrCO,GAAmBwD,EAAaF,EAAgBhM,EAAQuN,KAAMvC,GAC9DmB,GACInM,EAAQyR,wBAAwBzF,EAAejoB,OAAQzJ,GAC3D6xB,GAAwB,EACxB,IAAIhE,EAAiBE,GAA+B/tB,EAAO2tB,GACvDE,IAAmBqJ,GAEnBF,IAAmBrJ,EAAU3X,GAC7BihB,IAAmBtJ,EAAU1X,GAC7ByP,EAAQ4O,iBAEZ1C,EAAY/D,eAAiBA,IAqc7B2E,2BAA4B,WACxB9M,EAAQ+M,WAAWzhB,QAAQomB,IAO3B1mB,GAAK+iB,UAAUjB,GAA4B,GAAO,IAGtDlD,oBAAqB,WACjB,QAAyB7tB,IAArB4tB,EAAgC,CAGhC,IAFA,IAAIgI,GAAc,EAET74B,EAAIknB,EAAQuN,KAAK10B,OAAS,EAAGC,GAAK,EAAGA,IAAK,CAC/C,IAAI84B,EAAW5R,EAAQuN,KAAKz0B,GAC5B,GAAI84B,EAAShG,WAAWC,UAAW,CAC/B8F,EAAcC,EACd,OAGRjI,EAAmBgI,EAEvB,OAAOhI,GAEXkI,yBAA0B,WACtB,IAAIC,EAAiB9R,EAAQ4J,sBAC7B,GAAKgC,EAAWgF,gBAAmBkB,ITlkBnD,SAAyBlG,EAAYmG,GACjCpK,GAAiBiE,EAAW7nB,OAAOuM,EAAGsb,EAAWgF,eAAetgB,EAAGyhB,EAAiBhuB,OAAOuM,GAC3FqX,GAAiBiE,EAAW7nB,OAAOwM,EAAGqb,EAAWgF,eAAergB,EAAGwhB,EAAiBhuB,OAAOwM,GSkkB/EyhB,CAAgBpG,EAAYkG,EAAelG,YACvCzG,GAAY2M,IAAiB,CAC7B,IAAI/tB,EAAS6nB,EAAW7nB,OACxBuiB,GAAmBviB,EAAQA,EAAQ+tB,EAAe7I,qBAG1DgJ,qBAAsB,WAClB,OAAOtzB,QAAQ+d,EAAMwV,wBAKzBtE,QAAS,SAAUuE,GACfnG,EAAiBmG,EAAQvG,WACzBK,EAAmBkG,EAAQlJ,kBAIU,OAArC2B,QAAkF,IAArCA,GAAuDA,IACpGA,EAAmCpnB,EAAK2uB,EAAQC,gBAAgBpS,EAAQqO,gCAAiC8D,EAAQE,2BAA0B,WACvI,IAAI/4B,EACA0mB,EAAQX,UACRW,EAAQsS,SAAWhP,GAASiP,QAGU,QAArCj5B,EAAK0mB,EAAQwS,0BAAuC,IAAPl5B,GAAyBA,EAAG6F,KAAK6gB,QAK3FX,WAAW,EAAMiT,SAAUhP,GAASmP,WACxC,OAAOzS,IAGf,SAAS0R,GAA6BpX,GAClCA,EAAMuX,2BAEV,SAAS7E,GAA2B1S,GAChCA,EAAM0T,yBAEV,IAAImC,GAAejsB,YAAc,CAAC,WAAY8L,YAAOqL,KACjD4U,GAAkBE,GAAat3B,OEvqBnC,SAAS65B,GAAe1S,EAAS2S,GAE7B,OjBLJ,SAAqCr5B,GACjC,IAAIs5B,EAAMt5B,EAAGs5B,IACb,MAAO,CACHtiB,EAAG,CAAEtX,IAFgBM,EAAGu5B,KAER55B,IAFsBK,EAAGw5B,OAGzCviB,EAAG,CAAEvX,IAAK45B,EAAK35B,IAH0CK,EAAGy5B,SiBIzDC,CjBgBX,SAA8B15B,EAAI25B,GAC9B,IAAIL,EAAMt5B,EAAGs5B,IAAKC,EAAOv5B,EAAGu5B,KAAME,EAASz5B,EAAGy5B,OAAQD,EAAQx5B,EAAGw5B,WAC1C,IAAnBG,IAA6BA,EAAiBnO,IAClD,IAAIoO,EAAUD,EAAe,CAAE3iB,EAAGuiB,EAAMtiB,EAAGqiB,IACvCO,EAAcF,EAAe,CAAE3iB,EAAGwiB,EAAOviB,EAAGwiB,IAChD,MAAO,CACHH,IAAKM,EAAQ3iB,EACbsiB,KAAMK,EAAQ5iB,EACdyiB,OAAQI,EAAY5iB,EACpBuiB,MAAOK,EAAY7iB,GiBzBY8iB,CADzBpT,EAAQqT,wBAC2CV,I,sBCVjE,SAASW,GAAc92B,GACnB,MAAwB,kBAAVA,GAAsBA,EAAMuC,WAAW,UAWzD,IAAIw0B,GAAmB,uDASvB,SAASC,GAAiB11B,EAASkiB,EAASoJ,QAC1B,IAAVA,IAAoBA,EAAQ,GAChCxnB,YAAUwnB,GAHC,EAGkB,yDAA4DtrB,EAAU,wDACnG,IAAIxE,EAAK0W,YAXb,SAA0BlS,GACtB,IAAI0B,EAAQ+zB,GAAiBE,KAAK31B,GAClC,IAAK0B,EACD,MAAO,CAAC,GACZ,IAAIlG,EAAK0W,YAAOxQ,EAAO,GACvB,MAAO,CAD4BlG,EAAG,GAAeA,EAAG,IAOxCo6B,CAAiB51B,GAAU,GAAI61B,EAAQr6B,EAAG,GAAIs6B,EAAWt6B,EAAG,GAE5E,GAAKq6B,EAAL,CAGA,IAAIza,EAAWlQ,OAAO6qB,iBAAiB7T,GAAS8T,iBAAiBH,GACjE,OAAIza,EACOA,EAAS6a,OAEXT,GAAcM,GAEZJ,GAAiBI,EAAU5T,EAASoJ,EAAQ,GAG5CwK,G,ICXXI,G,SAvBAC,GAAiB,IAAIzmB,IAAI,CACzB,QACA,SACA,MACA,OACA,QACA,SACA,IACA,MAEA0mB,GAAkB,SAAUp4B,GAAO,OAAOm4B,GAAenpB,IAAIhP,IAI7Dq4B,GAAsB,SAAU33B,EAAON,GAGvCM,EAAM8X,IAAIpY,GAAI,GACdM,EAAM8X,IAAIpY,IAEVk4B,GAAgB,SAAUl7B,GAC1B,OAAOA,IAAM4G,KAAU5G,IAAMmf,MAGjC,SAAW2b,GACPA,EAAoB,MAAY,QAChCA,EAAoB,OAAa,SACjCA,EAAoB,KAAW,OAC/BA,EAAoB,MAAY,QAChCA,EAAoB,IAAU,MAC9BA,EAAoB,OAAa,SANrC,CAOGA,KAAyBA,GAAuB,KACnD,IAAIK,GAAmB,SAAUC,EAAQC,GACrC,OAAO50B,WAAW20B,EAAOhjB,MAAM,MAAMijB,KAErCC,GAAyB,SAAUC,EAAMC,GAAQ,OAAO,SAAUC,EAAOr7B,GACzE,IAAIyG,EAAYzG,EAAGyG,UACnB,GAAkB,SAAdA,IAAyBA,EACzB,OAAO,EACX,IAAI60B,EAAW70B,EAAUP,MAAM,sBAC/B,GAAIo1B,EACA,OAAOP,GAAiBO,EAAS,GAAIF,GAGrC,IAAIJ,EAASv0B,EAAUP,MAAM,oBAC7B,OAAI80B,EACOD,GAAiBC,EAAO,GAAIG,GAG5B,IAIfI,GAAgB,IAAIrnB,IAAI,CAAC,IAAK,IAAK,MACnCsnB,GAAgCC,KAAepjB,QAAO,SAAU7V,GAAO,OAAQ+4B,GAAc/pB,IAAIhP,MAerG,IAAIk5B,GAAmB,CAEnBC,MAAO,SAAU37B,GACb,IAAIgX,EAAIhX,EAAGgX,EACX,OAAOA,EAAErX,IAAMqX,EAAEtX,KAErBk8B,OAAQ,SAAU57B,GACd,IAAIiX,EAAIjX,EAAGiX,EACX,OAAOA,EAAEtX,IAAMsX,EAAEvX,KAErB45B,IAAK,SAAU+B,EAAOr7B,GAClB,IAAIs5B,EAAMt5B,EAAGs5B,IACb,OAAOjzB,WAAWizB,IAEtBC,KAAM,SAAU8B,EAAOr7B,GACnB,IAAIu5B,EAAOv5B,EAAGu5B,KACd,OAAOlzB,WAAWkzB,IAEtBE,OAAQ,SAAUz5B,EAAIG,GAClB,IAAI8W,EAAIjX,EAAGiX,EACPqiB,EAAMn5B,EAAGm5B,IACb,OAAOjzB,WAAWizB,IAAQriB,EAAEtX,IAAMsX,EAAEvX,MAExC85B,MAAO,SAAUx5B,EAAIG,GACjB,IAAI6W,EAAIhX,EAAGgX,EACPuiB,EAAOp5B,EAAGo5B,KACd,OAAOlzB,WAAWkzB,IAASviB,EAAErX,IAAMqX,EAAEtX,MAGzCsX,EAAGkkB,GAAuB,EAAG,IAC7BjkB,EAAGikB,GAAuB,EAAG,KAyB7BW,GAAmC,SAAUtc,EAAe9U,EAAQD,EAAQuV,QAC7D,IAAXvV,IAAqBA,EAAS,SACZ,IAAlBuV,IAA4BA,EAAgB,IAChDtV,EAASrH,YAAS,GAAIqH,GACtBsV,EAAgB3c,YAAS,GAAI2c,GAC7B,IAAI+b,EAAuBp2B,OAAOpD,KAAKmI,GAAQ4N,OAAOuiB,IAGlDmB,EAAyB,GACzBC,GAAsC,EACtCC,EAAuB,GAwE3B,GAvEAH,EAAqB9pB,SAAQ,SAAUxP,GACnC,IAAIU,EAAQqc,EAAcE,SAASjd,GACnC,GAAK+c,EAAcC,SAAShd,GAA5B,CAEA,IAGI05B,EAHAv5B,EAAO6H,EAAOhI,GACdI,EAAK6H,EAAOjI,GACZ25B,EAAWhd,GAAuBxc,GAMtC,GAAI0X,YAAkBzX,GAElB,IADA,IAAIw5B,EAAex5B,EAAGrD,OACbC,EAAc,OAAVoD,EAAG,GAAc,EAAI,EAAGpD,EAAI48B,EAAc58B,IAC9C08B,EAMD5zB,YAAU6W,GAAuBvc,EAAGpD,MAAQ08B,EAAQ,2CALpDA,EAAS/c,GAAuBvc,EAAGpD,IACnC8I,YAAU4zB,IAAWC,GAChBrB,GAAcqB,IAAarB,GAAcoB,GAAU,sEAQhEA,EAAS/c,GAAuBvc,GAEpC,GAAIu5B,IAAaD,EAGb,GAAIpB,GAAcqB,IAAarB,GAAcoB,GAAS,CAClD,IAAI13B,EAAUtB,EAAMwX,MACG,kBAAZlW,GACPtB,EAAM8X,IAAI3U,WAAW7B,IAEP,kBAAP5B,EACP6H,EAAOjI,GAAO6D,WAAWzD,GAEpBxD,MAAMC,QAAQuD,IAAOs5B,IAAWnd,MACrCtU,EAAOjI,GAAOI,EAAGyG,IAAIhD,kBAGN,OAAb81B,QAAkC,IAAbA,OAAsB,EAASA,EAAS11B,aACvD,OAAXy1B,QAA8B,IAAXA,OAAoB,EAASA,EAAOz1B,aAC9C,IAAT9D,GAAqB,IAAPC,GAGF,IAATD,EACAO,EAAM8X,IAAIkhB,EAAOz1B,UAAU9D,IAG3B8H,EAAOjI,GAAO25B,EAAS11B,UAAU7D,IAMhCo5B,IACDD,EA3IpB,SAAyCxc,GACrC,IAAI8c,EAAoB,GAWxB,OAVAb,GAA8BxpB,SAAQ,SAAUxP,GAC5C,IAAIU,EAAQqc,EAAcE,SAASjd,QACrBC,IAAVS,IACAm5B,EAAkBlzB,KAAK,CAAC3G,EAAKU,EAAMwX,QACnCxX,EAAM8X,IAAIxY,EAAIiD,WAAW,SAAW,EAAI,OAI5C42B,EAAkB98B,QAClBggB,EAAcyW,aACXqG,EA+HkCC,CAAgC/c,GACzDyc,GAAsC,GAE1CC,EAAqB9yB,KAAK3G,GAC1Bud,EAAcvd,QACaC,IAAvBsd,EAAcvd,GACRud,EAAcvd,GACdiI,EAAOjI,GACjBq4B,GAAoB33B,EAAON,QAInCq5B,EAAqB18B,OAAQ,CAC7B,IAAIg9B,EA1GmB,SAAU9xB,EAAQ8U,EAAeid,GAC5D,IAAIC,EAAald,EAAcqR,qBAC3BlK,EAAUnH,EAAcwL,cACxB2R,EAAuBnC,iBAAiB7T,GACxCiW,EAAUD,EAAqBC,QAC/BC,EAAsB,CAAEtD,IADsBoD,EAAqBpD,IACjCC,KAD6CmD,EAAqBnD,KACtDE,OADqEiD,EAAqBjD,OAC1ED,MAD0FkD,EAAqBlD,MACjG/yB,UADoHi2B,EAAqBj2B,WAIzM,SAAZk2B,GACApd,EAAc4V,eAAe,UAAW1qB,EAAOkyB,SAAW,SAG9Dpd,EAAcyW,aACd,IAAI6G,EAAatd,EAAcqR,qBAQ/B,OAPA4L,EAAYxqB,SAAQ,SAAUxP,GAG1B,IAAIU,EAAQqc,EAAcE,SAASjd,GACnCq4B,GAAoB33B,EAAOw4B,GAAiBl5B,GAAKi6B,EAAYG,IAC7DnyB,EAAOjI,GAAOk5B,GAAiBl5B,GAAKq6B,EAAYH,MAE7CjyB,EAqFmBqyB,CAAyBryB,EAAQ8U,EAAe0c,GAUtE,OARIF,EAAuBx8B,QACvBw8B,EAAuB/pB,SAAQ,SAAUhS,GACrC,IAAIG,EAAKuW,YAAO1W,EAAI,GAAIwC,EAAMrC,EAAG,GAAI+C,EAAQ/C,EAAG,GAChDof,EAAcE,SAASjd,GAAKwY,IAAI9X,MAIxCqc,EAAcyW,aACP,CAAEvrB,OAAQ8xB,EAAiBxc,cAAeA,GAGjD,MAAO,CAAEtV,OAAQA,EAAQsV,cAAeA,IAUhD,SAASgd,GAAexd,EAAe9U,EAAQD,EAAQuV,GACnD,OA5NmB,SAAUtV,GAC7B,OAAO/E,OAAOpD,KAAKmI,GAAQlI,KAAKq4B,IA2NzBoC,CAAiBvyB,GAClBoxB,GAAiCtc,EAAe9U,EAAQD,EAAQuV,GAChE,CAAEtV,OAAQA,EAAQsV,cAAeA,GCzO3C,IAAIkd,GAAkB,SAAU1d,EAAe9U,EAAQD,EAAQuV,GAC3D,IAAIH,EFyCR,SAA6BL,EAAevf,EAAI+f,GAC5C,IAAI5f,EACAsK,EAAS1H,YAAO/C,EAAI,IACpB0mB,EAAUnH,EAAcwL,cAC5B,KAAMrE,aAAmBwW,aACrB,MAAO,CAAEzyB,OAAQA,EAAQsV,cAAeA,GAiB5C,IAAK,IAAIvd,KAdLud,IACAA,EAAgB3c,YAAS,GAAI2c,IAGjCR,EAAcsW,cAAa,SAAU3yB,GACjC,IAAIsB,EAAUtB,EAAMwX,MACpB,GAAKsf,GAAcx1B,GAAnB,CAEA,IAAIob,EAAWsa,GAAiB11B,EAASkiB,GACrC9G,GACA1c,EAAM8X,IAAI4E,OAIFnV,EAAQ,CACpB,IAAIjG,EAAUiG,EAAOjI,GACrB,GAAKw3B,GAAcx1B,GAAnB,CAEA,IAAIob,EAAWsa,GAAiB11B,EAASkiB,GACpC9G,IAGLnV,EAAOjI,GAAOod,EAIVG,IAC8B,QAA7B5f,EAAK4f,EAAcvd,UAAyB,IAAPrC,IAAsB4f,EAAcvd,GAAOgC,MAEzF,MAAO,CAAEiG,OAAQA,EAAQsV,cAAeA,GE9EzBod,CAAoB5d,EAAe9U,EAAQsV,GAG1D,OAAOgd,GAAexd,EAFtB9U,EAASmV,EAASnV,OAE2BD,EAD7CuV,EAAgBH,EAASG,gB,kBCM7B,IAAIqd,GAAa,CACb1M,SAAU,MACVI,sBAAuB,SAAUuM,EAAY76B,GACzC,GAAI86B,aAAgB96B,GAAM,CACtB,IAAI+6B,EAAcpkB,GAAoB3W,GACtC,OAAO+6B,GAAcA,EAAY3lB,SAAe,EAGhD,IAXc8O,EAWV8W,GAXU9W,EAWuB2W,EAVtC3tB,OAAO6qB,iBAAiB7T,IAWvB,OAASsT,aAAcx3B,GACjBg7B,EAAchD,iBAAiBh4B,GAC/Bg7B,EAAch7B,KAAS,GAGrCmf,iBAAkB,SAAU1gB,EAAGC,GAM3B,OAAsC,EAA/BD,EAAEw8B,wBAAwBv8B,GAAS,GAAK,GAEnDgkB,cAAe,SAAU9B,EAAO5gB,GAC5B,IAAIxC,EACJ,OAA8B,QAAtBA,EAAKojB,EAAMsa,aAA0B,IAAP19B,OAAgB,EAASA,EAAGwC,IAEtEouB,mBAAoB,SAAUlK,EAAS1mB,GAEnC,OAAOo5B,GAAe1S,EADG1mB,EAAGq5B,qBAUhCtI,eAAgB,SAAUrK,EAAS2W,EAAYja,GAC3C,IAAIua,EAAoBva,EAAMua,kBAC9BN,EAAWK,MAAMj3B,UAAYk3B,EACvBA,EAAkB,GAAI,IACtB,OAENjX,EAAQ4O,kBAEZtE,iBAAkB,SAAUK,EAAUuM,GAClCvM,EAASqM,MAAMj3B,UAAYm3B,EAAaF,MAAMj3B,WAElDwqB,2BAA4B,SAAUzuB,EAAKxC,GACvC,IAAI69B,EAAO79B,EAAG69B,KAAMH,EAAQ19B,EAAG09B,aACxBG,EAAKr7B,UACLk7B,EAAMl7B,IAMjBsd,qBAAsB,SAAU4G,EAAS1mB,EAAIG,EAAIg0B,GAC7C,IAAI2J,EAAkB39B,EAAG29B,qBACP,IAAd3J,IAAwBA,GAAY,GACxC,IAAIza,EAAa1Z,EAAG0Z,WAAYqG,EAAgB/f,EAAG+f,cAAetV,EAAS1H,YAAO/C,EAAI,CAAC,aAAc,kBACjGwK,EzC2BZ,SAAmBC,EAAQiP,EAAY6F,GACnC,IAAIvf,EAAIG,EACJqK,EAAS,GACb,IAAK,IAAIhI,KAAOiI,EACZD,EAAOhI,GACiD,QAAnDxC,EAAKigB,GAAwBzd,EAAKkX,UAAgC,IAAP1Z,EAAgBA,EAA4C,QAAtCG,EAAKof,EAAcE,SAASjd,UAAyB,IAAPrC,OAAgB,EAASA,EAAGua,MAEpK,OAAOlQ,EyClCUuzB,CAAUtzB,EAAQiP,GAAc,GAAIgN,GAYjD,GARIoX,IACI/d,IACAA,EAAgB+d,EAAgB/d,IAChCtV,IACAA,EAASqzB,EAAgBrzB,IACzBD,IACAA,EAASszB,EAAgBtzB,KAE7B2pB,EAAW,EzCnCvB,SAAiC5U,EAAe9U,EAAQD,GACpD,IAAIxK,EAAIG,EAAIE,EACRE,EACAy9B,EAAet4B,OAAOpD,KAAKmI,GAAQ4N,QAAO,SAAU7V,GAAO,OAAQ+c,EAAcC,SAAShd,MAC1Fy7B,EAAeD,EAAaz+B,OAChC,GAAK0+B,EAEL,IAAK,IAAIz+B,EAAI,EAAGA,EAAIy+B,EAAcz+B,IAAK,CACnC,IAAIgD,EAAMw7B,EAAax+B,GACnB0+B,EAAczzB,EAAOjI,GACrBU,EAAQ,KAKR9D,MAAMC,QAAQ6+B,KACdh7B,EAAQg7B,EAAY,IAOV,OAAVh7B,IACAA,EAAoG,QAA3F/C,EAA4B,QAAtBH,EAAKwK,EAAOhI,UAAyB,IAAPxC,EAAgBA,EAAKuf,EAAcuW,UAAUtzB,UAAyB,IAAPrC,EAAgBA,EAAKsK,EAAOjI,SAM9HC,IAAVS,GAAiC,OAAVA,IAEN,kBAAVA,GTnF2B,iBAAiBsC,KSmFJtC,GAE/CA,EAAQmD,WAAWnD,IAEbmc,GAAcnc,IAAU0G,EAAQpE,KAAK04B,KAC3Ch7B,EAAQ2G,GAAkBrH,EAAK07B,IAEnC3e,EAAcG,SAASld,EAAKmc,GAAYzb,IACV,QAA7B7C,GAAME,EAAKiK,GAAQhI,UAAyB,IAAPnC,IAAsBE,EAAGiC,GAAOU,GACtEqc,EAAcwW,cAAcvzB,EAAKU,KyCL7Bi7B,CAAwBzX,EAASjc,EAAQD,GACzC,IAAIV,EAASmzB,GAAgBvW,EAASjc,EAAQD,EAAQuV,GACtDA,EAAgBjW,EAAOiW,cACvBtV,EAASX,EAAOW,OAEpB,OAAOrH,YAAS,CAAEsW,WAAYA,EAC1BqG,cAAeA,GAAiBtV,IAExCymB,4BAA6BA,KAC7BP,MAAO,SAAUjK,EAASiL,EAAaD,EAAcY,EAAYM,EAAavwB,EAAS+gB,QACzD3gB,IAAtBikB,EAAQwN,YACRvC,EAAY+L,MAAMrI,WAAa3O,EAAQwN,UACjC,UACA,UAEV,IAAIkK,EAAuB9L,EAAWC,WAAaK,EAAYpE,WAC/D6P,aAAgB1M,EAAaD,EAAcY,EAAYM,EAAavwB,EAAS+gB,EAAMua,kBAAmBS,EAAuBrP,QAAiCtsB,EAAW27B,EACnKlP,QACAzsB,IAEV+a,OAAQ8gB,MAERC,GAAoBhf,GAAc6d,I,6CCpGlCoB,GAAmBjf,GAAcnc,YAASA,YAAS,GAAIg6B,IAAa,CAAElY,cAAe,SAAU9B,EAAO5gB,GAClG,OAAO4gB,EAAM5gB,IAEjBsuB,sBAAuB,SAAUuM,EAAY76B,GACzC,IAAIxC,EACJ,OAAIs9B,aAAgB96B,IAC4B,QAAnCxC,EAAKmZ,GAAoB3W,UAAyB,IAAPxC,OAAgB,EAASA,EAAG4X,UAAY,GAEhGpV,EAAOi8B,KAAoBjtB,IAAIhP,GAA0BA,EAAnBk8B,aAAYl8B,GAC3C66B,EAAWsB,aAAan8B,KAEnC0uB,4BAA6BA,KAC7BP,MAAO,SAAUiO,EAAUjN,EAAaD,EAAcY,EAAYM,EAAavwB,EAAS+gB,GACpF,IAAIgb,EAAuB9L,EAAWC,WAAaK,EAAYpE,WAC/DqQ,aAAclN,EAAaD,EAAcY,EAAYM,EAAavwB,EAAS+gB,EAAMua,kBAAmBS,EAAuBrP,QAAiCtsB,EAAW27B,EACjKlP,QACAzsB,IACP+a,OAAQshB,Q,SCrBXC,GAAe37B,YAASA,YAAS,CAAE47B,SCJV,SAAUC,EAAW58B,GAC9C,OAAO68B,aAAeD,GAChBT,GAAiBn8B,EAAS,CAAE88B,4BAA4B,IACxDZ,GAAkBl8B,EAAS,CAAE88B,4BAA4B,MDCQxe,IAAauJ","file":"static/js/4.531df6cf.chunk.js","sourcesContent":["function shallowCompare(next, prev) {\n    if (!Array.isArray(prev))\n        return false;\n    var prevLength = prev.length;\n    if (prevLength !== next.length)\n        return false;\n    for (var i = 0; i < prevLength; i++) {\n        if (prev[i] !== next[i])\n            return false;\n    }\n    return true;\n}\n\nexport { shallowCompare };\n","var clamp = function (min, max, v) {\n    return Math.min(Math.max(v, min), max);\n};\n\nexport { clamp };\n","import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.js';\n\nvar safeMin = 0.001;\nvar minDuration = 0.01;\nvar maxDuration = 10.0;\nvar minDamping = 0.05;\nvar maxDamping = 1;\nfunction findSpring(_a) {\n    var _b = _a.duration, duration = _b === void 0 ? 800 : _b, _c = _a.bounce, bounce = _c === void 0 ? 0.25 : _c, _d = _a.velocity, velocity = _d === void 0 ? 0 : _d, _e = _a.mass, mass = _e === void 0 ? 1 : _e;\n    var envelope;\n    var derivative;\n    warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n    var dampingRatio = 1 - bounce;\n    dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n    duration = clamp(minDuration, maxDuration, duration / 1000);\n    if (dampingRatio < 1) {\n        envelope = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var a = exponentialDecay - velocity;\n            var b = calcAngularFreq(undampedFreq, dampingRatio);\n            var c = Math.exp(-delta);\n            return safeMin - (a / b) * c;\n        };\n        derivative = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var d = delta * velocity + velocity;\n            var e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n            var f = Math.exp(-delta);\n            var g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n            var factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n            return (factor * ((d - e) * f)) / g;\n        };\n    }\n    else {\n        envelope = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (undampedFreq - velocity) * duration + 1;\n            return -safeMin + a * b;\n        };\n        derivative = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (velocity - undampedFreq) * (duration * duration);\n            return a * b;\n        };\n    }\n    var initialGuess = 5 / duration;\n    var undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n    duration = duration * 1000;\n    if (isNaN(undampedFreq)) {\n        return {\n            stiffness: 100,\n            damping: 10,\n            duration: duration,\n        };\n    }\n    else {\n        var stiffness = Math.pow(undampedFreq, 2) * mass;\n        return {\n            stiffness: stiffness,\n            damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n            duration: duration,\n        };\n    }\n}\nvar rootIterations = 12;\nfunction approximateRoot(envelope, derivative, initialGuess) {\n    var result = initialGuess;\n    for (var i = 1; i < rootIterations; i++) {\n        result = result - envelope(result) / derivative(result);\n    }\n    return result;\n}\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n    return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };\n","import { __rest, __assign } from 'tslib';\nimport { findSpring, calcAngularFreq } from '../utils/find-spring.js';\n\nvar durationKeys = [\"duration\", \"bounce\"];\nvar physicsKeys = [\"stiffness\", \"damping\", \"mass\"];\nfunction isSpringType(options, keys) {\n    return keys.some(function (key) { return options[key] !== undefined; });\n}\nfunction getSpringOptions(options) {\n    var springOptions = __assign({ velocity: 0.0, stiffness: 100, damping: 10, mass: 1.0, isResolvedFromDuration: false }, options);\n    if (!isSpringType(options, physicsKeys) &&\n        isSpringType(options, durationKeys)) {\n        var derived = findSpring(options);\n        springOptions = __assign(__assign(__assign({}, springOptions), derived), { velocity: 0.0, mass: 1.0 });\n        springOptions.isResolvedFromDuration = true;\n    }\n    return springOptions;\n}\nfunction spring(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0.0 : _b, _c = _a.to, to = _c === void 0 ? 1.0 : _c, _d = _a.restSpeed, restSpeed = _d === void 0 ? 2 : _d, restDelta = _a.restDelta, options = __rest(_a, [\"from\", \"to\", \"restSpeed\", \"restDelta\"]);\n    var state = { done: false, value: from };\n    var _e = getSpringOptions(options), stiffness = _e.stiffness, damping = _e.damping, mass = _e.mass, velocity = _e.velocity, duration = _e.duration, isResolvedFromDuration = _e.isResolvedFromDuration;\n    var resolveSpring = zero;\n    var resolveVelocity = zero;\n    function createSpring() {\n        var initialVelocity = velocity ? -(velocity / 1000) : 0.0;\n        var initialDelta = to - from;\n        var dampingRatio = damping / (2 * Math.sqrt(stiffness * mass));\n        var undampedAngularFreq = Math.sqrt(stiffness / mass) / 1000;\n        restDelta !== null && restDelta !== void 0 ? restDelta : (restDelta = Math.abs(to - from) <= 1 ? 0.01 : 0.4);\n        if (dampingRatio < 1) {\n            var angularFreq_1 = calcAngularFreq(undampedAngularFreq, dampingRatio);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (to -\n                    envelope *\n                        (((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) /\n                            angularFreq_1) *\n                            Math.sin(angularFreq_1 * t) +\n                            initialDelta * Math.cos(angularFreq_1 * t)));\n            };\n            resolveVelocity = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (dampingRatio *\n                    undampedAngularFreq *\n                    envelope *\n                    ((Math.sin(angularFreq_1 * t) *\n                        (initialVelocity +\n                            dampingRatio *\n                                undampedAngularFreq *\n                                initialDelta)) /\n                        angularFreq_1 +\n                        initialDelta * Math.cos(angularFreq_1 * t)) -\n                    envelope *\n                        (Math.cos(angularFreq_1 * t) *\n                            (initialVelocity +\n                                dampingRatio *\n                                    undampedAngularFreq *\n                                    initialDelta) -\n                            angularFreq_1 *\n                                initialDelta *\n                                Math.sin(angularFreq_1 * t)));\n            };\n        }\n        else if (dampingRatio === 1) {\n            resolveSpring = function (t) {\n                return to -\n                    Math.exp(-undampedAngularFreq * t) *\n                        (initialDelta +\n                            (initialVelocity + undampedAngularFreq * initialDelta) *\n                                t);\n            };\n        }\n        else {\n            var dampedAngularFreq_1 = undampedAngularFreq * Math.sqrt(dampingRatio * dampingRatio - 1);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                var freqForT = Math.min(dampedAngularFreq_1 * t, 300);\n                return (to -\n                    (envelope *\n                        ((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) *\n                            Math.sinh(freqForT) +\n                            dampedAngularFreq_1 *\n                                initialDelta *\n                                Math.cosh(freqForT))) /\n                        dampedAngularFreq_1);\n            };\n        }\n    }\n    createSpring();\n    return {\n        next: function (t) {\n            var current = resolveSpring(t);\n            if (!isResolvedFromDuration) {\n                var currentVelocity = resolveVelocity(t) * 1000;\n                var isBelowVelocityThreshold = Math.abs(currentVelocity) <= restSpeed;\n                var isBelowDisplacementThreshold = Math.abs(to - current) <= restDelta;\n                state.done =\n                    isBelowVelocityThreshold && isBelowDisplacementThreshold;\n            }\n            else {\n                state.done = t >= duration;\n            }\n            state.value = state.done ? to : current;\n            return state;\n        },\n        flipTarget: function () {\n            var _a;\n            velocity = -velocity;\n            _a = [to, from], from = _a[0], to = _a[1];\n            createSpring();\n        },\n    };\n}\nspring.needsInterpolation = function (a, b) {\n    return typeof a === \"string\" || typeof b === \"string\";\n};\nvar zero = function (_t) { return 0; };\n\nexport { spring };\n","var progress = function (from, to, value) {\n    var toFromDifference = to - from;\n    return toFromDifference === 0 ? 1 : (value - from) / toFromDifference;\n};\n\nexport { progress };\n","var mix = function (from, to, progress) {\n    return -progress * from + progress * to + from;\n};\n\nexport { mix };\n","import { isString, singleColorRegex, floatRegex } from '../utils.js';\n\nvar isColorString = function (type, testProp) { return function (v) {\n    return Boolean((isString(v) && singleColorRegex.test(v) && v.startsWith(type)) ||\n        (testProp && Object.prototype.hasOwnProperty.call(v, testProp)));\n}; };\nvar splitColor = function (aName, bName, cName) { return function (v) {\n    var _a;\n    if (!isString(v))\n        return v;\n    var _b = v.match(floatRegex), a = _b[0], b = _b[1], c = _b[2], alpha = _b[3];\n    return _a = {},\n        _a[aName] = parseFloat(a),\n        _a[bName] = parseFloat(b),\n        _a[cName] = parseFloat(c),\n        _a.alpha = alpha !== undefined ? parseFloat(alpha) : 1,\n        _a;\n}; };\n\nexport { isColorString, splitColor };\n","import { __assign } from 'tslib';\nimport { number, alpha } from '../numbers/index.js';\nimport { sanitize, clamp } from '../utils.js';\nimport { isColorString, splitColor } from './utils.js';\n\nvar clampRgbUnit = clamp(0, 255);\nvar rgbUnit = __assign(__assign({}, number), { transform: function (v) { return Math.round(clampRgbUnit(v)); } });\nvar rgba = {\n    test: isColorString('rgb', 'red'),\n    parse: splitColor('red', 'green', 'blue'),\n    transform: function (_a) {\n        var red = _a.red, green = _a.green, blue = _a.blue, _b = _a.alpha, alpha$1 = _b === void 0 ? 1 : _b;\n        return 'rgba(' +\n            rgbUnit.transform(red) +\n            ', ' +\n            rgbUnit.transform(green) +\n            ', ' +\n            rgbUnit.transform(blue) +\n            ', ' +\n            sanitize(alpha.transform(alpha$1)) +\n            ')';\n    },\n};\n\nexport { rgbUnit, rgba };\n","import { rgba } from './rgba.js';\nimport { isColorString } from './utils.js';\n\nfunction parseHex(v) {\n    var r = '';\n    var g = '';\n    var b = '';\n    var a = '';\n    if (v.length > 5) {\n        r = v.substr(1, 2);\n        g = v.substr(3, 2);\n        b = v.substr(5, 2);\n        a = v.substr(7, 2);\n    }\n    else {\n        r = v.substr(1, 1);\n        g = v.substr(2, 1);\n        b = v.substr(3, 1);\n        a = v.substr(4, 1);\n        r += r;\n        g += g;\n        b += b;\n        a += a;\n    }\n    return {\n        red: parseInt(r, 16),\n        green: parseInt(g, 16),\n        blue: parseInt(b, 16),\n        alpha: a ? parseInt(a, 16) / 255 : 1,\n    };\n}\nvar hex = {\n    test: isColorString('#'),\n    parse: parseHex,\n    transform: rgba.transform,\n};\n\nexport { hex };\n","import { alpha } from '../numbers/index.js';\nimport { percent } from '../numbers/units.js';\nimport { sanitize } from '../utils.js';\nimport { isColorString, splitColor } from './utils.js';\n\nvar hsla = {\n    test: isColorString('hsl', 'hue'),\n    parse: splitColor('hue', 'saturation', 'lightness'),\n    transform: function (_a) {\n        var hue = _a.hue, saturation = _a.saturation, lightness = _a.lightness, _b = _a.alpha, alpha$1 = _b === void 0 ? 1 : _b;\n        return ('hsla(' +\n            Math.round(hue) +\n            ', ' +\n            percent.transform(sanitize(saturation)) +\n            ', ' +\n            percent.transform(sanitize(lightness)) +\n            ', ' +\n            sanitize(alpha.transform(alpha$1)) +\n            ')');\n    },\n};\n\nexport { hsla };\n","import { __assign } from 'tslib';\nimport { mix } from './mix.js';\nimport { hex, rgba, hsla } from 'style-value-types';\nimport { invariant } from 'hey-listen';\n\nvar mixLinearColor = function (from, to, v) {\n    var fromExpo = from * from;\n    var toExpo = to * to;\n    return Math.sqrt(Math.max(0, v * (toExpo - fromExpo) + fromExpo));\n};\nvar colorTypes = [hex, rgba, hsla];\nvar getColorType = function (v) {\n    return colorTypes.find(function (type) { return type.test(v); });\n};\nvar notAnimatable = function (color) {\n    return \"'\" + color + \"' is not an animatable color. Use the equivalent color code instead.\";\n};\nvar mixColor = function (from, to) {\n    var fromColorType = getColorType(from);\n    var toColorType = getColorType(to);\n    invariant(!!fromColorType, notAnimatable(from));\n    invariant(!!toColorType, notAnimatable(to));\n    invariant(fromColorType.transform === toColorType.transform, \"Both colors must be hex/RGBA, OR both must be HSLA.\");\n    var fromColor = fromColorType.parse(from);\n    var toColor = toColorType.parse(to);\n    var blended = __assign({}, fromColor);\n    var mixFunc = fromColorType === hsla ? mix : mixLinearColor;\n    return function (v) {\n        for (var key in blended) {\n            if (key !== \"alpha\") {\n                blended[key] = mixFunc(fromColor[key], toColor[key], v);\n            }\n        }\n        blended.alpha = mix(fromColor.alpha, toColor.alpha, v);\n        return fromColorType.transform(blended);\n    };\n};\n\nexport { mixColor, mixLinearColor };\n","import { isString } from '../utils.js';\nimport { hex } from './hex.js';\nimport { hsla } from './hsla.js';\nimport { rgba } from './rgba.js';\n\nvar color = {\n    test: function (v) { return rgba.test(v) || hex.test(v) || hsla.test(v); },\n    parse: function (v) {\n        if (rgba.test(v)) {\n            return rgba.parse(v);\n        }\n        else if (hsla.test(v)) {\n            return hsla.parse(v);\n        }\n        else {\n            return hex.parse(v);\n        }\n    },\n    transform: function (v) {\n        return isString(v)\n            ? v\n            : v.hasOwnProperty('red')\n                ? rgba.transform(v)\n                : hsla.transform(v);\n    },\n};\n\nexport { color };\n","import { color } from '../color/index.js';\nimport { number } from '../numbers/index.js';\nimport { isString, floatRegex, colorRegex, sanitize } from '../utils.js';\n\nvar colorToken = '${c}';\nvar numberToken = '${n}';\nfunction test(v) {\n    var _a, _b, _c, _d;\n    return (isNaN(v) &&\n        isString(v) &&\n        ((_b = (_a = v.match(floatRegex)) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0) + ((_d = (_c = v.match(colorRegex)) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : 0) > 0);\n}\nfunction analyse(v) {\n    var values = [];\n    var numColors = 0;\n    var colors = v.match(colorRegex);\n    if (colors) {\n        numColors = colors.length;\n        v = v.replace(colorRegex, colorToken);\n        values.push.apply(values, colors.map(color.parse));\n    }\n    var numbers = v.match(floatRegex);\n    if (numbers) {\n        v = v.replace(floatRegex, numberToken);\n        values.push.apply(values, numbers.map(number.parse));\n    }\n    return { values: values, numColors: numColors, tokenised: v };\n}\nfunction parse(v) {\n    return analyse(v).values;\n}\nfunction createTransformer(v) {\n    var _a = analyse(v), values = _a.values, numColors = _a.numColors, tokenised = _a.tokenised;\n    var numValues = values.length;\n    return function (v) {\n        var output = tokenised;\n        for (var i = 0; i < numValues; i++) {\n            output = output.replace(i < numColors ? colorToken : numberToken, i < numColors ? color.transform(v[i]) : sanitize(v[i]));\n        }\n        return output;\n    };\n}\nvar convertNumbersToZero = function (v) {\n    return typeof v === 'number' ? 0 : v;\n};\nfunction getAnimatableNone(v) {\n    var parsed = parse(v);\n    var transformer = createTransformer(v);\n    return transformer(parsed.map(convertNumbersToZero));\n}\nvar complex = { test: test, parse: parse, createTransformer: createTransformer, getAnimatableNone: getAnimatableNone };\n\nexport { complex };\n","var zeroPoint = {\n    x: 0,\n    y: 0,\n    z: 0\n};\nvar isNum = function (v) { return typeof v === 'number'; };\n\nexport { isNum, zeroPoint };\n","var combineFunctions = function (a, b) { return function (v) { return b(a(v)); }; };\nvar pipe = function () {\n    var transformers = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        transformers[_i] = arguments[_i];\n    }\n    return transformers.reduce(combineFunctions);\n};\n\nexport { pipe };\n","import { __spreadArray, __assign } from 'tslib';\nimport { complex, color } from 'style-value-types';\nimport { mix } from './mix.js';\nimport { mixColor } from './mix-color.js';\nimport { isNum } from './inc.js';\nimport { pipe } from './pipe.js';\nimport { invariant } from 'hey-listen';\n\nfunction getMixer(origin, target) {\n    if (isNum(origin)) {\n        return function (v) { return mix(origin, target, v); };\n    }\n    else if (color.test(origin)) {\n        return mixColor(origin, target);\n    }\n    else {\n        return mixComplex(origin, target);\n    }\n}\nvar mixArray = function (from, to) {\n    var output = __spreadArray([], from);\n    var numValues = output.length;\n    var blendValue = from.map(function (fromThis, i) { return getMixer(fromThis, to[i]); });\n    return function (v) {\n        for (var i = 0; i < numValues; i++) {\n            output[i] = blendValue[i](v);\n        }\n        return output;\n    };\n};\nvar mixObject = function (origin, target) {\n    var output = __assign(__assign({}, origin), target);\n    var blendValue = {};\n    for (var key in output) {\n        if (origin[key] !== undefined && target[key] !== undefined) {\n            blendValue[key] = getMixer(origin[key], target[key]);\n        }\n    }\n    return function (v) {\n        for (var key in blendValue) {\n            output[key] = blendValue[key](v);\n        }\n        return output;\n    };\n};\nfunction analyse(value) {\n    var parsed = complex.parse(value);\n    var numValues = parsed.length;\n    var numNumbers = 0;\n    var numRGB = 0;\n    var numHSL = 0;\n    for (var i = 0; i < numValues; i++) {\n        if (numNumbers || typeof parsed[i] === \"number\") {\n            numNumbers++;\n        }\n        else {\n            if (parsed[i].hue !== undefined) {\n                numHSL++;\n            }\n            else {\n                numRGB++;\n            }\n        }\n    }\n    return { parsed: parsed, numNumbers: numNumbers, numRGB: numRGB, numHSL: numHSL };\n}\nvar mixComplex = function (origin, target) {\n    var template = complex.createTransformer(target);\n    var originStats = analyse(origin);\n    var targetStats = analyse(target);\n    invariant(originStats.numHSL === targetStats.numHSL &&\n        originStats.numRGB === targetStats.numRGB &&\n        originStats.numNumbers >= targetStats.numNumbers, \"Complex values '\" + origin + \"' and '\" + target + \"' too different to mix. Ensure all colors are of the same type.\");\n    return pipe(mixArray(originStats.parsed, targetStats.parsed), template);\n};\n\nexport { mixArray, mixComplex, mixObject };\n","import { progress } from './progress.js';\nimport { mix } from './mix.js';\nimport { mixColor } from './mix-color.js';\nimport { mixComplex, mixArray, mixObject } from './mix-complex.js';\nimport { color } from 'style-value-types';\nimport { clamp } from './clamp.js';\nimport { pipe } from './pipe.js';\nimport { invariant } from 'hey-listen';\n\nvar mixNumber = function (from, to) { return function (p) { return mix(from, to, p); }; };\nfunction detectMixerFactory(v) {\n    if (typeof v === 'number') {\n        return mixNumber;\n    }\n    else if (typeof v === 'string') {\n        if (color.test(v)) {\n            return mixColor;\n        }\n        else {\n            return mixComplex;\n        }\n    }\n    else if (Array.isArray(v)) {\n        return mixArray;\n    }\n    else if (typeof v === 'object') {\n        return mixObject;\n    }\n}\nfunction createMixers(output, ease, customMixer) {\n    var mixers = [];\n    var mixerFactory = customMixer || detectMixerFactory(output[0]);\n    var numMixers = output.length - 1;\n    for (var i = 0; i < numMixers; i++) {\n        var mixer = mixerFactory(output[i], output[i + 1]);\n        if (ease) {\n            var easingFunction = Array.isArray(ease) ? ease[i] : ease;\n            mixer = pipe(easingFunction, mixer);\n        }\n        mixers.push(mixer);\n    }\n    return mixers;\n}\nfunction fastInterpolate(_a, _b) {\n    var from = _a[0], to = _a[1];\n    var mixer = _b[0];\n    return function (v) { return mixer(progress(from, to, v)); };\n}\nfunction slowInterpolate(input, mixers) {\n    var inputLength = input.length;\n    var lastInputIndex = inputLength - 1;\n    return function (v) {\n        var mixerIndex = 0;\n        var foundMixerIndex = false;\n        if (v <= input[0]) {\n            foundMixerIndex = true;\n        }\n        else if (v >= input[lastInputIndex]) {\n            mixerIndex = lastInputIndex - 1;\n            foundMixerIndex = true;\n        }\n        if (!foundMixerIndex) {\n            var i = 1;\n            for (; i < inputLength; i++) {\n                if (input[i] > v || i === lastInputIndex) {\n                    break;\n                }\n            }\n            mixerIndex = i - 1;\n        }\n        var progressInRange = progress(input[mixerIndex], input[mixerIndex + 1], v);\n        return mixers[mixerIndex](progressInRange);\n    };\n}\nfunction interpolate(input, output, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.clamp, isClamp = _c === void 0 ? true : _c, ease = _b.ease, mixer = _b.mixer;\n    var inputLength = input.length;\n    invariant(inputLength === output.length, 'Both input and output ranges must be the same length');\n    invariant(!ease || !Array.isArray(ease) || ease.length === inputLength - 1, 'Array of easing functions must be of length `input.length - 1`, as it applies to the transitions **between** the defined values.');\n    if (input[0] > input[inputLength - 1]) {\n        input = [].concat(input);\n        output = [].concat(output);\n        input.reverse();\n        output.reverse();\n    }\n    var mixers = createMixers(output, ease, mixer);\n    var interpolator = inputLength === 2\n        ? fastInterpolate(input, mixers)\n        : slowInterpolate(input, mixers);\n    return isClamp\n        ? function (v) { return interpolator(clamp(input[0], input[inputLength - 1], v)); }\n        : interpolator;\n}\n\nexport { interpolate };\n","var reverseEasing = function (easing) { return function (p) { return 1 - easing(1 - p); }; };\nvar mirrorEasing = function (easing) { return function (p) {\n    return p <= 0.5 ? easing(2 * p) / 2 : (2 - easing(2 * (1 - p))) / 2;\n}; };\nvar createExpoIn = function (power) { return function (p) { return Math.pow(p, power); }; };\nvar createBackIn = function (power) { return function (p) {\n    return p * p * ((power + 1) * p - power);\n}; };\nvar createAnticipate = function (power) {\n    var backEasing = createBackIn(power);\n    return function (p) {\n        return (p *= 2) < 1\n            ? 0.5 * backEasing(p)\n            : 0.5 * (2 - Math.pow(2, -10 * (p - 1)));\n    };\n};\n\nexport { createAnticipate, createBackIn, createExpoIn, mirrorEasing, reverseEasing };\n","import { createExpoIn, reverseEasing, mirrorEasing, createBackIn, createAnticipate } from './utils.js';\n\nvar DEFAULT_OVERSHOOT_STRENGTH = 1.525;\nvar BOUNCE_FIRST_THRESHOLD = 4.0 / 11.0;\nvar BOUNCE_SECOND_THRESHOLD = 8.0 / 11.0;\nvar BOUNCE_THIRD_THRESHOLD = 9.0 / 10.0;\nvar linear = function (p) { return p; };\nvar easeIn = createExpoIn(2);\nvar easeOut = reverseEasing(easeIn);\nvar easeInOut = mirrorEasing(easeIn);\nvar circIn = function (p) { return 1 - Math.sin(Math.acos(p)); };\nvar circOut = reverseEasing(circIn);\nvar circInOut = mirrorEasing(circOut);\nvar backIn = createBackIn(DEFAULT_OVERSHOOT_STRENGTH);\nvar backOut = reverseEasing(backIn);\nvar backInOut = mirrorEasing(backIn);\nvar anticipate = createAnticipate(DEFAULT_OVERSHOOT_STRENGTH);\nvar ca = 4356.0 / 361.0;\nvar cb = 35442.0 / 1805.0;\nvar cc = 16061.0 / 1805.0;\nvar bounceOut = function (p) {\n    if (p === 1 || p === 0)\n        return p;\n    var p2 = p * p;\n    return p < BOUNCE_FIRST_THRESHOLD\n        ? 7.5625 * p2\n        : p < BOUNCE_SECOND_THRESHOLD\n            ? 9.075 * p2 - 9.9 * p + 3.4\n            : p < BOUNCE_THIRD_THRESHOLD\n                ? ca * p2 - cb * p + cc\n                : 10.8 * p * p - 20.52 * p + 10.72;\n};\nvar bounceIn = reverseEasing(bounceOut);\nvar bounceInOut = function (p) {\n    return p < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - p * 2.0))\n        : 0.5 * bounceOut(p * 2.0 - 1.0) + 0.5;\n};\n\nexport { anticipate, backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, easeIn, easeInOut, easeOut, linear };\n","import { interpolate } from '../../utils/interpolate.js';\nimport { easeInOut } from '../../easing/index.js';\n\nfunction defaultEasing(values, easing) {\n    return values.map(function () { return easing || easeInOut; }).splice(0, values.length - 1);\n}\nfunction defaultOffset(values) {\n    var numValues = values.length;\n    return values.map(function (_value, i) {\n        return i !== 0 ? i / (numValues - 1) : 0;\n    });\n}\nfunction convertOffsetToTimes(offset, duration) {\n    return offset.map(function (o) { return o * duration; });\n}\nfunction keyframes(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0 : _b, _c = _a.to, to = _c === void 0 ? 1 : _c, ease = _a.ease, offset = _a.offset, _d = _a.duration, duration = _d === void 0 ? 300 : _d;\n    var state = { done: false, value: from };\n    var values = Array.isArray(to) ? to : [from, to];\n    var times = convertOffsetToTimes(offset && offset.length === values.length\n        ? offset\n        : defaultOffset(values), duration);\n    function createInterpolator() {\n        return interpolate(times, values, {\n            ease: Array.isArray(ease) ? ease : defaultEasing(values, ease),\n        });\n    }\n    var interpolator = createInterpolator();\n    return {\n        next: function (t) {\n            state.value = interpolator(t);\n            state.done = t >= duration;\n            return state;\n        },\n        flipTarget: function () {\n            values.reverse();\n            interpolator = createInterpolator();\n        },\n    };\n}\n\nexport { convertOffsetToTimes, defaultEasing, defaultOffset, keyframes };\n","import { spring } from '../generators/spring.js';\nimport { keyframes } from '../generators/keyframes.js';\nimport { decay } from '../generators/decay.js';\n\nvar types = { keyframes: keyframes, spring: spring, decay: decay };\nfunction detectAnimationFromOptions(config) {\n    if (Array.isArray(config.to)) {\n        return keyframes;\n    }\n    else if (types[config.type]) {\n        return types[config.type];\n    }\n    var keys = new Set(Object.keys(config));\n    if (keys.has(\"ease\") ||\n        (keys.has(\"duration\") && !keys.has(\"dampingRatio\"))) {\n        return keyframes;\n    }\n    else if (keys.has(\"dampingRatio\") ||\n        keys.has(\"stiffness\") ||\n        keys.has(\"mass\") ||\n        keys.has(\"damping\") ||\n        keys.has(\"restSpeed\") ||\n        keys.has(\"restDelta\")) {\n        return spring;\n    }\n    return keyframes;\n}\n\nexport { detectAnimationFromOptions };\n","function decay(_a) {\n    var _b = _a.velocity, velocity = _b === void 0 ? 0 : _b, _c = _a.from, from = _c === void 0 ? 0 : _c, _d = _a.power, power = _d === void 0 ? 0.8 : _d, _e = _a.timeConstant, timeConstant = _e === void 0 ? 350 : _e, _f = _a.restDelta, restDelta = _f === void 0 ? 0.5 : _f, modifyTarget = _a.modifyTarget;\n    var state = { done: false, value: from };\n    var amplitude = power * velocity;\n    var ideal = from + amplitude;\n    var target = modifyTarget === undefined ? ideal : modifyTarget(ideal);\n    if (target !== ideal)\n        amplitude = target - from;\n    return {\n        next: function (t) {\n            var delta = -amplitude * Math.exp(-t / timeConstant);\n            state.done = !(delta > restDelta || delta < -restDelta);\n            state.value = state.done ? target : target + delta;\n            return state;\n        },\n        flipTarget: function () { },\n    };\n}\n\nexport { decay };\n","var defaultTimestep = (1 / 60) * 1000;\nvar getCurrentTime = typeof performance !== \"undefined\"\n    ? function () { return performance.now(); }\n    : function () { return Date.now(); };\nvar onNextFrame = typeof window !== \"undefined\"\n    ? function (callback) {\n        return window.requestAnimationFrame(callback);\n    }\n    : function (callback) {\n        return setTimeout(function () { return callback(getCurrentTime()); }, defaultTimestep);\n    };\n\nexport { defaultTimestep, onNextFrame };\n","import { onNextFrame, defaultTimestep } from './on-next-frame.js';\nimport { createRenderStep } from './create-render-step.js';\n\nvar maxElapsed = 40;\nvar useDefaultElapsed = true;\nvar runNextFrame = false;\nvar isProcessing = false;\nvar frame = {\n    delta: 0,\n    timestamp: 0\n};\nvar stepsOrder = [\"read\", \"update\", \"preRender\", \"render\", \"postRender\"];\nvar steps = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    acc[key] = createRenderStep(function () {\n        return runNextFrame = true;\n    });\n    return acc;\n}, {});\nvar sync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    var step = steps[key];\n    acc[key] = function (process, keepAlive, immediate) {\n        if (keepAlive === void 0) {\n            keepAlive = false;\n        }\n        if (immediate === void 0) {\n            immediate = false;\n        }\n        if (!runNextFrame) startLoop();\n        return step.schedule(process, keepAlive, immediate);\n    };\n    return acc;\n}, {});\nvar cancelSync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    acc[key] = steps[key].cancel;\n    return acc;\n}, {});\nvar flushSync = /*#__PURE__*/stepsOrder.reduce(function (acc, key) {\n    acc[key] = function () {\n        return steps[key].process(frame);\n    };\n    return acc;\n}, {});\nvar processStep = function (stepId) {\n    return steps[stepId].process(frame);\n};\nvar processFrame = function (timestamp) {\n    runNextFrame = false;\n    frame.delta = useDefaultElapsed ? defaultTimestep : Math.max(Math.min(timestamp - frame.timestamp, maxElapsed), 1);\n    frame.timestamp = timestamp;\n    isProcessing = true;\n    stepsOrder.forEach(processStep);\n    isProcessing = false;\n    if (runNextFrame) {\n        useDefaultElapsed = false;\n        onNextFrame(processFrame);\n    }\n};\nvar startLoop = function () {\n    runNextFrame = true;\n    useDefaultElapsed = true;\n    if (!isProcessing) onNextFrame(processFrame);\n};\nvar getFrameData = function () {\n    return frame;\n};\n\nexport default sync;\nexport { cancelSync, flushSync, getFrameData };\n","function createRenderStep(runNextFrame) {\n    var toRun = [];\n    var toRunNextFrame = [];\n    var numToRun = 0;\n    var isProcessing = false;\n    var toKeepAlive = new WeakSet();\n    var step = {\n        schedule: function (callback, keepAlive, immediate) {\n            if (keepAlive === void 0) { keepAlive = false; }\n            if (immediate === void 0) { immediate = false; }\n            var addToCurrentFrame = immediate && isProcessing;\n            var buffer = addToCurrentFrame ? toRun : toRunNextFrame;\n            if (keepAlive)\n                toKeepAlive.add(callback);\n            if (buffer.indexOf(callback) === -1) {\n                buffer.push(callback);\n                if (addToCurrentFrame && isProcessing)\n                    numToRun = toRun.length;\n            }\n            return callback;\n        },\n        cancel: function (callback) {\n            var index = toRunNextFrame.indexOf(callback);\n            if (index !== -1)\n                toRunNextFrame.splice(index, 1);\n            toKeepAlive.delete(callback);\n        },\n        process: function (frameData) {\n            var _a;\n            isProcessing = true;\n            _a = [toRunNextFrame, toRun], toRun = _a[0], toRunNextFrame = _a[1];\n            toRunNextFrame.length = 0;\n            numToRun = toRun.length;\n            if (numToRun) {\n                for (var i = 0; i < numToRun; i++) {\n                    var callback = toRun[i];\n                    callback(frameData);\n                    if (toKeepAlive.has(callback)) {\n                        step.schedule(callback);\n                        runNextFrame();\n                    }\n                }\n            }\n            isProcessing = false;\n        },\n    };\n    return step;\n}\n\nexport { createRenderStep };\n","function loopElapsed(elapsed, duration, delay) {\n    if (delay === void 0) { delay = 0; }\n    return elapsed - duration - delay;\n}\nfunction reverseElapsed(elapsed, duration, delay, isForwardPlayback) {\n    if (delay === void 0) { delay = 0; }\n    if (isForwardPlayback === void 0) { isForwardPlayback = true; }\n    return isForwardPlayback\n        ? loopElapsed(duration + -elapsed, duration, delay)\n        : duration - (elapsed - duration) + delay;\n}\nfunction hasRepeatDelayElapsed(elapsed, duration, delay, isForwardPlayback) {\n    return isForwardPlayback ? elapsed >= duration + delay : elapsed <= -delay;\n}\n\nexport { hasRepeatDelayElapsed, loopElapsed, reverseElapsed };\n","import { __rest, __assign } from 'tslib';\nimport { detectAnimationFromOptions } from './utils/detect-animation-from-options.js';\nimport sync, { cancelSync } from 'framesync';\nimport { interpolate } from '../utils/interpolate.js';\nimport { hasRepeatDelayElapsed, reverseElapsed, loopElapsed } from './utils/elapsed.js';\n\nvar framesync = function (update) {\n    var passTimestamp = function (_a) {\n        var delta = _a.delta;\n        return update(delta);\n    };\n    return {\n        start: function () { return sync.update(passTimestamp, true); },\n        stop: function () { return cancelSync.update(passTimestamp); },\n    };\n};\nfunction animate(_a) {\n    var _b, _c;\n    var from = _a.from, _d = _a.autoplay, autoplay = _d === void 0 ? true : _d, _e = _a.driver, driver = _e === void 0 ? framesync : _e, _f = _a.elapsed, elapsed = _f === void 0 ? 0 : _f, _g = _a.repeat, repeatMax = _g === void 0 ? 0 : _g, _h = _a.repeatType, repeatType = _h === void 0 ? \"loop\" : _h, _j = _a.repeatDelay, repeatDelay = _j === void 0 ? 0 : _j, onPlay = _a.onPlay, onStop = _a.onStop, onComplete = _a.onComplete, onRepeat = _a.onRepeat, onUpdate = _a.onUpdate, options = __rest(_a, [\"from\", \"autoplay\", \"driver\", \"elapsed\", \"repeat\", \"repeatType\", \"repeatDelay\", \"onPlay\", \"onStop\", \"onComplete\", \"onRepeat\", \"onUpdate\"]);\n    var to = options.to;\n    var driverControls;\n    var repeatCount = 0;\n    var computedDuration = options.duration;\n    var latest;\n    var isComplete = false;\n    var isForwardPlayback = true;\n    var interpolateFromNumber;\n    var animator = detectAnimationFromOptions(options);\n    if ((_c = (_b = animator).needsInterpolation) === null || _c === void 0 ? void 0 : _c.call(_b, from, to)) {\n        interpolateFromNumber = interpolate([0, 100], [from, to], {\n            clamp: false,\n        });\n        from = 0;\n        to = 100;\n    }\n    var animation = animator(__assign(__assign({}, options), { from: from, to: to }));\n    function repeat() {\n        repeatCount++;\n        if (repeatType === \"reverse\") {\n            isForwardPlayback = repeatCount % 2 === 0;\n            elapsed = reverseElapsed(elapsed, computedDuration, repeatDelay, isForwardPlayback);\n        }\n        else {\n            elapsed = loopElapsed(elapsed, computedDuration, repeatDelay);\n            if (repeatType === \"mirror\")\n                animation.flipTarget();\n        }\n        isComplete = false;\n        onRepeat && onRepeat();\n    }\n    function complete() {\n        driverControls.stop();\n        onComplete && onComplete();\n    }\n    function update(delta) {\n        if (!isForwardPlayback)\n            delta = -delta;\n        elapsed += delta;\n        if (!isComplete) {\n            var state = animation.next(Math.max(0, elapsed));\n            latest = state.value;\n            if (interpolateFromNumber)\n                latest = interpolateFromNumber(latest);\n            isComplete = isForwardPlayback ? state.done : elapsed <= 0;\n        }\n        onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(latest);\n        if (isComplete) {\n            if (repeatCount === 0)\n                computedDuration !== null && computedDuration !== void 0 ? computedDuration : (computedDuration = elapsed);\n            if (repeatCount < repeatMax) {\n                hasRepeatDelayElapsed(elapsed, computedDuration, repeatDelay, isForwardPlayback) && repeat();\n            }\n            else {\n                complete();\n            }\n        }\n    }\n    function play() {\n        onPlay === null || onPlay === void 0 ? void 0 : onPlay();\n        driverControls = driver(update);\n        driverControls.start();\n    }\n    autoplay && play();\n    return {\n        stop: function () {\n            onStop === null || onStop === void 0 ? void 0 : onStop();\n            driverControls.stop();\n        },\n    };\n}\n\nexport { animate };\n","function velocityPerSecond(velocity, frameDuration) {\n    return frameDuration ? velocity * (1000 / frameDuration) : 0;\n}\n\nexport { velocityPerSecond };\n","/**\n * Converts seconds to milliseconds\n *\n * @param seconds - Time in seconds.\n * @return milliseconds - Converted time in milliseconds.\n */\nvar secondsToMilliseconds = function (seconds) { return seconds * 1000; };\n\nexport { secondsToMilliseconds };\n","import { linear } from './index.js';\n\nvar a = function (a1, a2) { return 1.0 - 3.0 * a2 + 3.0 * a1; };\nvar b = function (a1, a2) { return 3.0 * a2 - 6.0 * a1; };\nvar c = function (a1) { return 3.0 * a1; };\nvar calcBezier = function (t, a1, a2) {\n    return ((a(a1, a2) * t + b(a1, a2)) * t + c(a1)) * t;\n};\nvar getSlope = function (t, a1, a2) {\n    return 3.0 * a(a1, a2) * t * t + 2.0 * b(a1, a2) * t + c(a1);\n};\nvar subdivisionPrecision = 0.0000001;\nvar subdivisionMaxIterations = 10;\nfunction binarySubdivide(aX, aA, aB, mX1, mX2) {\n    var currentX;\n    var currentT;\n    var i = 0;\n    do {\n        currentT = aA + (aB - aA) / 2.0;\n        currentX = calcBezier(currentT, mX1, mX2) - aX;\n        if (currentX > 0.0) {\n            aB = currentT;\n        }\n        else {\n            aA = currentT;\n        }\n    } while (Math.abs(currentX) > subdivisionPrecision &&\n        ++i < subdivisionMaxIterations);\n    return currentT;\n}\nvar newtonIterations = 8;\nvar newtonMinSlope = 0.001;\nfunction newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n    for (var i = 0; i < newtonIterations; ++i) {\n        var currentSlope = getSlope(aGuessT, mX1, mX2);\n        if (currentSlope === 0.0) {\n            return aGuessT;\n        }\n        var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n        aGuessT -= currentX / currentSlope;\n    }\n    return aGuessT;\n}\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\nfunction cubicBezier(mX1, mY1, mX2, mY2) {\n    if (mX1 === mY1 && mX2 === mY2)\n        return linear;\n    var sampleValues = new Float32Array(kSplineTableSize);\n    for (var i = 0; i < kSplineTableSize; ++i) {\n        sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n    function getTForX(aX) {\n        var intervalStart = 0.0;\n        var currentSample = 1;\n        var lastSample = kSplineTableSize - 1;\n        for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n            intervalStart += kSampleStepSize;\n        }\n        --currentSample;\n        var dist = (aX - sampleValues[currentSample]) /\n            (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n        var guessForT = intervalStart + dist * kSampleStepSize;\n        var initialSlope = getSlope(guessForT, mX1, mX2);\n        if (initialSlope >= newtonMinSlope) {\n            return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n        }\n        else if (initialSlope === 0.0) {\n            return guessForT;\n        }\n        else {\n            return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n        }\n    }\n    return function (t) {\n        return t === 0 || t === 1 ? t : calcBezier(getTForX(t), mY1, mY2);\n    };\n}\n\nexport { cubicBezier };\n","import { __read } from 'tslib';\nimport { invariant } from 'hey-listen';\nimport { cubicBezier, linear, easeIn, easeInOut, easeOut, circIn, circInOut, circOut, backIn, backInOut, backOut, anticipate, bounceIn, bounceInOut, bounceOut } from 'popmotion';\n\nvar easingLookup = {\n    linear: linear,\n    easeIn: easeIn,\n    easeInOut: easeInOut,\n    easeOut: easeOut,\n    circIn: circIn,\n    circInOut: circInOut,\n    circOut: circOut,\n    backIn: backIn,\n    backInOut: backInOut,\n    backOut: backOut,\n    anticipate: anticipate,\n    bounceIn: bounceIn,\n    bounceInOut: bounceInOut,\n    bounceOut: bounceOut,\n};\nvar easingDefinitionToFunction = function (definition) {\n    if (Array.isArray(definition)) {\n        // If cubic bezier definition, create bezier curve\n        invariant(definition.length === 4, \"Cubic bezier arrays must contain four numerical values.\");\n        var _a = __read(definition, 4), x1 = _a[0], y1 = _a[1], x2 = _a[2], y2 = _a[3];\n        return cubicBezier(x1, y1, x2, y2);\n    }\n    else if (typeof definition === \"string\") {\n        // Else lookup from table\n        invariant(easingLookup[definition] !== undefined, \"Invalid easing type '\" + definition + \"'\");\n        return easingLookup[definition];\n    }\n    return definition;\n};\nvar isEasingArray = function (ease) {\n    return Array.isArray(ease) && typeof ease[0] !== \"number\";\n};\n\nexport { easingDefinitionToFunction, isEasingArray };\n","import { complex } from 'style-value-types';\n\n/**\n * Check if a value is animatable. Examples:\n *\n * : 100, \"100px\", \"#fff\"\n * : \"block\", \"url(2.jpg)\"\n * @param value\n *\n * @internal\n */\nvar isAnimatable = function (key, value) {\n    // If the list of keys tat might be non-animatable grows, replace with Set\n    if (key === \"zIndex\")\n        return false;\n    // If it's a number or a keyframes array, we can animate it. We might at some point\n    // need to do a deep isAnimatable check of keyframes, or let Popmotion handle this,\n    // but for now lets leave it like this for performance reasons\n    if (typeof value === \"number\" || Array.isArray(value))\n        return true;\n    if (typeof value === \"string\" && // It's animatable if we have a string\n        complex.test(value) && // And it contains numbers and/or colors\n        !value.startsWith(\"url(\") // Unless it starts with \"url(\"\n    ) {\n        return true;\n    }\n    return false;\n};\n\nexport { isAnimatable };\n","import { __assign } from 'tslib';\nimport { isKeyframesTarget } from './is-keyframes-target.js';\n\nvar underDampedSpring = function () { return ({\n    type: \"spring\",\n    stiffness: 500,\n    damping: 25,\n    restDelta: 0.5,\n    restSpeed: 10,\n}); };\nvar criticallyDampedSpring = function (to) { return ({\n    type: \"spring\",\n    stiffness: 550,\n    damping: to === 0 ? 2 * Math.sqrt(550) : 30,\n    restDelta: 0.01,\n    restSpeed: 10,\n}); };\nvar linearTween = function () { return ({\n    type: \"keyframes\",\n    ease: \"linear\",\n    duration: 0.3,\n}); };\nvar keyframes = function (values) { return ({\n    type: \"keyframes\",\n    duration: 0.8,\n    values: values,\n}); };\nvar defaultTransitions = {\n    x: underDampedSpring,\n    y: underDampedSpring,\n    z: underDampedSpring,\n    rotate: underDampedSpring,\n    rotateX: underDampedSpring,\n    rotateY: underDampedSpring,\n    rotateZ: underDampedSpring,\n    scaleX: criticallyDampedSpring,\n    scaleY: criticallyDampedSpring,\n    scale: criticallyDampedSpring,\n    opacity: linearTween,\n    backgroundColor: linearTween,\n    color: linearTween,\n    default: criticallyDampedSpring,\n};\nvar getDefaultTransition = function (valueKey, to) {\n    var transitionFactory;\n    if (isKeyframesTarget(to)) {\n        transitionFactory = keyframes;\n    }\n    else {\n        transitionFactory =\n            defaultTransitions[valueKey] || defaultTransitions.default;\n    }\n    return __assign({ to: to }, transitionFactory(to));\n};\n\nexport { criticallyDampedSpring, getDefaultTransition, linearTween, underDampedSpring };\n","import { __assign } from 'tslib';\nimport { complex } from './index.js';\nimport { floatRegex } from '../utils.js';\n\nvar maxDefaults = new Set(['brightness', 'contrast', 'saturate', 'opacity']);\nfunction applyDefaultFilter(v) {\n    var _a = v.slice(0, -1).split('('), name = _a[0], value = _a[1];\n    if (name === 'drop-shadow')\n        return v;\n    var number = (value.match(floatRegex) || [])[0];\n    if (!number)\n        return v;\n    var unit = value.replace(number, '');\n    var defaultValue = maxDefaults.has(name) ? 1 : 0;\n    if (number !== value)\n        defaultValue *= 100;\n    return name + '(' + defaultValue + unit + ')';\n}\nvar functionRegex = /([a-z-]*)\\(.*?\\)/g;\nvar filter = __assign(__assign({}, complex), { getAnimatableNone: function (v) {\n        var functions = v.match(functionRegex);\n        return functions ? functions.map(applyDefaultFilter).join(' ') : v;\n    } });\n\nexport { filter };\n","import { __assign } from 'tslib';\nimport { color, filter } from 'style-value-types';\nimport { numberValueTypes } from './number.js';\n\n/**\n * A map of default value types for common values\n */\nvar defaultValueTypes = __assign(__assign({}, numberValueTypes), { \n    // Color props\n    color: color, backgroundColor: color, outlineColor: color, fill: color, stroke: color, \n    // Border props\n    borderColor: color, borderTopColor: color, borderRightColor: color, borderBottomColor: color, borderLeftColor: color, filter: filter, WebkitFilter: filter });\n/**\n * Gets the default ValueType for the provided value key\n */\nvar getDefaultValueType = function (key) { return defaultValueTypes[key]; };\n\nexport { defaultValueTypes, getDefaultValueType };\n","import { filter, complex } from 'style-value-types';\nimport { getDefaultValueType } from './defaults.js';\n\nfunction getAnimatableNone(key, value) {\n    var _a;\n    var defaultValueType = getDefaultValueType(key);\n    if (defaultValueType !== filter)\n        defaultValueType = complex;\n    // If value is not recognised as animatable, ie \"none\", create an animatable version origin based on the target\n    return (_a = defaultValueType.getAnimatableNone) === null || _a === void 0 ? void 0 : _a.call(defaultValueType, value);\n}\n\nexport { getAnimatableNone };\n","import { __assign, __rest, __spreadArray, __read } from 'tslib';\nimport { inertia, animate } from 'popmotion';\nimport { secondsToMilliseconds } from '../../utils/time-conversion.js';\nimport { isEasingArray, easingDefinitionToFunction } from './easing.js';\nimport { isAnimatable } from './is-animatable.js';\nimport { getDefaultTransition } from './default-transitions.js';\nimport { warning } from 'hey-listen';\nimport { getAnimatableNone } from '../../render/dom/value-types/animatable-none.js';\n\n/**\n * Decide whether a transition is defined on a given Transition.\n * This filters out orchestration options and returns true\n * if any options are left.\n */\nfunction isTransitionDefined(_a) {\n    _a.when; _a.delay; _a.delayChildren; _a.staggerChildren; _a.staggerDirection; _a.repeat; _a.repeatType; _a.repeatDelay; _a.from; var transition = __rest(_a, [\"when\", \"delay\", \"delayChildren\", \"staggerChildren\", \"staggerDirection\", \"repeat\", \"repeatType\", \"repeatDelay\", \"from\"]);\n    return !!Object.keys(transition).length;\n}\nvar legacyRepeatWarning = false;\n/**\n * Convert Framer Motion's Transition type into Popmotion-compatible options.\n */\nfunction convertTransitionToAnimationOptions(_a) {\n    var ease = _a.ease, times = _a.times, yoyo = _a.yoyo, flip = _a.flip, loop = _a.loop, transition = __rest(_a, [\"ease\", \"times\", \"yoyo\", \"flip\", \"loop\"]);\n    var options = __assign({}, transition);\n    if (times)\n        options[\"offset\"] = times;\n    /**\n     * Convert any existing durations from seconds to milliseconds\n     */\n    if (transition.duration)\n        options[\"duration\"] = secondsToMilliseconds(transition.duration);\n    if (transition.repeatDelay)\n        options.repeatDelay = secondsToMilliseconds(transition.repeatDelay);\n    /**\n     * Map easing names to Popmotion's easing functions\n     */\n    if (ease) {\n        options[\"ease\"] = isEasingArray(ease)\n            ? ease.map(easingDefinitionToFunction)\n            : easingDefinitionToFunction(ease);\n    }\n    /**\n     * Support legacy transition API\n     */\n    if (transition.type === \"tween\")\n        options.type = \"keyframes\";\n    /**\n     * TODO: These options are officially removed from the API.\n     */\n    if (yoyo || loop || flip) {\n        warning(!legacyRepeatWarning, \"yoyo, loop and flip have been removed from the API. Replace with repeat and repeatType options.\");\n        legacyRepeatWarning = true;\n        if (yoyo) {\n            options.repeatType = \"reverse\";\n        }\n        else if (loop) {\n            options.repeatType = \"loop\";\n        }\n        else if (flip) {\n            options.repeatType = \"mirror\";\n        }\n        options.repeat = loop || yoyo || flip || transition.repeat;\n    }\n    /**\n     * TODO: Popmotion 9 has the ability to automatically detect whether to use\n     * a keyframes or spring animation, but does so by detecting velocity and other spring options.\n     * It'd be good to introduce a similar thing here.\n     */\n    if (transition.type !== \"spring\")\n        options.type = \"keyframes\";\n    return options;\n}\n/**\n * Get the delay for a value by checking Transition with decreasing specificity.\n */\nfunction getDelayFromTransition(transition, key) {\n    var _a;\n    var valueTransition = getValueTransition(transition, key) || {};\n    return (_a = valueTransition.delay) !== null && _a !== void 0 ? _a : 0;\n}\nfunction hydrateKeyframes(options) {\n    if (Array.isArray(options.to) && options.to[0] === null) {\n        options.to = __spreadArray([], __read(options.to));\n        options.to[0] = options.from;\n    }\n    return options;\n}\nfunction getPopmotionAnimationOptions(transition, options, key) {\n    var _a;\n    if (Array.isArray(options.to)) {\n        (_a = transition.duration) !== null && _a !== void 0 ? _a : (transition.duration = 0.8);\n    }\n    hydrateKeyframes(options);\n    /**\n     * Get a default transition if none is determined to be defined.\n     */\n    if (!isTransitionDefined(transition)) {\n        transition = __assign(__assign({}, transition), getDefaultTransition(key, options.to));\n    }\n    return __assign(__assign({}, options), convertTransitionToAnimationOptions(transition));\n}\n/**\n *\n */\nfunction getAnimation(key, value, target, transition, onComplete) {\n    var _a;\n    var valueTransition = getValueTransition(transition, key);\n    var origin = (_a = valueTransition.from) !== null && _a !== void 0 ? _a : value.get();\n    var isTargetAnimatable = isAnimatable(key, target);\n    if (origin === \"none\" && isTargetAnimatable && typeof target === \"string\") {\n        /**\n         * If we're trying to animate from \"none\", try and get an animatable version\n         * of the target. This could be improved to work both ways.\n         */\n        origin = getAnimatableNone(key, target);\n    }\n    else if (isZero(origin) && typeof target === \"string\") {\n        origin = getZeroUnit(target);\n    }\n    else if (!Array.isArray(target) &&\n        isZero(target) &&\n        typeof origin === \"string\") {\n        target = getZeroUnit(origin);\n    }\n    var isOriginAnimatable = isAnimatable(key, origin);\n    warning(isOriginAnimatable === isTargetAnimatable, \"You are trying to animate \" + key + \" from \\\"\" + origin + \"\\\" to \\\"\" + target + \"\\\". \" + origin + \" is not an animatable value - to enable this animation set \" + origin + \" to a value animatable to \" + target + \" via the `style` property.\");\n    function start() {\n        var options = {\n            from: origin,\n            to: target,\n            velocity: value.getVelocity(),\n            onComplete: onComplete,\n            onUpdate: function (v) { return value.set(v); },\n        };\n        return valueTransition.type === \"inertia\" ||\n            valueTransition.type === \"decay\"\n            ? inertia(__assign(__assign({}, options), valueTransition))\n            : animate(__assign(__assign({}, getPopmotionAnimationOptions(valueTransition, options, key)), { onUpdate: function (v) {\n                    var _a;\n                    options.onUpdate(v);\n                    (_a = valueTransition.onUpdate) === null || _a === void 0 ? void 0 : _a.call(valueTransition, v);\n                }, onComplete: function () {\n                    var _a;\n                    options.onComplete();\n                    (_a = valueTransition.onComplete) === null || _a === void 0 ? void 0 : _a.call(valueTransition);\n                } }));\n    }\n    function set() {\n        var _a;\n        value.set(target);\n        onComplete();\n        (_a = valueTransition === null || valueTransition === void 0 ? void 0 : valueTransition.onComplete) === null || _a === void 0 ? void 0 : _a.call(valueTransition);\n        return { stop: function () { } };\n    }\n    return !isOriginAnimatable ||\n        !isTargetAnimatable ||\n        valueTransition.type === false\n        ? set\n        : start;\n}\nfunction isZero(value) {\n    return (value === 0 ||\n        (typeof value === \"string\" &&\n            parseFloat(value) === 0 &&\n            value.indexOf(\" \") === -1));\n}\nfunction getZeroUnit(potentialUnitType) {\n    return typeof potentialUnitType === \"number\"\n        ? 0\n        : getAnimatableNone(\"\", potentialUnitType);\n}\nfunction getValueTransition(transition, key) {\n    return transition[key] || transition[\"default\"] || transition;\n}\n/**\n * Start animation on a MotionValue. This function is an interface between\n * Framer Motion and Popmotion\n *\n * @internal\n */\nfunction startAnimation(key, value, target, transition) {\n    if (transition === void 0) { transition = {}; }\n    return value.start(function (onComplete) {\n        var delayTimer;\n        var controls;\n        var animation = getAnimation(key, value, target, transition, onComplete);\n        var delay = getDelayFromTransition(transition, key);\n        var start = function () { return (controls = animation()); };\n        if (delay) {\n            delayTimer = setTimeout(start, secondsToMilliseconds(delay));\n        }\n        else {\n            start();\n        }\n        return function () {\n            clearTimeout(delayTimer);\n            controls === null || controls === void 0 ? void 0 : controls.stop();\n        };\n    });\n}\n\nexport { convertTransitionToAnimationOptions, getDelayFromTransition, getPopmotionAnimationOptions, getValueTransition, getZeroUnit, hydrateKeyframes, isTransitionDefined, isZero, startAnimation };\n","import { __assign } from 'tslib';\nimport { animate } from './index.js';\nimport { velocityPerSecond } from '../utils/velocity-per-second.js';\nimport { getFrameData } from 'framesync';\n\nfunction inertia(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0 : _b, _c = _a.velocity, velocity = _c === void 0 ? 0 : _c, min = _a.min, max = _a.max, _d = _a.power, power = _d === void 0 ? 0.8 : _d, _e = _a.timeConstant, timeConstant = _e === void 0 ? 750 : _e, _f = _a.bounceStiffness, bounceStiffness = _f === void 0 ? 500 : _f, _g = _a.bounceDamping, bounceDamping = _g === void 0 ? 10 : _g, _h = _a.restDelta, restDelta = _h === void 0 ? 1 : _h, modifyTarget = _a.modifyTarget, driver = _a.driver, onUpdate = _a.onUpdate, onComplete = _a.onComplete;\n    var currentAnimation;\n    function isOutOfBounds(v) {\n        return (min !== undefined && v < min) || (max !== undefined && v > max);\n    }\n    function boundaryNearest(v) {\n        if (min === undefined)\n            return max;\n        if (max === undefined)\n            return min;\n        return Math.abs(min - v) < Math.abs(max - v) ? min : max;\n    }\n    function startAnimation(options) {\n        currentAnimation === null || currentAnimation === void 0 ? void 0 : currentAnimation.stop();\n        currentAnimation = animate(__assign(__assign({}, options), { driver: driver, onUpdate: function (v) {\n                var _a;\n                onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(v);\n                (_a = options.onUpdate) === null || _a === void 0 ? void 0 : _a.call(options, v);\n            }, onComplete: onComplete }));\n    }\n    function startSpring(options) {\n        startAnimation(__assign({ type: \"spring\", stiffness: bounceStiffness, damping: bounceDamping, restDelta: restDelta }, options));\n    }\n    if (isOutOfBounds(from)) {\n        startSpring({ from: from, velocity: velocity, to: boundaryNearest(from) });\n    }\n    else {\n        var target = power * velocity + from;\n        if (typeof modifyTarget !== \"undefined\")\n            target = modifyTarget(target);\n        var boundary_1 = boundaryNearest(target);\n        var heading_1 = boundary_1 === min ? -1 : 1;\n        var prev_1;\n        var current_1;\n        var checkBoundary = function (v) {\n            prev_1 = current_1;\n            current_1 = v;\n            velocity = velocityPerSecond(v - prev_1, getFrameData().delta);\n            if ((heading_1 === 1 && v > boundary_1) ||\n                (heading_1 === -1 && v < boundary_1)) {\n                startSpring({ from: v, to: boundary_1, velocity: velocity });\n            }\n        };\n        startAnimation({\n            type: \"decay\",\n            from: from,\n            velocity: velocity,\n            timeConstant: timeConstant,\n            power: power,\n            restDelta: restDelta,\n            modifyTarget: modifyTarget,\n            onUpdate: isOutOfBounds(target) ? checkBoundary : undefined,\n        });\n    }\n    return {\n        stop: function () { return currentAnimation === null || currentAnimation === void 0 ? void 0 : currentAnimation.stop(); },\n    };\n}\n\nexport { inertia };\n","/**\n * Check if value is a numerical string, ie a string that is purely a number eg \"100\" or \"-100.1\"\n */\nvar isNumericalString = function (v) { return /^\\-?\\d*\\.?\\d+$/.test(v); };\n\nexport { isNumericalString };\n","function addUniqueItem(arr, item) {\n    arr.indexOf(item) === -1 && arr.push(item);\n}\nfunction removeItem(arr, item) {\n    var index = arr.indexOf(item);\n    index > -1 && arr.splice(index, 1);\n}\n\nexport { addUniqueItem, removeItem };\n","import { addUniqueItem, removeItem } from './array.js';\n\nvar SubscriptionManager = /** @class */ (function () {\n    function SubscriptionManager() {\n        this.subscriptions = [];\n    }\n    SubscriptionManager.prototype.add = function (handler) {\n        var _this = this;\n        addUniqueItem(this.subscriptions, handler);\n        return function () { return removeItem(_this.subscriptions, handler); };\n    };\n    SubscriptionManager.prototype.notify = function (a, b, c) {\n        var numSubscriptions = this.subscriptions.length;\n        if (!numSubscriptions)\n            return;\n        if (numSubscriptions === 1) {\n            /**\n             * If there's only a single handler we can just call it without invoking a loop.\n             */\n            this.subscriptions[0](a, b, c);\n        }\n        else {\n            for (var i = 0; i < numSubscriptions; i++) {\n                /**\n                 * Check whether the handler exists before firing as it's possible\n                 * the subscriptions were modified during this loop running.\n                 */\n                var handler = this.subscriptions[i];\n                handler && handler(a, b, c);\n            }\n        }\n    };\n    SubscriptionManager.prototype.getSize = function () {\n        return this.subscriptions.length;\n    };\n    SubscriptionManager.prototype.clear = function () {\n        this.subscriptions.length = 0;\n    };\n    return SubscriptionManager;\n}());\n\nexport { SubscriptionManager };\n","import sync, { getFrameData } from 'framesync';\nimport { velocityPerSecond } from 'popmotion';\nimport { SubscriptionManager } from '../utils/subscription-manager.js';\n\nvar isFloat = function (value) {\n    return !isNaN(parseFloat(value));\n};\n/**\n * `MotionValue` is used to track the state and velocity of motion values.\n *\n * @public\n */\nvar MotionValue = /** @class */ (function () {\n    /**\n     * @param init - The initiating value\n     * @param config - Optional configuration options\n     *\n     * -  `transformer`: A function to transform incoming values with.\n     *\n     * @internal\n     */\n    function MotionValue(init) {\n        var _this = this;\n        /**\n         * Duration, in milliseconds, since last updating frame.\n         *\n         * @internal\n         */\n        this.timeDelta = 0;\n        /**\n         * Timestamp of the last time this `MotionValue` was updated.\n         *\n         * @internal\n         */\n        this.lastUpdated = 0;\n        /**\n         * Functions to notify when the `MotionValue` updates.\n         *\n         * @internal\n         */\n        this.updateSubscribers = new SubscriptionManager();\n        /**\n         * Functions to notify when the velocity updates.\n         *\n         * @internal\n         */\n        this.velocityUpdateSubscribers = new SubscriptionManager();\n        /**\n         * Functions to notify when the `MotionValue` updates and `render` is set to `true`.\n         *\n         * @internal\n         */\n        this.renderSubscribers = new SubscriptionManager();\n        /**\n         * Tracks whether this value can output a velocity. Currently this is only true\n         * if the value is numerical, but we might be able to widen the scope here and support\n         * other value types.\n         *\n         * @internal\n         */\n        this.canTrackVelocity = false;\n        this.updateAndNotify = function (v, render) {\n            if (render === void 0) { render = true; }\n            _this.prev = _this.current;\n            _this.current = v;\n            // Update timestamp\n            var _a = getFrameData(), delta = _a.delta, timestamp = _a.timestamp;\n            if (_this.lastUpdated !== timestamp) {\n                _this.timeDelta = delta;\n                _this.lastUpdated = timestamp;\n                sync.postRender(_this.scheduleVelocityCheck);\n            }\n            // Update update subscribers\n            if (_this.prev !== _this.current) {\n                _this.updateSubscribers.notify(_this.current);\n            }\n            // Update velocity subscribers\n            if (_this.velocityUpdateSubscribers.getSize()) {\n                _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n            }\n            // Update render subscribers\n            if (render) {\n                _this.renderSubscribers.notify(_this.current);\n            }\n        };\n        /**\n         * Schedule a velocity check for the next frame.\n         *\n         * This is an instanced and bound function to prevent generating a new\n         * function once per frame.\n         *\n         * @internal\n         */\n        this.scheduleVelocityCheck = function () { return sync.postRender(_this.velocityCheck); };\n        /**\n         * Updates `prev` with `current` if the value hasn't been updated this frame.\n         * This ensures velocity calculations return `0`.\n         *\n         * This is an instanced and bound function to prevent generating a new\n         * function once per frame.\n         *\n         * @internal\n         */\n        this.velocityCheck = function (_a) {\n            var timestamp = _a.timestamp;\n            if (timestamp !== _this.lastUpdated) {\n                _this.prev = _this.current;\n                _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n            }\n        };\n        this.hasAnimated = false;\n        this.prev = this.current = init;\n        this.canTrackVelocity = isFloat(this.current);\n    }\n    /**\n     * Adds a function that will be notified when the `MotionValue` is updated.\n     *\n     * It returns a function that, when called, will cancel the subscription.\n     *\n     * When calling `onChange` inside a React component, it should be wrapped with the\n     * `useEffect` hook. As it returns an unsubscribe function, this should be returned\n     * from the `useEffect` function to ensure you don't add duplicate subscribers..\n     *\n     * @library\n     *\n     * ```jsx\n     * function MyComponent() {\n     *   const x = useMotionValue(0)\n     *   const y = useMotionValue(0)\n     *   const opacity = useMotionValue(1)\n     *\n     *   useEffect(() => {\n     *     function updateOpacity() {\n     *       const maxXY = Math.max(x.get(), y.get())\n     *       const newOpacity = transform(maxXY, [0, 100], [1, 0])\n     *       opacity.set(newOpacity)\n     *     }\n     *\n     *     const unsubscribeX = x.onChange(updateOpacity)\n     *     const unsubscribeY = y.onChange(updateOpacity)\n     *\n     *     return () => {\n     *       unsubscribeX()\n     *       unsubscribeY()\n     *     }\n     *   }, [])\n     *\n     *   return <Frame x={x} />\n     * }\n     * ```\n     *\n     * @motion\n     *\n     * ```jsx\n     * export const MyComponent = () => {\n     *   const x = useMotionValue(0)\n     *   const y = useMotionValue(0)\n     *   const opacity = useMotionValue(1)\n     *\n     *   useEffect(() => {\n     *     function updateOpacity() {\n     *       const maxXY = Math.max(x.get(), y.get())\n     *       const newOpacity = transform(maxXY, [0, 100], [1, 0])\n     *       opacity.set(newOpacity)\n     *     }\n     *\n     *     const unsubscribeX = x.onChange(updateOpacity)\n     *     const unsubscribeY = y.onChange(updateOpacity)\n     *\n     *     return () => {\n     *       unsubscribeX()\n     *       unsubscribeY()\n     *     }\n     *   }, [])\n     *\n     *   return <motion.div style={{ x }} />\n     * }\n     * ```\n     *\n     * @internalremarks\n     *\n     * We could look into a `useOnChange` hook if the above lifecycle management proves confusing.\n     *\n     * ```jsx\n     * useOnChange(x, () => {})\n     * ```\n     *\n     * @param subscriber - A function that receives the latest value.\n     * @returns A function that, when called, will cancel this subscription.\n     *\n     * @public\n     */\n    MotionValue.prototype.onChange = function (subscription) {\n        return this.updateSubscribers.add(subscription);\n    };\n    MotionValue.prototype.clearListeners = function () {\n        this.updateSubscribers.clear();\n    };\n    /**\n     * Adds a function that will be notified when the `MotionValue` requests a render.\n     *\n     * @param subscriber - A function that's provided the latest value.\n     * @returns A function that, when called, will cancel this subscription.\n     *\n     * @internal\n     */\n    MotionValue.prototype.onRenderRequest = function (subscription) {\n        // Render immediately\n        subscription(this.get());\n        return this.renderSubscribers.add(subscription);\n    };\n    /**\n     * Attaches a passive effect to the `MotionValue`.\n     *\n     * @internal\n     */\n    MotionValue.prototype.attach = function (passiveEffect) {\n        this.passiveEffect = passiveEffect;\n    };\n    /**\n     * Sets the state of the `MotionValue`.\n     *\n     * @remarks\n     *\n     * ```jsx\n     * const x = useMotionValue(0)\n     * x.set(10)\n     * ```\n     *\n     * @param latest - Latest value to set.\n     * @param render - Whether to notify render subscribers. Defaults to `true`\n     *\n     * @public\n     */\n    MotionValue.prototype.set = function (v, render) {\n        if (render === void 0) { render = true; }\n        if (!render || !this.passiveEffect) {\n            this.updateAndNotify(v, render);\n        }\n        else {\n            this.passiveEffect(v, this.updateAndNotify);\n        }\n    };\n    /**\n     * Returns the latest state of `MotionValue`\n     *\n     * @returns - The latest state of `MotionValue`\n     *\n     * @public\n     */\n    MotionValue.prototype.get = function () {\n        return this.current;\n    };\n    /**\n     * @public\n     */\n    MotionValue.prototype.getPrevious = function () {\n        return this.prev;\n    };\n    /**\n     * Returns the latest velocity of `MotionValue`\n     *\n     * @returns - The latest velocity of `MotionValue`. Returns `0` if the state is non-numerical.\n     *\n     * @public\n     */\n    MotionValue.prototype.getVelocity = function () {\n        // This could be isFloat(this.prev) && isFloat(this.current), but that would be wasteful\n        return this.canTrackVelocity\n            ? // These casts could be avoided if parseFloat would be typed better\n                velocityPerSecond(parseFloat(this.current) -\n                    parseFloat(this.prev), this.timeDelta)\n            : 0;\n    };\n    /**\n     * Registers a new animation to control this `MotionValue`. Only one\n     * animation can drive a `MotionValue` at one time.\n     *\n     * ```jsx\n     * value.start()\n     * ```\n     *\n     * @param animation - A function that starts the provided animation\n     *\n     * @internal\n     */\n    MotionValue.prototype.start = function (animation) {\n        var _this = this;\n        this.stop();\n        return new Promise(function (resolve) {\n            _this.hasAnimated = true;\n            _this.stopAnimation = animation(resolve);\n        }).then(function () { return _this.clearAnimation(); });\n    };\n    /**\n     * Stop the currently active animation.\n     *\n     * @public\n     */\n    MotionValue.prototype.stop = function () {\n        if (this.stopAnimation)\n            this.stopAnimation();\n        this.clearAnimation();\n    };\n    /**\n     * Returns `true` if this value is currently animating.\n     *\n     * @public\n     */\n    MotionValue.prototype.isAnimating = function () {\n        return !!this.stopAnimation;\n    };\n    MotionValue.prototype.clearAnimation = function () {\n        this.stopAnimation = null;\n    };\n    /**\n     * Destroy and clean up subscribers to this `MotionValue`.\n     *\n     * The `MotionValue` hooks like `useMotionValue` and `useTransform` automatically\n     * handle the lifecycle of the returned `MotionValue`, so this method is only necessary if you've manually\n     * created a `MotionValue` via the `motionValue` function.\n     *\n     * @public\n     */\n    MotionValue.prototype.destroy = function () {\n        this.updateSubscribers.clear();\n        this.renderSubscribers.clear();\n        this.stop();\n    };\n    return MotionValue;\n}());\n/**\n * @internal\n */\nfunction motionValue(init) {\n    return new MotionValue(init);\n}\n\nexport { MotionValue, motionValue };\n","/**\n * Tests a provided value against a ValueType\n */\nvar testValueType = function (v) { return function (type) { return type.test(v); }; };\n\nexport { testValueType };\n","var AnimationType;\n(function (AnimationType) {\n    AnimationType[\"Animate\"] = \"animate\";\n    AnimationType[\"Hover\"] = \"whileHover\";\n    AnimationType[\"Tap\"] = \"whileTap\";\n    AnimationType[\"Drag\"] = \"whileDrag\";\n    AnimationType[\"Focus\"] = \"whileFocus\";\n    AnimationType[\"Exit\"] = \"exit\";\n})(AnimationType || (AnimationType = {}));\n\nexport { AnimationType };\n","import { number, px, percent, degrees, vw, vh } from 'style-value-types';\nimport { testValueType } from './test.js';\nimport { auto } from './type-auto.js';\n\n/**\n * A list of value types commonly used for dimensions\n */\nvar dimensionValueTypes = [number, px, percent, degrees, vw, vh, auto];\n/**\n * Tests a dimensional value against the list of dimension ValueTypes\n */\nvar findDimensionValueType = function (v) {\n    return dimensionValueTypes.find(testValueType(v));\n};\n\nexport { dimensionValueTypes, findDimensionValueType };\n","/**\n * ValueType for \"auto\"\n */\nvar auto = {\n    test: function (v) { return v === \"auto\"; },\n    parse: function (v) { return v; },\n};\n\nexport { auto };\n","import { __spreadArray, __read } from 'tslib';\nimport { color, complex } from 'style-value-types';\nimport { dimensionValueTypes } from './dimensions.js';\nimport { testValueType } from './test.js';\n\n/**\n * A list of all ValueTypes\n */\nvar valueTypes = __spreadArray(__spreadArray([], __read(dimensionValueTypes)), [color, complex]);\n/**\n * Tests a value against the list of ValueTypes\n */\nvar findValueType = function (v) { return valueTypes.find(testValueType(v)); };\n\nexport { findValueType };\n","import { __rest, __assign, __spreadArray, __read } from 'tslib';\nimport { complex } from 'style-value-types';\nimport { isNumericalString } from '../../utils/is-numerical-string.js';\nimport { resolveFinalValueInKeyframes } from '../../utils/resolve-value.js';\nimport { motionValue } from '../../value/index.js';\nimport { getAnimatableNone } from '../dom/value-types/animatable-none.js';\nimport { findValueType } from '../dom/value-types/find.js';\nimport { resolveVariant } from './variants.js';\n\n/**\n * Set VisualElement's MotionValue, creating a new MotionValue for it if\n * it doesn't exist.\n */\nfunction setMotionValue(visualElement, key, value) {\n    if (visualElement.hasValue(key)) {\n        visualElement.getValue(key).set(value);\n    }\n    else {\n        visualElement.addValue(key, motionValue(value));\n    }\n}\nfunction setTarget(visualElement, definition) {\n    var resolved = resolveVariant(visualElement, definition);\n    var _a = resolved\n        ? visualElement.makeTargetAnimatable(resolved, false)\n        : {}, _b = _a.transitionEnd, transitionEnd = _b === void 0 ? {} : _b; _a.transition; var target = __rest(_a, [\"transitionEnd\", \"transition\"]);\n    target = __assign(__assign({}, target), transitionEnd);\n    for (var key in target) {\n        var value = resolveFinalValueInKeyframes(target[key]);\n        setMotionValue(visualElement, key, value);\n    }\n}\nfunction setVariants(visualElement, variantLabels) {\n    var reversedLabels = __spreadArray([], __read(variantLabels)).reverse();\n    reversedLabels.forEach(function (key) {\n        var _a;\n        var variant = visualElement.getVariant(key);\n        variant && setTarget(visualElement, variant);\n        (_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            setVariants(child, variantLabels);\n        });\n    });\n}\nfunction setValues(visualElement, definition) {\n    if (Array.isArray(definition)) {\n        return setVariants(visualElement, definition);\n    }\n    else if (typeof definition === \"string\") {\n        return setVariants(visualElement, [definition]);\n    }\n    else {\n        setTarget(visualElement, definition);\n    }\n}\nfunction checkTargetForNewValues(visualElement, target, origin) {\n    var _a, _b, _c;\n    var _d;\n    var newValueKeys = Object.keys(target).filter(function (key) { return !visualElement.hasValue(key); });\n    var numNewValues = newValueKeys.length;\n    if (!numNewValues)\n        return;\n    for (var i = 0; i < numNewValues; i++) {\n        var key = newValueKeys[i];\n        var targetValue = target[key];\n        var value = null;\n        /**\n         * If the target is a series of keyframes, we can use the first value\n         * in the array. If this first value is null, we'll still need to read from the DOM.\n         */\n        if (Array.isArray(targetValue)) {\n            value = targetValue[0];\n        }\n        /**\n         * If the target isn't keyframes, or the first keyframe was null, we need to\n         * first check if an origin value was explicitly defined in the transition as \"from\",\n         * if not read the value from the DOM. As an absolute fallback, take the defined target value.\n         */\n        if (value === null) {\n            value = (_b = (_a = origin[key]) !== null && _a !== void 0 ? _a : visualElement.readValue(key)) !== null && _b !== void 0 ? _b : target[key];\n        }\n        /**\n         * If value is still undefined or null, ignore it. Preferably this would throw,\n         * but this was causing issues in Framer.\n         */\n        if (value === undefined || value === null)\n            continue;\n        if (typeof value === \"string\" && isNumericalString(value)) {\n            // If this is a number read as a string, ie \"0\" or \"200\", convert it to a number\n            value = parseFloat(value);\n        }\n        else if (!findValueType(value) && complex.test(targetValue)) {\n            value = getAnimatableNone(key, targetValue);\n        }\n        visualElement.addValue(key, motionValue(value));\n        (_c = (_d = origin)[key]) !== null && _c !== void 0 ? _c : (_d[key] = value);\n        visualElement.setBaseTarget(key, value);\n    }\n}\nfunction getOriginFromTransition(key, transition) {\n    if (!transition)\n        return;\n    var valueTransition = transition[key] || transition[\"default\"] || transition;\n    return valueTransition.from;\n}\nfunction getOrigin(target, transition, visualElement) {\n    var _a, _b;\n    var origin = {};\n    for (var key in target) {\n        origin[key] =\n            (_a = getOriginFromTransition(key, transition)) !== null && _a !== void 0 ? _a : (_b = visualElement.getValue(key)) === null || _b === void 0 ? void 0 : _b.get();\n    }\n    return origin;\n}\n\nexport { checkTargetForNewValues, getOrigin, getOriginFromTransition, setTarget, setValues };\n","import { __read, __rest, __assign } from 'tslib';\nimport { startAnimation } from '../../animation/utils/transitions.js';\nimport { setTarget } from './setters.js';\nimport { resolveVariant } from './variants.js';\n\n/**\n * @internal\n */\nfunction animateVisualElement(visualElement, definition, options) {\n    if (options === void 0) { options = {}; }\n    visualElement.notifyAnimationStart();\n    var animation;\n    if (Array.isArray(definition)) {\n        var animations = definition.map(function (variant) {\n            return animateVariant(visualElement, variant, options);\n        });\n        animation = Promise.all(animations);\n    }\n    else if (typeof definition === \"string\") {\n        animation = animateVariant(visualElement, definition, options);\n    }\n    else {\n        var resolvedDefinition = typeof definition === \"function\"\n            ? resolveVariant(visualElement, definition, options.custom)\n            : definition;\n        animation = animateTarget(visualElement, resolvedDefinition, options);\n    }\n    return animation.then(function () {\n        return visualElement.notifyAnimationComplete(definition);\n    });\n}\nfunction animateVariant(visualElement, variant, options) {\n    var _a;\n    if (options === void 0) { options = {}; }\n    var resolved = resolveVariant(visualElement, variant, options.custom);\n    var _b = (resolved || {}).transition, transition = _b === void 0 ? visualElement.getDefaultTransition() || {} : _b;\n    if (options.transitionOverride) {\n        transition = options.transitionOverride;\n    }\n    /**\n     * If we have a variant, create a callback that runs it as an animation.\n     * Otherwise, we resolve a Promise immediately for a composable no-op.\n     */\n    var getAnimation = resolved\n        ? function () { return animateTarget(visualElement, resolved, options); }\n        : function () { return Promise.resolve(); };\n    /**\n     * If we have children, create a callback that runs all their animations.\n     * Otherwise, we resolve a Promise immediately for a composable no-op.\n     */\n    var getChildAnimations = ((_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.size)\n        ? function (forwardDelay) {\n            if (forwardDelay === void 0) { forwardDelay = 0; }\n            var _a = transition.delayChildren, delayChildren = _a === void 0 ? 0 : _a, staggerChildren = transition.staggerChildren, staggerDirection = transition.staggerDirection;\n            return animateChildren(visualElement, variant, delayChildren + forwardDelay, staggerChildren, staggerDirection, options);\n        }\n        : function () { return Promise.resolve(); };\n    /**\n     * If the transition explicitly defines a \"when\" option, we need to resolve either\n     * this animation or all children animations before playing the other.\n     */\n    var when = transition.when;\n    if (when) {\n        var _c = __read(when === \"beforeChildren\"\n            ? [getAnimation, getChildAnimations]\n            : [getChildAnimations, getAnimation], 2), first = _c[0], last = _c[1];\n        return first().then(last);\n    }\n    else {\n        return Promise.all([getAnimation(), getChildAnimations(options.delay)]);\n    }\n}\n/**\n * @internal\n */\nfunction animateTarget(visualElement, definition, _a) {\n    var _b;\n    var _c = _a === void 0 ? {} : _a, _d = _c.delay, delay = _d === void 0 ? 0 : _d, transitionOverride = _c.transitionOverride, type = _c.type;\n    var _e = visualElement.makeTargetAnimatable(definition), _f = _e.transition, transition = _f === void 0 ? visualElement.getDefaultTransition() : _f, transitionEnd = _e.transitionEnd, target = __rest(_e, [\"transition\", \"transitionEnd\"]);\n    if (transitionOverride)\n        transition = transitionOverride;\n    var animations = [];\n    var animationTypeState = type && ((_b = visualElement.animationState) === null || _b === void 0 ? void 0 : _b.getState()[type]);\n    for (var key in target) {\n        var value = visualElement.getValue(key);\n        var valueTarget = target[key];\n        if (!value ||\n            valueTarget === undefined ||\n            (animationTypeState &&\n                shouldBlockAnimation(animationTypeState, key))) {\n            continue;\n        }\n        var animation = startAnimation(key, value, valueTarget, __assign({ delay: delay }, transition));\n        animations.push(animation);\n    }\n    return Promise.all(animations).then(function () {\n        transitionEnd && setTarget(visualElement, transitionEnd);\n    });\n}\nfunction animateChildren(visualElement, variant, delayChildren, staggerChildren, staggerDirection, options) {\n    if (delayChildren === void 0) { delayChildren = 0; }\n    if (staggerChildren === void 0) { staggerChildren = 0; }\n    if (staggerDirection === void 0) { staggerDirection = 1; }\n    var animations = [];\n    var maxStaggerDuration = (visualElement.variantChildren.size - 1) * staggerChildren;\n    var generateStaggerDuration = staggerDirection === 1\n        ? function (i) {\n            if (i === void 0) { i = 0; }\n            return i * staggerChildren;\n        }\n        : function (i) {\n            if (i === void 0) { i = 0; }\n            return maxStaggerDuration - i * staggerChildren;\n        };\n    Array.from(visualElement.variantChildren)\n        .sort(sortByTreeOrder)\n        .forEach(function (child, i) {\n        animations.push(animateVariant(child, variant, __assign(__assign({}, options), { delay: delayChildren + generateStaggerDuration(i) })).then(function () { return child.notifyAnimationComplete(variant); }));\n    });\n    return Promise.all(animations);\n}\nfunction stopAnimation(visualElement) {\n    visualElement.forEachValue(function (value) { return value.stop(); });\n}\nfunction sortByTreeOrder(a, b) {\n    return a.sortNodePosition(b);\n}\n/**\n * Decide whether we should block this animation. Previously, we achieved this\n * just by checking whether the key was listed in protectedKeys, but this\n * posed problems if an animation was triggered by afterChildren and protectedKeys\n * had been set to true in the meantime.\n */\nfunction shouldBlockAnimation(_a, key) {\n    var protectedKeys = _a.protectedKeys, needsAnimating = _a.needsAnimating;\n    var shouldBlock = protectedKeys.hasOwnProperty(key) && needsAnimating[key] !== true;\n    needsAnimating[key] = false;\n    return shouldBlock;\n}\n\nexport { animateVisualElement, sortByTreeOrder, stopAnimation };\n","import { __spreadArray, __read, __assign, __rest } from 'tslib';\nimport { isAnimationControls } from '../../animation/utils/is-animation-controls.js';\nimport { isKeyframesTarget } from '../../animation/utils/is-keyframes-target.js';\nimport { shallowCompare } from '../../utils/shallow-compare.js';\nimport { animateVisualElement } from './animation.js';\nimport { AnimationType } from './types.js';\nimport { isVariantLabels, resolveVariant, isVariantLabel } from './variants.js';\n\nvar variantPriorityOrder = [\n    AnimationType.Animate,\n    AnimationType.Hover,\n    AnimationType.Tap,\n    AnimationType.Drag,\n    AnimationType.Focus,\n    AnimationType.Exit,\n];\nvar reversePriorityOrder = __spreadArray([], __read(variantPriorityOrder)).reverse();\nvar numAnimationTypes = variantPriorityOrder.length;\nfunction animateList(visualElement) {\n    return function (animations) {\n        return Promise.all(animations.map(function (_a) {\n            var animation = _a.animation, options = _a.options;\n            return animateVisualElement(visualElement, animation, options);\n        }));\n    };\n}\nfunction createAnimationState(visualElement) {\n    var animate = animateList(visualElement);\n    var state = createState();\n    var allAnimatedKeys = {};\n    var isInitialRender = true;\n    /**\n     * This function will be used to reduce the animation definitions for\n     * each active animation type into an object of resolved values for it.\n     */\n    var buildResolvedTypeValues = function (acc, definition) {\n        var resolved = resolveVariant(visualElement, definition);\n        if (resolved) {\n            resolved.transition; var transitionEnd = resolved.transitionEnd, target = __rest(resolved, [\"transition\", \"transitionEnd\"]);\n            acc = __assign(__assign(__assign({}, acc), target), transitionEnd);\n        }\n        return acc;\n    };\n    function isAnimated(key) {\n        return allAnimatedKeys[key] !== undefined;\n    }\n    /**\n     * This just allows us to inject mocked animation functions\n     * @internal\n     */\n    function setAnimateFunction(makeAnimator) {\n        animate = makeAnimator(visualElement);\n    }\n    /**\n     * When we receive new props, we need to:\n     * 1. Create a list of protected keys for each type. This is a directory of\n     *    value keys that are currently being \"handled\" by types of a higher priority\n     *    so that whenever an animation is played of a given type, these values are\n     *    protected from being animated.\n     * 2. Determine if an animation type needs animating.\n     * 3. Determine if any values have been removed from a type and figure out\n     *    what to animate those to.\n     */\n    function animateChanges(options, changedActiveType) {\n        var _a;\n        var props = visualElement.getProps();\n        var context = visualElement.getVariantContext(true) || {};\n        /**\n         * A list of animations that we'll build into as we iterate through the animation\n         * types. This will get executed at the end of the function.\n         */\n        var animations = [];\n        /**\n         * Keep track of which values have been removed. Then, as we hit lower priority\n         * animation types, we can check if they contain removed values and animate to that.\n         */\n        var removedKeys = new Set();\n        /**\n         * A dictionary of all encountered keys. This is an object to let us build into and\n         * copy it without iteration. Each time we hit an animation type we set its protected\n         * keys - the keys its not allowed to animate - to the latest version of this object.\n         */\n        var encounteredKeys = {};\n        /**\n         * If a variant has been removed at a given index, and this component is controlling\n         * variant animations, we want to ensure lower-priority variants are forced to animate.\n         */\n        var removedVariantIndex = Infinity;\n        var _loop_1 = function (i) {\n            var type = reversePriorityOrder[i];\n            var typeState = state[type];\n            var prop = (_a = props[type]) !== null && _a !== void 0 ? _a : context[type];\n            var propIsVariant = isVariantLabel(prop);\n            /**\n             * If this type has *just* changed isActive status, set activeDelta\n             * to that status. Otherwise set to null.\n             */\n            var activeDelta = type === changedActiveType ? typeState.isActive : null;\n            if (activeDelta === false)\n                removedVariantIndex = i;\n            /**\n             * If this prop is an inherited variant, rather than been set directly on the\n             * component itself, we want to make sure we allow the parent to trigger animations.\n             *\n             * TODO: Can probably change this to a !isControllingVariants check\n             */\n            var isInherited = prop === context[type] && prop !== props[type] && propIsVariant;\n            /**\n             *\n             */\n            if (isInherited &&\n                isInitialRender &&\n                visualElement.manuallyAnimateOnMount) {\n                isInherited = false;\n            }\n            /**\n             * Set all encountered keys so far as the protected keys for this type. This will\n             * be any key that has been animated or otherwise handled by active, higher-priortiy types.\n             */\n            typeState.protectedKeys = __assign({}, encounteredKeys);\n            // Check if we can skip analysing this prop early\n            if (\n            // If it isn't active and hasn't *just* been set as inactive\n            (!typeState.isActive && activeDelta === null) ||\n                // If we didn't and don't have any defined prop for this animation type\n                (!prop && !typeState.prevProp) ||\n                // Or if the prop doesn't define an animation\n                isAnimationControls(prop) ||\n                typeof prop === \"boolean\") {\n                return \"continue\";\n            }\n            /**\n             * As we go look through the values defined on this type, if we detect\n             * a changed value or a value that was removed in a higher priority, we set\n             * this to true and add this prop to the animation list.\n             */\n            var shouldAnimateType = variantsHaveChanged(typeState.prevProp, prop) ||\n                // If we're making this variant active, we want to always make it active\n                (type === changedActiveType &&\n                    typeState.isActive &&\n                    !isInherited &&\n                    propIsVariant) ||\n                // If we removed a higher-priority variant (i is in reverse order)\n                (i > removedVariantIndex && propIsVariant);\n            /**\n             * As animations can be set as variant lists, variants or target objects, we\n             * coerce everything to an array if it isn't one already\n             */\n            var definitionList = Array.isArray(prop) ? prop : [prop];\n            /**\n             * Build an object of all the resolved values. We'll use this in the subsequent\n             * animateChanges calls to determine whether a value has changed.\n             */\n            var resolvedValues = definitionList.reduce(buildResolvedTypeValues, {});\n            if (activeDelta === false)\n                resolvedValues = {};\n            /**\n             * Now we need to loop through all the keys in the prev prop and this prop,\n             * and decide:\n             * 1. If the value has changed, and needs animating\n             * 2. If it has been removed, and needs adding to the removedKeys set\n             * 3. If it has been removed in a higher priority type and needs animating\n             * 4. If it hasn't been removed in a higher priority but hasn't changed, and\n             *    needs adding to the type's protectedKeys list.\n             */\n            var _b = typeState.prevResolvedValues, prevResolvedValues = _b === void 0 ? {} : _b;\n            var allKeys = __assign(__assign({}, prevResolvedValues), resolvedValues);\n            var markToAnimate = function (key) {\n                shouldAnimateType = true;\n                removedKeys.delete(key);\n                typeState.needsAnimating[key] = true;\n            };\n            for (var key in allKeys) {\n                var next = resolvedValues[key];\n                var prev = prevResolvedValues[key];\n                // If we've already handled this we can just skip ahead\n                if (encounteredKeys.hasOwnProperty(key))\n                    continue;\n                /**\n                 * If the value has changed, we probably want to animate it.\n                 */\n                if (next !== prev) {\n                    /**\n                     * If both values are keyframes, we need to shallow compare them to\n                     * detect whether any value has changed. If it has, we animate it.\n                     */\n                    if (isKeyframesTarget(next) && isKeyframesTarget(prev)) {\n                        if (!shallowCompare(next, prev)) {\n                            markToAnimate(key);\n                        }\n                        else {\n                            /**\n                             * If it hasn't changed, we want to ensure it doesn't animate by\n                             * adding it to the list of protected keys.\n                             */\n                            typeState.protectedKeys[key] = true;\n                        }\n                    }\n                    else if (next !== undefined) {\n                        // If next is defined and doesn't equal prev, it needs animating\n                        markToAnimate(key);\n                    }\n                    else {\n                        // If it's undefined, it's been removed.\n                        removedKeys.add(key);\n                    }\n                }\n                else if (next !== undefined && removedKeys.has(key)) {\n                    /**\n                     * If next hasn't changed and it isn't undefined, we want to check if it's\n                     * been removed by a higher priority\n                     */\n                    markToAnimate(key);\n                }\n                else {\n                    /**\n                     * If it hasn't changed, we add it to the list of protected values\n                     * to ensure it doesn't get animated.\n                     */\n                    typeState.protectedKeys[key] = true;\n                }\n            }\n            /**\n             * Update the typeState so next time animateChanges is called we can compare the\n             * latest prop and resolvedValues to these.\n             */\n            typeState.prevProp = prop;\n            typeState.prevResolvedValues = resolvedValues;\n            /**\n             *\n             */\n            if (typeState.isActive) {\n                encounteredKeys = __assign(__assign({}, encounteredKeys), resolvedValues);\n            }\n            if (isInitialRender && visualElement.blockInitialAnimation) {\n                shouldAnimateType = false;\n            }\n            /**\n             * If this is an inherited prop we want to hard-block animations\n             * TODO: Test as this should probably still handle animations triggered\n             * by removed values?\n             */\n            if (shouldAnimateType && !isInherited) {\n                animations.push.apply(animations, __spreadArray([], __read(definitionList.map(function (animation) { return ({\n                    animation: animation,\n                    options: __assign({ type: type }, options),\n                }); }))));\n            }\n        };\n        /**\n         * Iterate through all animation types in reverse priority order. For each, we want to\n         * detect which values it's handling and whether or not they've changed (and therefore\n         * need to be animated). If any values have been removed, we want to detect those in\n         * lower priority props and flag for animation.\n         */\n        for (var i = 0; i < numAnimationTypes; i++) {\n            _loop_1(i);\n        }\n        allAnimatedKeys = __assign({}, encounteredKeys);\n        /**\n         * If there are some removed value that haven't been dealt with,\n         * we need to create a new animation that falls back either to the value\n         * defined in the style prop, or the last read value.\n         */\n        if (removedKeys.size) {\n            var fallbackAnimation_1 = {};\n            removedKeys.forEach(function (key) {\n                var fallbackTarget = visualElement.getBaseTarget(key);\n                if (fallbackTarget !== undefined) {\n                    fallbackAnimation_1[key] = fallbackTarget;\n                }\n            });\n            animations.push({ animation: fallbackAnimation_1 });\n        }\n        var shouldAnimate = Boolean(animations.length);\n        if (isInitialRender &&\n            props.initial === false &&\n            !visualElement.manuallyAnimateOnMount) {\n            shouldAnimate = false;\n        }\n        isInitialRender = false;\n        return shouldAnimate ? animate(animations) : Promise.resolve();\n    }\n    /**\n     * Change whether a certain animation type is active.\n     */\n    function setActive(type, isActive, options) {\n        var _a;\n        // If the active state hasn't changed, we can safely do nothing here\n        if (state[type].isActive === isActive)\n            return Promise.resolve();\n        // Propagate active change to children\n        (_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.forEach(function (child) { var _a; return (_a = child.animationState) === null || _a === void 0 ? void 0 : _a.setActive(type, isActive); });\n        state[type].isActive = isActive;\n        return animateChanges(options, type);\n    }\n    return {\n        isAnimated: isAnimated,\n        animateChanges: animateChanges,\n        setActive: setActive,\n        setAnimateFunction: setAnimateFunction,\n        getState: function () { return state; },\n    };\n}\nfunction variantsHaveChanged(prev, next) {\n    if (typeof next === \"string\") {\n        return next !== prev;\n    }\n    else if (isVariantLabels(next)) {\n        return !shallowCompare(next, prev);\n    }\n    return false;\n}\nfunction createTypeState(isActive) {\n    if (isActive === void 0) { isActive = false; }\n    return {\n        isActive: isActive,\n        protectedKeys: {},\n        needsAnimating: {},\n        prevResolvedValues: {},\n    };\n}\nfunction createState() {\n    var _a;\n    return _a = {},\n        _a[AnimationType.Animate] = createTypeState(true),\n        _a[AnimationType.Hover] = createTypeState(),\n        _a[AnimationType.Tap] = createTypeState(),\n        _a[AnimationType.Drag] = createTypeState(),\n        _a[AnimationType.Focus] = createTypeState(),\n        _a[AnimationType.Exit] = createTypeState(),\n        _a;\n}\n\nexport { createAnimationState, variantPriorityOrder, variantsHaveChanged };\n","var makeRenderlessComponent = function (hook) { return function (props) {\n    hook(props);\n    return null;\n}; };\n\nexport { makeRenderlessComponent };\n","import { __read } from 'tslib';\nimport { useEffect, useContext } from 'react';\nimport { isAnimationControls } from '../../animation/utils/is-animation-controls.js';\nimport { usePresence } from '../../components/AnimatePresence/use-presence.js';\nimport { PresenceContext } from '../../context/PresenceContext.js';\nimport { createAnimationState } from '../../render/utils/animation-state.js';\nimport { AnimationType } from '../../render/utils/types.js';\nimport { makeRenderlessComponent } from '../utils/make-renderless-component.js';\n\nvar animations = {\n    animation: makeRenderlessComponent(function (_a) {\n        var visualElement = _a.visualElement, animate = _a.animate;\n        /**\n         * We dynamically generate the AnimationState manager as it contains a reference\n         * to the underlying animation library. We only want to load that if we load this,\n         * so people can optionally code split it out using the `m` component.\n         */\n        visualElement.animationState || (visualElement.animationState = createAnimationState(visualElement));\n        /**\n         * Subscribe any provided AnimationControls to the component's VisualElement\n         */\n        if (isAnimationControls(animate)) {\n            useEffect(function () { return animate.subscribe(visualElement); }, [animate]);\n        }\n    }),\n    exit: makeRenderlessComponent(function (props) {\n        var custom = props.custom, visualElement = props.visualElement;\n        var _a = __read(usePresence(), 2), isPresent = _a[0], onExitComplete = _a[1];\n        var presenceContext = useContext(PresenceContext);\n        useEffect(function () {\n            var _a, _b;\n            var animation = (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Exit, !isPresent, { custom: (_b = presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.custom) !== null && _b !== void 0 ? _b : custom });\n            !isPresent && (animation === null || animation === void 0 ? void 0 : animation.then(onExitComplete));\n        }, [isPresent]);\n    }),\n};\n\nexport { animations };\n","import { useEffect } from 'react';\n\nfunction addDomEvent(target, eventName, handler, options) {\n    target.addEventListener(eventName, handler, options);\n    return function () { return target.removeEventListener(eventName, handler, options); };\n}\n/**\n * Attaches an event listener directly to the provided DOM element.\n *\n * Bypassing React's event system can be desirable, for instance when attaching non-passive\n * event handlers.\n *\n * ```jsx\n * const ref = useRef(null)\n *\n * useDomEvent(ref, 'wheel', onWheel, { passive: false })\n *\n * return <div ref={ref} />\n * ```\n *\n * @param ref - React.RefObject that's been provided to the element you want to bind the listener to.\n * @param eventName - Name of the event you want listen for.\n * @param handler - Function to fire when receiving the event.\n * @param options - Options to pass to `Event.addEventListener`.\n *\n * @public\n */\nfunction useDomEvent(ref, eventName, handler, options) {\n    useEffect(function () {\n        var element = ref.current;\n        if (handler && element) {\n            return addDomEvent(element, eventName, handler, options);\n        }\n    }, [ref, eventName, handler, options]);\n}\n\nexport { addDomEvent, useDomEvent };\n","function isMouseEvent(event) {\n    // PointerEvent inherits from MouseEvent so we can't use a straight instanceof check.\n    if (typeof PointerEvent !== \"undefined\" && event instanceof PointerEvent) {\n        return !!(event.pointerType === \"mouse\");\n    }\n    return event instanceof MouseEvent;\n}\nfunction isTouchEvent(event) {\n    var hasTouches = !!event.touches;\n    return hasTouches;\n}\n\nexport { isMouseEvent, isTouchEvent };\n","import { isTouchEvent } from '../gestures/utils/event-type.js';\n\n/**\n * Filters out events not attached to the primary pointer (currently left mouse button)\n * @param eventHandler\n */\nfunction filterPrimaryPointer(eventHandler) {\n    return function (event) {\n        var isMouseEvent = event instanceof MouseEvent;\n        var isPrimaryPointer = !isMouseEvent ||\n            (isMouseEvent && event.button === 0);\n        if (isPrimaryPointer) {\n            eventHandler(event);\n        }\n    };\n}\nvar defaultPagePoint = { pageX: 0, pageY: 0 };\nfunction pointFromTouch(e, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    var primaryTouch = e.touches[0] || e.changedTouches[0];\n    var point = primaryTouch || defaultPagePoint;\n    return {\n        x: point[pointType + \"X\"],\n        y: point[pointType + \"Y\"],\n    };\n}\nfunction pointFromMouse(point, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    return {\n        x: point[pointType + \"X\"],\n        y: point[pointType + \"Y\"],\n    };\n}\nfunction extractEventInfo(event, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    return {\n        point: isTouchEvent(event)\n            ? pointFromTouch(event, pointType)\n            : pointFromMouse(event, pointType),\n    };\n}\nfunction getViewportPointFromEvent(event) {\n    return extractEventInfo(event, \"client\");\n}\nvar wrapHandler = function (handler, shouldFilterPrimaryPointer) {\n    if (shouldFilterPrimaryPointer === void 0) { shouldFilterPrimaryPointer = false; }\n    var listener = function (event) {\n        return handler(event, extractEventInfo(event));\n    };\n    return shouldFilterPrimaryPointer\n        ? filterPrimaryPointer(listener)\n        : listener;\n};\n\nexport { extractEventInfo, getViewportPointFromEvent, wrapHandler };\n","import { useDomEvent, addDomEvent } from './use-dom-event.js';\nimport { wrapHandler } from './event-info.js';\nimport { supportsPointerEvents, supportsTouchEvents, supportsMouseEvents } from './utils.js';\n\nvar mouseEventNames = {\n    pointerdown: \"mousedown\",\n    pointermove: \"mousemove\",\n    pointerup: \"mouseup\",\n    pointercancel: \"mousecancel\",\n    pointerover: \"mouseover\",\n    pointerout: \"mouseout\",\n    pointerenter: \"mouseenter\",\n    pointerleave: \"mouseleave\",\n};\nvar touchEventNames = {\n    pointerdown: \"touchstart\",\n    pointermove: \"touchmove\",\n    pointerup: \"touchend\",\n    pointercancel: \"touchcancel\",\n};\nfunction getPointerEventName(name) {\n    if (supportsPointerEvents()) {\n        return name;\n    }\n    else if (supportsTouchEvents()) {\n        return touchEventNames[name];\n    }\n    else if (supportsMouseEvents()) {\n        return mouseEventNames[name];\n    }\n    return name;\n}\nfunction addPointerEvent(target, eventName, handler, options) {\n    return addDomEvent(target, getPointerEventName(eventName), wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\nfunction usePointerEvent(ref, eventName, handler, options) {\n    return useDomEvent(ref, getPointerEventName(eventName), handler && wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\n\nexport { addPointerEvent, usePointerEvent };\n","import { isBrowser } from '../utils/is-browser.js';\n\n// We check for event support via functions in case they've been mocked by a testing suite.\nvar supportsPointerEvents = function () {\n    return isBrowser && window.onpointerdown === null;\n};\nvar supportsTouchEvents = function () {\n    return isBrowser && window.ontouchstart === null;\n};\nvar supportsMouseEvents = function () {\n    return isBrowser && window.onmousedown === null;\n};\n\nexport { supportsMouseEvents, supportsPointerEvents, supportsTouchEvents };\n","function createLock(name) {\n    var lock = null;\n    return function () {\n        var openLock = function () {\n            lock = null;\n        };\n        if (lock === null) {\n            lock = name;\n            return openLock;\n        }\n        return false;\n    };\n}\nvar globalHorizontalLock = createLock(\"dragHorizontal\");\nvar globalVerticalLock = createLock(\"dragVertical\");\nfunction getGlobalLock(drag) {\n    var lock = false;\n    if (drag === \"y\") {\n        lock = globalVerticalLock();\n    }\n    else if (drag === \"x\") {\n        lock = globalHorizontalLock();\n    }\n    else {\n        var openHorizontal_1 = globalHorizontalLock();\n        var openVertical_1 = globalVerticalLock();\n        if (openHorizontal_1 && openVertical_1) {\n            lock = function () {\n                openHorizontal_1();\n                openVertical_1();\n            };\n        }\n        else {\n            // Release the locks because we don't use them\n            if (openHorizontal_1)\n                openHorizontal_1();\n            if (openVertical_1)\n                openVertical_1();\n        }\n    }\n    return lock;\n}\nfunction isDragActive() {\n    // Check the gesture lock - if we get it, it means no drag gesture is active\n    // and we can safely fire the tap gesture.\n    var openGestureLock = getGlobalLock(true);\n    if (!openGestureLock)\n        return true;\n    openGestureLock();\n    return false;\n}\n\nexport { createLock, getGlobalLock, isDragActive };\n","import { isMouseEvent } from './utils/event-type.js';\nimport { AnimationType } from '../render/utils/types.js';\nimport { usePointerEvent } from '../events/use-pointer-event.js';\nimport { isDragActive } from './drag/utils/lock.js';\n\nfunction createHoverEvent(visualElement, isActive, callback) {\n    return function (event, info) {\n        var _a;\n        if (!isMouseEvent(event) || isDragActive())\n            return;\n        callback === null || callback === void 0 ? void 0 : callback(event, info);\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Hover, isActive);\n    };\n}\nfunction useHoverGesture(_a) {\n    var onHoverStart = _a.onHoverStart, onHoverEnd = _a.onHoverEnd, whileHover = _a.whileHover, visualElement = _a.visualElement;\n    usePointerEvent(visualElement, \"pointerenter\", onHoverStart || whileHover\n        ? createHoverEvent(visualElement, true, onHoverStart)\n        : undefined);\n    usePointerEvent(visualElement, \"pointerleave\", onHoverEnd || whileHover\n        ? createHoverEvent(visualElement, false, onHoverEnd)\n        : undefined);\n}\n\nexport { useHoverGesture };\n","/**\n * Recursively traverse up the tree to check whether the provided child node\n * is the parent or a descendant of it.\n *\n * @param parent - Element to find\n * @param child - Element to test against parent\n */\nvar isNodeOrChild = function (parent, child) {\n    if (!child) {\n        return false;\n    }\n    else if (parent === child) {\n        return true;\n    }\n    else {\n        return isNodeOrChild(parent, child.parentElement);\n    }\n};\n\nexport { isNodeOrChild };\n","import { useFocusGesture } from '../../gestures/use-focus-gesture.js';\nimport { useHoverGesture } from '../../gestures/use-hover-gesture.js';\nimport { useTapGesture } from '../../gestures/use-tap-gesture.js';\nimport { makeRenderlessComponent } from '../utils/make-renderless-component.js';\n\nvar gestureAnimations = {\n    tap: makeRenderlessComponent(useTapGesture),\n    focus: makeRenderlessComponent(useFocusGesture),\n    hover: makeRenderlessComponent(useHoverGesture),\n};\n\nexport { gestureAnimations };\n","/**\n * @public\n */\nvar Presence;\n(function (Presence) {\n    Presence[Presence[\"Entering\"] = 0] = \"Entering\";\n    Presence[Presence[\"Present\"] = 1] = \"Present\";\n    Presence[Presence[\"Exiting\"] = 2] = \"Exiting\";\n})(Presence || (Presence = {}));\n/**\n * @public\n */\nvar VisibilityAction;\n(function (VisibilityAction) {\n    VisibilityAction[VisibilityAction[\"Hide\"] = 0] = \"Hide\";\n    VisibilityAction[VisibilityAction[\"Show\"] = 1] = \"Show\";\n})(VisibilityAction || (VisibilityAction = {}));\n\nexport { Presence, VisibilityAction };\n","import { useRef } from 'react';\nimport { isNodeOrChild } from './utils/is-node-or-child.js';\nimport { usePointerEvent, addPointerEvent } from '../events/use-pointer-event.js';\nimport { useUnmountEffect } from '../utils/use-unmount-effect.js';\nimport { pipe } from 'popmotion';\nimport { AnimationType } from '../render/utils/types.js';\nimport { isDragActive } from './drag/utils/lock.js';\n\n/**\n * @param handlers -\n * @internal\n */\nfunction useTapGesture(_a) {\n    var onTap = _a.onTap, onTapStart = _a.onTapStart, onTapCancel = _a.onTapCancel, whileTap = _a.whileTap, visualElement = _a.visualElement;\n    var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n    var isPressing = useRef(false);\n    var cancelPointerEndListeners = useRef(null);\n    function removePointerEndListener() {\n        var _a;\n        (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n        cancelPointerEndListeners.current = null;\n    }\n    function checkPointerEnd() {\n        var _a;\n        removePointerEndListener();\n        isPressing.current = false;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, false);\n        return !isDragActive();\n    }\n    function onPointerUp(event, info) {\n        if (!checkPointerEnd())\n            return;\n        /**\n         * We only count this as a tap gesture if the event.target is the same\n         * as, or a child of, this component's element\n         */\n        !isNodeOrChild(visualElement.getInstance(), event.target)\n            ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info)\n            : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n    }\n    function onPointerCancel(event, info) {\n        if (!checkPointerEnd())\n            return;\n        onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n    }\n    function onPointerDown(event, info) {\n        var _a;\n        removePointerEndListener();\n        if (isPressing.current)\n            return;\n        isPressing.current = true;\n        cancelPointerEndListeners.current = pipe(addPointerEvent(window, \"pointerup\", onPointerUp), addPointerEvent(window, \"pointercancel\", onPointerCancel));\n        onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, true);\n    }\n    usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined);\n    useUnmountEffect(removePointerEndListener);\n}\n\nexport { useTapGesture };\n","import { useEffect } from 'react';\n\nfunction useUnmountEffect(callback) {\n    return useEffect(function () { return function () { return callback(); }; }, []);\n}\n\nexport { useUnmountEffect };\n","import { AnimationType } from '../render/utils/types.js';\nimport { useDomEvent } from '../events/use-dom-event.js';\n\n/**\n *\n * @param props\n * @param ref\n * @internal\n */\nfunction useFocusGesture(_a) {\n    var whileFocus = _a.whileFocus, visualElement = _a.visualElement;\n    var onFocus = function () {\n        var _a;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Focus, true);\n    };\n    var onBlur = function () {\n        var _a;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Focus, false);\n    };\n    useDomEvent(visualElement, \"focus\", whileFocus ? onFocus : undefined);\n    useDomEvent(visualElement, \"blur\", whileFocus ? onBlur : undefined);\n}\n\nexport { useFocusGesture };\n","// Call a handler once for each axis\nfunction eachAxis(handler) {\n    return [handler(\"x\"), handler(\"y\")];\n}\n\nexport { eachAxis };\n","function noop(any) {\n    return any;\n}\n\nexport { noop };\n","import { __assign } from 'tslib';\nimport { noop } from '../noop.js';\n\n/**\n * Bounding boxes tend to be defined as top, left, right, bottom. For various operations\n * it's easier to consider each axis individually. This function returns a bounding box\n * as a map of single-axis min/max values.\n */\nfunction convertBoundingBoxToAxisBox(_a) {\n    var top = _a.top, left = _a.left, right = _a.right, bottom = _a.bottom;\n    return {\n        x: { min: left, max: right },\n        y: { min: top, max: bottom },\n    };\n}\nfunction convertAxisBoxToBoundingBox(_a) {\n    var x = _a.x, y = _a.y;\n    return {\n        top: y.min,\n        bottom: y.max,\n        left: x.min,\n        right: x.max,\n    };\n}\n/**\n * Applies a TransformPoint function to a bounding box. TransformPoint is usually a function\n * provided by Framer to allow measured points to be corrected for device scaling. This is used\n * when measuring DOM elements and DOM event points.\n */\nfunction transformBoundingBox(_a, transformPoint) {\n    var top = _a.top, left = _a.left, bottom = _a.bottom, right = _a.right;\n    if (transformPoint === void 0) { transformPoint = noop; }\n    var topLeft = transformPoint({ x: left, y: top });\n    var bottomRight = transformPoint({ x: right, y: bottom });\n    return {\n        top: topLeft.y,\n        left: topLeft.x,\n        bottom: bottomRight.y,\n        right: bottomRight.x,\n    };\n}\n/**\n * Create an empty axis box of zero size\n */\nfunction axisBox() {\n    return { x: { min: 0, max: 1 }, y: { min: 0, max: 1 } };\n}\nfunction copyAxisBox(box) {\n    return {\n        x: __assign({}, box.x),\n        y: __assign({}, box.y),\n    };\n}\n/**\n * Create an empty box delta\n */\nvar zeroDelta = {\n    translate: 0,\n    scale: 1,\n    origin: 0,\n    originPoint: 0,\n};\nfunction delta() {\n    return {\n        x: __assign({}, zeroDelta),\n        y: __assign({}, zeroDelta),\n    };\n}\n\nexport { axisBox, convertAxisBoxToBoundingBox, convertBoundingBoxToAxisBox, copyAxisBox, delta, transformBoundingBox };\n","function isDraggable(visualElement) {\n    var _a = visualElement.getProps(), drag = _a.drag, _dragX = _a._dragX;\n    return drag && !_dragX;\n}\n\nexport { isDraggable };\n","import { __read } from 'tslib';\nimport { mix } from 'popmotion';\nimport { isDraggable } from '../../render/utils/is-draggable.js';\n\n/**\n * Reset an axis to the provided origin box.\n *\n * This is a mutative operation.\n */\nfunction resetAxis(axis, originAxis) {\n    axis.min = originAxis.min;\n    axis.max = originAxis.max;\n}\n/**\n * Reset a box to the provided origin box.\n *\n * This is a mutative operation.\n */\nfunction resetBox(box, originBox) {\n    resetAxis(box.x, originBox.x);\n    resetAxis(box.y, originBox.y);\n}\n/**\n * Scales a point based on a factor and an originPoint\n */\nfunction scalePoint(point, scale, originPoint) {\n    var distanceFromOrigin = point - originPoint;\n    var scaled = scale * distanceFromOrigin;\n    return originPoint + scaled;\n}\n/**\n * Applies a translate/scale delta to a point\n */\nfunction applyPointDelta(point, translate, scale, originPoint, boxScale) {\n    if (boxScale !== undefined) {\n        point = scalePoint(point, boxScale, originPoint);\n    }\n    return scalePoint(point, scale, originPoint) + translate;\n}\n/**\n * Applies a translate/scale delta to an axis\n */\nfunction applyAxisDelta(axis, translate, scale, originPoint, boxScale) {\n    if (translate === void 0) { translate = 0; }\n    if (scale === void 0) { scale = 1; }\n    axis.min = applyPointDelta(axis.min, translate, scale, originPoint, boxScale);\n    axis.max = applyPointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Applies a translate/scale delta to a box\n */\nfunction applyBoxDelta(box, _a) {\n    var x = _a.x, y = _a.y;\n    applyAxisDelta(box.x, x.translate, x.scale, x.originPoint);\n    applyAxisDelta(box.y, y.translate, y.scale, y.originPoint);\n}\n/**\n * Apply a transform to an axis from the latest resolved motion values.\n * This function basically acts as a bridge between a flat motion value map\n * and applyAxisDelta\n */\nfunction applyAxisTransforms(final, axis, transforms, _a) {\n    var _b = __read(_a, 3), key = _b[0], scaleKey = _b[1], originKey = _b[2];\n    // Copy the current axis to the final axis before mutation\n    final.min = axis.min;\n    final.max = axis.max;\n    var axisOrigin = transforms[originKey] !== undefined ? transforms[originKey] : 0.5;\n    var originPoint = mix(axis.min, axis.max, axisOrigin);\n    // Apply the axis delta to the final axis\n    applyAxisDelta(final, transforms[key], transforms[scaleKey], originPoint, transforms.scale);\n}\n/**\n * The names of the motion values we want to apply as translation, scale and origin.\n */\nvar xKeys = [\"x\", \"scaleX\", \"originX\"];\nvar yKeys = [\"y\", \"scaleY\", \"originY\"];\n/**\n * Apply a transform to a box from the latest resolved motion values.\n */\nfunction applyBoxTransforms(finalBox, box, transforms) {\n    applyAxisTransforms(finalBox.x, box.x, transforms, xKeys);\n    applyAxisTransforms(finalBox.y, box.y, transforms, yKeys);\n}\n/**\n * Remove a delta from a point. This is essentially the steps of applyPointDelta in reverse\n */\nfunction removePointDelta(point, translate, scale, originPoint, boxScale) {\n    point -= translate;\n    point = scalePoint(point, 1 / scale, originPoint);\n    if (boxScale !== undefined) {\n        point = scalePoint(point, 1 / boxScale, originPoint);\n    }\n    return point;\n}\n/**\n * Remove a delta from an axis. This is essentially the steps of applyAxisDelta in reverse\n */\nfunction removeAxisDelta(axis, translate, scale, origin, boxScale) {\n    if (translate === void 0) { translate = 0; }\n    if (scale === void 0) { scale = 1; }\n    if (origin === void 0) { origin = 0.5; }\n    var originPoint = mix(axis.min, axis.max, origin) - translate;\n    axis.min = removePointDelta(axis.min, translate, scale, originPoint, boxScale);\n    axis.max = removePointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Remove a transforms from an axis. This is essentially the steps of applyAxisTransforms in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\nfunction removeAxisTransforms(axis, transforms, _a) {\n    var _b = __read(_a, 3), key = _b[0], scaleKey = _b[1], originKey = _b[2];\n    removeAxisDelta(axis, transforms[key], transforms[scaleKey], transforms[originKey], transforms.scale);\n}\n/**\n * Remove a transforms from an box. This is essentially the steps of applyAxisBox in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\nfunction removeBoxTransforms(box, transforms) {\n    removeAxisTransforms(box.x, transforms, xKeys);\n    removeAxisTransforms(box.y, transforms, yKeys);\n}\n/**\n * Apply a tree of deltas to a box. We do this to calculate the effect of all the transforms\n * in a tree upon our box before then calculating how to project it into our desired viewport-relative box\n *\n * This is the final nested loop within updateLayoutDelta for future refactoring\n */\nfunction applyTreeDeltas(box, treeScale, treePath) {\n    var treeLength = treePath.length;\n    if (!treeLength)\n        return;\n    // Reset the treeScale\n    treeScale.x = treeScale.y = 1;\n    var node;\n    var delta;\n    for (var i = 0; i < treeLength; i++) {\n        node = treePath[i];\n        delta = node.getLayoutState().delta;\n        // Incoporate each ancestor's scale into a culmulative treeScale for this component\n        treeScale.x *= delta.x.scale;\n        treeScale.y *= delta.y.scale;\n        // Apply each ancestor's calculated delta into this component's recorded layout box\n        applyBoxDelta(box, delta);\n        // If this is a draggable ancestor, also incorporate the node's transform to the layout box\n        if (isDraggable(node)) {\n            applyBoxTransforms(box, box, node.getLatestValues());\n        }\n    }\n}\n\nexport { applyAxisDelta, applyAxisTransforms, applyBoxDelta, applyBoxTransforms, applyPointDelta, applyTreeDeltas, removeAxisDelta, removeAxisTransforms, removeBoxTransforms, removePointDelta, resetAxis, resetBox, scalePoint };\n","var isPoint = function (point) {\n    return point.hasOwnProperty('x') && point.hasOwnProperty('y');\n};\n\nexport { isPoint };\n","import { isPoint } from './is-point.js';\n\nvar isPoint3D = function (point) {\n    return isPoint(point) && point.hasOwnProperty('z');\n};\n\nexport { isPoint3D };\n","import { isPoint } from './is-point.js';\nimport { isPoint3D } from './is-point-3d.js';\nimport { isNum } from './inc.js';\n\nvar distance1D = function (a, b) { return Math.abs(a - b); };\nfunction distance(a, b) {\n    if (isNum(a) && isNum(b)) {\n        return distance1D(a, b);\n    }\n    else if (isPoint(a) && isPoint(b)) {\n        var xDelta = distance1D(a.x, b.x);\n        var yDelta = distance1D(a.y, b.y);\n        var zDelta = isPoint3D(a) && isPoint3D(b) ? distance1D(a.z, b.z) : 0;\n        return Math.sqrt(Math.pow(xDelta, 2) + Math.pow(yDelta, 2) + Math.pow(zDelta, 2));\n    }\n}\n\nexport { distance };\n","import { mix, distance, clamp, progress } from 'popmotion';\n\nvar clampProgress = function (v) { return clamp(0, 1, v); };\n/**\n * Returns true if the provided value is within maxDistance of the provided target\n */\nfunction isNear(value, target, maxDistance) {\n    if (target === void 0) { target = 0; }\n    if (maxDistance === void 0) { maxDistance = 0.01; }\n    return distance(value, target) < maxDistance;\n}\nfunction calcLength(axis) {\n    return axis.max - axis.min;\n}\n/**\n * Calculate a transform origin relative to the source axis, between 0-1, that results\n * in an asthetically pleasing scale/transform needed to project from source to target.\n */\nfunction calcOrigin(source, target) {\n    var origin = 0.5;\n    var sourceLength = calcLength(source);\n    var targetLength = calcLength(target);\n    if (targetLength > sourceLength) {\n        origin = progress(target.min, target.max - sourceLength, source.min);\n    }\n    else if (sourceLength > targetLength) {\n        origin = progress(source.min, source.max - targetLength, target.min);\n    }\n    return clampProgress(origin);\n}\n/**\n * Update the AxisDelta with a transform that projects source into target.\n *\n * The transform `origin` is optional. If not provided, it'll be automatically\n * calculated based on the relative positions of the two bounding boxes.\n */\nfunction updateAxisDelta(delta, source, target, origin) {\n    if (origin === void 0) { origin = 0.5; }\n    delta.origin = origin;\n    delta.originPoint = mix(source.min, source.max, delta.origin);\n    delta.scale = calcLength(target) / calcLength(source);\n    if (isNear(delta.scale, 1, 0.0001))\n        delta.scale = 1;\n    delta.translate =\n        mix(target.min, target.max, delta.origin) - delta.originPoint;\n    if (isNear(delta.translate))\n        delta.translate = 0;\n}\n/**\n * Update the BoxDelta with a transform that projects the source into the target.\n *\n * The transform `origin` is optional. If not provided, it'll be automatically\n * calculated based on the relative positions of the two bounding boxes.\n */\nfunction updateBoxDelta(delta, source, target, origin) {\n    updateAxisDelta(delta.x, source.x, target.x, defaultOrigin(origin.originX));\n    updateAxisDelta(delta.y, source.y, target.y, defaultOrigin(origin.originY));\n}\n/**\n * Currently this only accepts numerical origins, measured as 0-1, but could\n * accept pixel values by comparing to the target axis.\n */\nfunction defaultOrigin(origin) {\n    return typeof origin === \"number\" ? origin : 0.5;\n}\nfunction calcRelativeAxis(target, relative, parent) {\n    target.min = parent.min + relative.min;\n    target.max = target.min + calcLength(relative);\n}\nfunction calcRelativeBox(projection, parentProjection) {\n    calcRelativeAxis(projection.target.x, projection.relativeTarget.x, parentProjection.target.x);\n    calcRelativeAxis(projection.target.y, projection.relativeTarget.y, parentProjection.target.y);\n}\n\nexport { calcOrigin, calcRelativeAxis, calcRelativeBox, isNear, updateAxisDelta, updateBoxDelta };\n","import { axisBox, delta } from '../../utils/geometry/index.js';\n\nvar createProjectionState = function () { return ({\n    isEnabled: false,\n    isHydrated: false,\n    isTargetLocked: false,\n    target: axisBox(),\n    targetFinal: axisBox(),\n}); };\nfunction createLayoutState() {\n    return {\n        isHydrated: false,\n        layout: axisBox(),\n        layoutCorrected: axisBox(),\n        treeScale: { x: 1, y: 1 },\n        delta: delta(),\n        deltaFinal: delta(),\n        deltaTransform: \"\",\n    };\n}\nvar zeroLayout = createLayoutState();\n\nexport { createLayoutState, createProjectionState, zeroLayout };\n","import { zeroLayout } from '../../utils/state.js';\n\n/**\n * Build a transform style that takes a calculated delta between the element's current\n * space on screen and projects it into the desired space.\n */\nfunction buildLayoutProjectionTransform(_a, treeScale, latestTransform) {\n    var x = _a.x, y = _a.y;\n    /**\n     * The translations we use to calculate are always relative to the viewport coordinate space.\n     * But when we apply scales, we also scale the coordinate space of an element and its children.\n     * For instance if we have a treeScale (the culmination of all parent scales) of 0.5 and we need\n     * to move an element 100 pixels, we actually need to move it 200 in within that scaled space.\n     */\n    var xTranslate = x.translate / treeScale.x;\n    var yTranslate = y.translate / treeScale.y;\n    var transform = \"translate3d(\" + xTranslate + \"px, \" + yTranslate + \"px, 0) \";\n    if (latestTransform) {\n        var rotate = latestTransform.rotate, rotateX = latestTransform.rotateX, rotateY = latestTransform.rotateY;\n        if (rotate)\n            transform += \"rotate(\" + rotate + \") \";\n        if (rotateX)\n            transform += \"rotateX(\" + rotateX + \") \";\n        if (rotateY)\n            transform += \"rotateY(\" + rotateY + \") \";\n    }\n    transform += \"scale(\" + x.scale + \", \" + y.scale + \")\";\n    return !latestTransform && transform === identityProjection ? \"\" : transform;\n}\n/**\n * Take the calculated delta origin and apply it as a transform string.\n */\nfunction buildLayoutProjectionTransformOrigin(_a) {\n    var deltaFinal = _a.deltaFinal;\n    return deltaFinal.x.origin * 100 + \"% \" + deltaFinal.y.origin * 100 + \"% 0\";\n}\nvar identityProjection = buildLayoutProjectionTransform(zeroLayout.delta, zeroLayout.treeScale, { x: 1, y: 1 });\n\nexport { buildLayoutProjectionTransform, buildLayoutProjectionTransformOrigin, identityProjection };\n","import { __spreadArray, __read } from 'tslib';\nimport { SubscriptionManager } from '../../utils/subscription-manager.js';\n\nvar names = [\n    \"LayoutMeasure\",\n    \"BeforeLayoutMeasure\",\n    \"LayoutUpdate\",\n    \"ViewportBoxUpdate\",\n    \"Update\",\n    \"Render\",\n    \"AnimationComplete\",\n    \"LayoutAnimationComplete\",\n    \"AnimationStart\",\n    \"SetAxisTarget\",\n    \"Unmount\",\n];\nfunction createLifecycles() {\n    var managers = names.map(function () { return new SubscriptionManager(); });\n    var propSubscriptions = {};\n    var lifecycles = {\n        clearAllListeners: function () { return managers.forEach(function (manager) { return manager.clear(); }); },\n        updatePropListeners: function (props) {\n            return names.forEach(function (name) {\n                var _a;\n                (_a = propSubscriptions[name]) === null || _a === void 0 ? void 0 : _a.call(propSubscriptions);\n                var on = \"on\" + name;\n                var propListener = props[on];\n                if (propListener) {\n                    propSubscriptions[name] = lifecycles[on](propListener);\n                }\n            });\n        },\n    };\n    managers.forEach(function (manager, i) {\n        lifecycles[\"on\" + names[i]] = function (handler) { return manager.add(handler); };\n        lifecycles[\"notify\" + names[i]] = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return manager.notify.apply(manager, __spreadArray([], __read(args)));\n        };\n    });\n    return lifecycles;\n}\n\nexport { createLifecycles };\n","import { resetBox, applyTreeDeltas } from '../../utils/geometry/delta-apply.js';\nimport { updateBoxDelta } from '../../utils/geometry/delta-calc.js';\n\nfunction updateLayoutDeltas(_a, _b, treePath, transformOrigin) {\n    var delta = _a.delta, layout = _a.layout, layoutCorrected = _a.layoutCorrected, treeScale = _a.treeScale;\n    var target = _b.target;\n    /**\n     * Reset the corrected box with the latest values from box, as we're then going\n     * to perform mutative operations on it.\n     */\n    resetBox(layoutCorrected, layout);\n    /**\n     * Apply all the parent deltas to this box to produce the corrected box. This\n     * is the layout box, as it will appear on screen as a result of the transforms of its parents.\n     */\n    applyTreeDeltas(layoutCorrected, treeScale, treePath);\n    /**\n     * Update the delta between the corrected box and the target box before user-set transforms were applied.\n     * This will allow us to calculate the corrected borderRadius and boxShadow to compensate\n     * for our layout reprojection, but still allow them to be scaled correctly by the user.\n     * It might be that to simplify this we may want to accept that user-set scale is also corrected\n     * and we wouldn't have to keep and calc both deltas, OR we could support a user setting\n     * to allow people to choose whether these styles are corrected based on just the\n     * layout reprojection or the final bounding box.\n     */\n    updateBoxDelta(delta, layoutCorrected, target, transformOrigin);\n}\n\nexport { updateLayoutDeltas };\n","var compareByDepth = function (a, b) {\n    return a.depth - b.depth;\n};\n\nexport { compareByDepth };\n","import { addUniqueItem, removeItem } from '../../utils/array.js';\nimport { compareByDepth } from './compare-by-depth.js';\n\nvar FlatTree = /** @class */ (function () {\n    function FlatTree() {\n        this.children = [];\n        this.isDirty = false;\n    }\n    FlatTree.prototype.add = function (child) {\n        addUniqueItem(this.children, child);\n        this.isDirty = true;\n    };\n    FlatTree.prototype.remove = function (child) {\n        removeItem(this.children, child);\n        this.isDirty = true;\n    };\n    FlatTree.prototype.forEach = function (callback) {\n        this.isDirty && this.children.sort(compareByDepth);\n        this.isDirty = false;\n        this.children.forEach(callback);\n    };\n    return FlatTree;\n}());\n\nexport { FlatTree };\n","import { mix } from 'popmotion';\n\nfunction tweenAxis(target, prev, next, p) {\n    target.min = mix(prev.min, next.min, p);\n    target.max = mix(prev.max, next.max, p);\n}\nfunction calcRelativeOffsetAxis(parent, child) {\n    return {\n        min: child.min - parent.min,\n        max: child.max - parent.min,\n    };\n}\nfunction calcRelativeOffset(parent, child) {\n    return {\n        x: calcRelativeOffsetAxis(parent.x, child.x),\n        y: calcRelativeOffsetAxis(parent.y, child.y),\n    };\n}\nfunction checkIfParentHasChanged(prev, next) {\n    var prevId = prev.getLayoutId();\n    var nextId = next.getLayoutId();\n    return prevId !== nextId || (nextId === undefined && prev !== next);\n}\n\nexport { calcRelativeOffset, calcRelativeOffsetAxis, checkIfParentHasChanged, tweenAxis };\n","import { calcRelativeOffset } from '../../../motion/features/layout/utils.js';\nimport { eachAxis } from '../../../utils/each-axis.js';\n\nfunction setCurrentViewportBox(visualElement) {\n    var projectionParent = visualElement.getProjectionParent();\n    if (!projectionParent) {\n        visualElement.rebaseProjectionTarget();\n        return;\n    }\n    var relativeOffset = calcRelativeOffset(projectionParent.getLayoutState().layout, visualElement.getLayoutState().layout);\n    eachAxis(function (axis) {\n        visualElement.setProjectionTargetAxis(axis, relativeOffset[axis].min, relativeOffset[axis].max, true);\n    });\n}\n\nexport { setCurrentViewportBox };\n","import { __assign, __spreadArray, __read } from 'tslib';\nimport sync, { cancelSync } from 'framesync';\nimport { pipe } from 'popmotion';\nimport { Presence } from '../components/AnimateSharedLayout/types.js';\nimport { eachAxis } from '../utils/each-axis.js';\nimport { axisBox } from '../utils/geometry/index.js';\nimport { removeBoxTransforms, applyBoxTransforms } from '../utils/geometry/delta-apply.js';\nimport { calcRelativeBox, updateBoxDelta } from '../utils/geometry/delta-calc.js';\nimport { motionValue } from '../value/index.js';\nimport { isMotionValue } from '../value/utils/is-motion-value.js';\nimport { buildLayoutProjectionTransform } from './html/utils/build-projection-transform.js';\nimport { variantPriorityOrder } from './utils/animation-state.js';\nimport { createLifecycles } from './utils/lifecycles.js';\nimport { updateMotionValuesFromProps } from './utils/motion-values.js';\nimport { updateLayoutDeltas } from './utils/projection.js';\nimport { createLayoutState, createProjectionState } from './utils/state.js';\nimport { FlatTree } from './utils/flat-tree.js';\nimport { checkIfControllingVariants, checkIfVariantNode, isVariantLabel } from './utils/variants.js';\nimport { setCurrentViewportBox } from './dom/projection/relative-set.js';\nimport { isDraggable } from './utils/is-draggable.js';\n\nvar visualElement = function (_a) {\n    var _b = _a.treeType, treeType = _b === void 0 ? \"\" : _b, build = _a.build, getBaseTarget = _a.getBaseTarget, makeTargetAnimatable = _a.makeTargetAnimatable, measureViewportBox = _a.measureViewportBox, renderInstance = _a.render, readValueFromInstance = _a.readValueFromInstance, resetTransform = _a.resetTransform, restoreTransform = _a.restoreTransform, removeValueFromRenderState = _a.removeValueFromRenderState, sortNodePosition = _a.sortNodePosition, scrapeMotionValuesFromProps = _a.scrapeMotionValuesFromProps;\n    return function (_a, options) {\n        var parent = _a.parent, props = _a.props, presenceId = _a.presenceId, blockInitialAnimation = _a.blockInitialAnimation, visualState = _a.visualState;\n        if (options === void 0) { options = {}; }\n        var latestValues = visualState.latestValues, renderState = visualState.renderState;\n        /**\n         * The instance of the render-specific node that will be hydrated by the\n         * exposed React ref. So for example, this visual element can host a\n         * HTMLElement, plain object, or Three.js object. The functions provided\n         * in VisualElementConfig allow us to interface with this instance.\n         */\n        var instance;\n        /**\n         * Manages the subscriptions for a visual element's lifecycle, for instance\n         * onRender and onViewportBoxUpdate.\n         */\n        var lifecycles = createLifecycles();\n        /**\n         *\n         */\n        var projection = createProjectionState();\n        /**\n         * A reference to the nearest projecting parent. This is either\n         * undefined if we haven't looked for the nearest projecting parent,\n         * false if there is no parent performing layout projection, or a reference\n         * to the projecting parent.\n         */\n        var projectionParent;\n        /**\n         * This is a reference to the visual state of the \"lead\" visual element.\n         * Usually, this will be this visual element. But if it shares a layoutId\n         * with other visual elements, only one of them will be designated lead by\n         * AnimateSharedLayout. All the other visual elements will take on the visual\n         * appearance of the lead while they crossfade to it.\n         */\n        var leadProjection = projection;\n        var leadLatestValues = latestValues;\n        var unsubscribeFromLeadVisualElement;\n        /**\n         * The latest layout measurements and calculated projections. This\n         * is seperate from the target projection data in visualState as\n         * many visual elements might point to the same piece of visualState as\n         * a target, whereas they might each have different layouts and thus\n         * projection calculations needed to project into the same viewport box.\n         */\n        var layoutState = createLayoutState();\n        /**\n         *\n         */\n        var crossfader;\n        /**\n         * Keep track of whether the viewport box has been updated since the\n         * last time the layout projection was re-calculated.\n         */\n        var hasViewportBoxUpdated = false;\n        /**\n         * A map of all motion values attached to this visual element. Motion\n         * values are source of truth for any given animated value. A motion\n         * value might be provided externally by the component via props.\n         */\n        var values = new Map();\n        /**\n         * A map of every subscription that binds the provided or generated\n         * motion values onChange listeners to this visual element.\n         */\n        var valueSubscriptions = new Map();\n        /**\n         * A reference to the previously-provided motion values as returned\n         * from scrapeMotionValuesFromProps. We use the keys in here to determine\n         * if any motion values need to be removed after props are updated.\n         */\n        var prevMotionValues = {};\n        /**\n         * x/y motion values that track the progress of initiated layout\n         * animations.\n         *\n         * TODO: Target for removal\n         */\n        var projectionTargetProgress;\n        /**\n         * When values are removed from all animation props we need to search\n         * for a fallback value to animate to. These values are tracked in baseTarget.\n         */\n        var baseTarget = __assign({}, latestValues);\n        // Internal methods ========================\n        /**\n         * On mount, this will be hydrated with a callback to disconnect\n         * this visual element from its parent on unmount.\n         */\n        var removeFromVariantTree;\n        /**\n         *\n         */\n        function render() {\n            if (!instance)\n                return;\n            if (element.isProjectionReady()) {\n                /**\n                 * Apply the latest user-set transforms to the targetBox to produce the targetBoxFinal.\n                 * This is the final box that we will then project into by calculating a transform delta and\n                 * applying it to the corrected box.\n                 */\n                applyBoxTransforms(leadProjection.targetFinal, leadProjection.target, leadLatestValues);\n                /**\n                 * Update the delta between the corrected box and the final target box, after\n                 * user-set transforms are applied to it. This will be used by the renderer to\n                 * create a transform style that will reproject the element from its actual layout\n                 * into the desired bounding box.\n                 */\n                updateBoxDelta(layoutState.deltaFinal, layoutState.layoutCorrected, leadProjection.targetFinal, latestValues);\n            }\n            triggerBuild();\n            renderInstance(instance, renderState);\n        }\n        function triggerBuild() {\n            var valuesToRender = latestValues;\n            if (crossfader && crossfader.isActive()) {\n                var crossfadedValues = crossfader.getCrossfadeState(element);\n                if (crossfadedValues)\n                    valuesToRender = crossfadedValues;\n            }\n            build(element, renderState, valuesToRender, leadProjection, layoutState, options, props);\n        }\n        function update() {\n            lifecycles.notifyUpdate(latestValues);\n        }\n        function updateLayoutProjection() {\n            if (!element.isProjectionReady())\n                return;\n            var delta = layoutState.delta, treeScale = layoutState.treeScale;\n            var prevTreeScaleX = treeScale.x;\n            var prevTreeScaleY = treeScale.y;\n            var prevDeltaTransform = layoutState.deltaTransform;\n            updateLayoutDeltas(layoutState, leadProjection, element.path, latestValues);\n            hasViewportBoxUpdated &&\n                element.notifyViewportBoxUpdate(leadProjection.target, delta);\n            hasViewportBoxUpdated = false;\n            var deltaTransform = buildLayoutProjectionTransform(delta, treeScale);\n            if (deltaTransform !== prevDeltaTransform ||\n                // Also compare calculated treeScale, for values that rely on this only for scale correction\n                prevTreeScaleX !== treeScale.x ||\n                prevTreeScaleY !== treeScale.y) {\n                element.scheduleRender();\n            }\n            layoutState.deltaTransform = deltaTransform;\n        }\n        function updateTreeLayoutProjection() {\n            element.layoutTree.forEach(fireUpdateLayoutProjection);\n        }\n        /**\n         *\n         */\n        function bindToMotionValue(key, value) {\n            var removeOnChange = value.onChange(function (latestValue) {\n                latestValues[key] = latestValue;\n                props.onUpdate && sync.update(update, false, true);\n            });\n            var removeOnRenderRequest = value.onRenderRequest(element.scheduleRender);\n            valueSubscriptions.set(key, function () {\n                removeOnChange();\n                removeOnRenderRequest();\n            });\n        }\n        /**\n         * Any motion values that are provided to the element when created\n         * aren't yet bound to the element, as this would technically be impure.\n         * However, we iterate through the motion values and set them to the\n         * initial values for this component.\n         *\n         * TODO: This is impure and we should look at changing this to run on mount.\n         * Doing so will break some tests but this isn't neccessarily a breaking change,\n         * more a reflection of the test.\n         */\n        var initialMotionValues = scrapeMotionValuesFromProps(props);\n        for (var key in initialMotionValues) {\n            var value = initialMotionValues[key];\n            if (latestValues[key] !== undefined && isMotionValue(value)) {\n                value.set(latestValues[key], false);\n            }\n        }\n        /**\n         * Determine what role this visual element should take in the variant tree.\n         */\n        var isControllingVariants = checkIfControllingVariants(props);\n        var isVariantNode = checkIfVariantNode(props);\n        var element = __assign(__assign({ treeType: treeType, \n            /**\n             * This is a mirror of the internal instance prop, which keeps\n             * VisualElement type-compatible with React's RefObject.\n             */\n            current: null, \n            /**\n             * The depth of this visual element within the visual element tree.\n             */\n            depth: parent ? parent.depth + 1 : 0, parent: parent, children: new Set(), \n            /**\n             * An ancestor path back to the root visual element. This is used\n             * by layout projection to quickly recurse back up the tree.\n             */\n            path: parent ? __spreadArray(__spreadArray([], __read(parent.path)), [parent]) : [], layoutTree: parent ? parent.layoutTree : new FlatTree(), \n            /**\n             *\n             */\n            presenceId: presenceId,\n            projection: projection, \n            /**\n             * If this component is part of the variant tree, it should track\n             * any children that are also part of the tree. This is essentially\n             * a shadow tree to simplify logic around how to stagger over children.\n             */\n            variantChildren: isVariantNode ? new Set() : undefined, \n            /**\n             * Whether this instance is visible. This can be changed imperatively\n             * by AnimateSharedLayout, is analogous to CSS's visibility in that\n             * hidden elements should take up layout, and needs enacting by the configured\n             * render function.\n             */\n            isVisible: undefined, \n            /**\n             * Normally, if a component is controlled by a parent's variants, it can\n             * rely on that ancestor to trigger animations further down the tree.\n             * However, if a component is created after its parent is mounted, the parent\n             * won't trigger that mount animation so the child needs to.\n             *\n             * TODO: This might be better replaced with a method isParentMounted\n             */\n            manuallyAnimateOnMount: Boolean(parent === null || parent === void 0 ? void 0 : parent.isMounted()), \n            /**\n             * This can be set by AnimatePresence to force components that mount\n             * at the same time as it to mount as if they have initial={false} set.\n             */\n            blockInitialAnimation: blockInitialAnimation, \n            /**\n             * Determine whether this component has mounted yet. This is mostly used\n             * by variant children to determine whether they need to trigger their\n             * own animations on mount.\n             */\n            isMounted: function () { return Boolean(instance); }, mount: function (newInstance) {\n                instance = element.current = newInstance;\n                element.pointTo(element);\n                if (isVariantNode && parent && !isControllingVariants) {\n                    removeFromVariantTree = parent === null || parent === void 0 ? void 0 : parent.addVariantChild(element);\n                }\n                parent === null || parent === void 0 ? void 0 : parent.children.add(element);\n            },\n            /**\n             *\n             */\n            unmount: function () {\n                cancelSync.update(update);\n                cancelSync.render(render);\n                cancelSync.preRender(element.updateLayoutProjection);\n                valueSubscriptions.forEach(function (remove) { return remove(); });\n                element.stopLayoutAnimation();\n                element.layoutTree.remove(element);\n                removeFromVariantTree === null || removeFromVariantTree === void 0 ? void 0 : removeFromVariantTree();\n                parent === null || parent === void 0 ? void 0 : parent.children.delete(element);\n                unsubscribeFromLeadVisualElement === null || unsubscribeFromLeadVisualElement === void 0 ? void 0 : unsubscribeFromLeadVisualElement();\n                lifecycles.clearAllListeners();\n            },\n            /**\n             * Add a child visual element to our set of children.\n             */\n            addVariantChild: function (child) {\n                var _a;\n                var closestVariantNode = element.getClosestVariantNode();\n                if (closestVariantNode) {\n                    (_a = closestVariantNode.variantChildren) === null || _a === void 0 ? void 0 : _a.add(child);\n                    return function () { return closestVariantNode.variantChildren.delete(child); };\n                }\n            },\n            sortNodePosition: function (other) {\n                /**\n                 * If these nodes aren't even of the same type we can't compare their depth.\n                 */\n                if (!sortNodePosition || treeType !== other.treeType)\n                    return 0;\n                return sortNodePosition(element.getInstance(), other.getInstance());\n            }, \n            /**\n             * Returns the closest variant node in the tree starting from\n             * this visual element.\n             */\n            getClosestVariantNode: function () {\n                return isVariantNode ? element : parent === null || parent === void 0 ? void 0 : parent.getClosestVariantNode();\n            }, \n            /**\n             * A method that schedules an update to layout projections throughout\n             * the tree. We inherit from the parent so there's only ever one\n             * job scheduled on the next frame - that of the root visual element.\n             */\n            scheduleUpdateLayoutProjection: parent\n                ? parent.scheduleUpdateLayoutProjection\n                : function () {\n                    return sync.preRender(element.updateTreeLayoutProjection, false, true);\n                }, \n            /**\n             * Expose the latest layoutId prop.\n             */\n            getLayoutId: function () { return props.layoutId; }, \n            /**\n             * Returns the current instance.\n             */\n            getInstance: function () { return instance; }, \n            /**\n             * Get/set the latest static values.\n             */\n            getStaticValue: function (key) { return latestValues[key]; }, setStaticValue: function (key, value) { return (latestValues[key] = value); }, \n            /**\n             * Returns the latest motion value state. Currently only used to take\n             * a snapshot of the visual element - perhaps this can return the whole\n             * visual state\n             */\n            getLatestValues: function () { return latestValues; }, \n            /**\n             * Set the visiblity of the visual element. If it's changed, schedule\n             * a render to reflect these changes.\n             */\n            setVisibility: function (visibility) {\n                if (element.isVisible === visibility)\n                    return;\n                element.isVisible = visibility;\n                element.scheduleRender();\n            },\n            /**\n             * Make a target animatable by Popmotion. For instance, if we're\n             * trying to animate width from 100px to 100vw we need to measure 100vw\n             * in pixels to determine what we really need to animate to. This is also\n             * pluggable to support Framer's custom value types like Color,\n             * and CSS variables.\n             */\n            makeTargetAnimatable: function (target, canMutate) {\n                if (canMutate === void 0) { canMutate = true; }\n                return makeTargetAnimatable(element, target, props, canMutate);\n            },\n            // Motion values ========================\n            /**\n             * Add a motion value and bind it to this visual element.\n             */\n            addValue: function (key, value) {\n                // Remove existing value if it exists\n                if (element.hasValue(key))\n                    element.removeValue(key);\n                values.set(key, value);\n                latestValues[key] = value.get();\n                bindToMotionValue(key, value);\n            },\n            /**\n             * Remove a motion value and unbind any active subscriptions.\n             */\n            removeValue: function (key) {\n                var _a;\n                values.delete(key);\n                (_a = valueSubscriptions.get(key)) === null || _a === void 0 ? void 0 : _a();\n                valueSubscriptions.delete(key);\n                delete latestValues[key];\n                removeValueFromRenderState(key, renderState);\n            }, \n            /**\n             * Check whether we have a motion value for this key\n             */\n            hasValue: function (key) { return values.has(key); }, \n            /**\n             * Get a motion value for this key. If called with a default\n             * value, we'll create one if none exists.\n             */\n            getValue: function (key, defaultValue) {\n                var value = values.get(key);\n                if (value === undefined && defaultValue !== undefined) {\n                    value = motionValue(defaultValue);\n                    element.addValue(key, value);\n                }\n                return value;\n            }, \n            /**\n             * Iterate over our motion values.\n             */\n            forEachValue: function (callback) { return values.forEach(callback); }, \n            /**\n             * If we're trying to animate to a previously unencountered value,\n             * we need to check for it in our state and as a last resort read it\n             * directly from the instance (which might have performance implications).\n             */\n            readValue: function (key) { var _a; return (_a = latestValues[key]) !== null && _a !== void 0 ? _a : readValueFromInstance(instance, key, options); }, \n            /**\n             * Set the base target to later animate back to. This is currently\n             * only hydrated on creation and when we first read a value.\n             */\n            setBaseTarget: function (key, value) {\n                baseTarget[key] = value;\n            },\n            /**\n             * Find the base target for a value thats been removed from all animation\n             * props.\n             */\n            getBaseTarget: function (key) {\n                if (getBaseTarget) {\n                    var target = getBaseTarget(props, key);\n                    if (target !== undefined && !isMotionValue(target))\n                        return target;\n                }\n                return baseTarget[key];\n            } }, lifecycles), { \n            /**\n             * Build the renderer state based on the latest visual state.\n             */\n            build: function () {\n                triggerBuild();\n                return renderState;\n            },\n            /**\n             * Schedule a render on the next animation frame.\n             */\n            scheduleRender: function () {\n                sync.render(render, false, true);\n            }, \n            /**\n             * Synchronously fire render. It's prefered that we batch renders but\n             * in many circumstances, like layout measurement, we need to run this\n             * synchronously. However in those instances other measures should be taken\n             * to batch reads/writes.\n             */\n            syncRender: render, \n            /**\n             * Update the provided props. Ensure any newly-added motion values are\n             * added to our map, old ones removed, and listeners updated.\n             */\n            setProps: function (newProps) {\n                props = newProps;\n                lifecycles.updatePropListeners(newProps);\n                prevMotionValues = updateMotionValuesFromProps(element, scrapeMotionValuesFromProps(props), prevMotionValues);\n            }, getProps: function () { return props; }, \n            // Variants ==============================\n            /**\n             * Returns the variant definition with a given name.\n             */\n            getVariant: function (name) { var _a; return (_a = props.variants) === null || _a === void 0 ? void 0 : _a[name]; }, \n            /**\n             * Returns the defined default transition on this component.\n             */\n            getDefaultTransition: function () { return props.transition; }, \n            /**\n             * Used by child variant nodes to get the closest ancestor variant props.\n             */\n            getVariantContext: function (startAtParent) {\n                if (startAtParent === void 0) { startAtParent = false; }\n                if (startAtParent)\n                    return parent === null || parent === void 0 ? void 0 : parent.getVariantContext();\n                if (!isControllingVariants) {\n                    var context_1 = (parent === null || parent === void 0 ? void 0 : parent.getVariantContext()) || {};\n                    if (props.initial !== undefined) {\n                        context_1.initial = props.initial;\n                    }\n                    return context_1;\n                }\n                var context = {};\n                for (var i = 0; i < numVariantProps; i++) {\n                    var name_1 = variantProps[i];\n                    var prop = props[name_1];\n                    if (isVariantLabel(prop) || prop === false) {\n                        context[name_1] = prop;\n                    }\n                }\n                return context;\n            },\n            // Layout projection ==============================\n            /**\n             * Enable layout projection for this visual element. Won't actually\n             * occur until we also have hydrated layout measurements.\n             */\n            enableLayoutProjection: function () {\n                projection.isEnabled = true;\n                element.layoutTree.add(element);\n            },\n            /**\n             * Lock the projection target, for instance when dragging, so\n             * nothing else can try and animate it.\n             */\n            lockProjectionTarget: function () {\n                projection.isTargetLocked = true;\n            },\n            unlockProjectionTarget: function () {\n                element.stopLayoutAnimation();\n                projection.isTargetLocked = false;\n            }, getLayoutState: function () { return layoutState; }, setCrossfader: function (newCrossfader) {\n                crossfader = newCrossfader;\n            }, isProjectionReady: function () {\n                return projection.isEnabled &&\n                    projection.isHydrated &&\n                    layoutState.isHydrated;\n            }, \n            /**\n             * Start a layout animation on a given axis.\n             */\n            startLayoutAnimation: function (axis, transition, isRelative) {\n                if (isRelative === void 0) { isRelative = false; }\n                var progress = element.getProjectionAnimationProgress()[axis];\n                var _a = isRelative\n                    ? projection.relativeTarget[axis]\n                    : projection.target[axis], min = _a.min, max = _a.max;\n                var length = max - min;\n                progress.clearListeners();\n                progress.set(min);\n                progress.set(min); // Set twice to hard-reset velocity\n                progress.onChange(function (v) {\n                    element.setProjectionTargetAxis(axis, v, v + length, isRelative);\n                });\n                return element.animateMotionValue(axis, progress, 0, transition);\n            },\n            /**\n             * Stop layout animations.\n             */\n            stopLayoutAnimation: function () {\n                eachAxis(function (axis) {\n                    return element.getProjectionAnimationProgress()[axis].stop();\n                });\n            },\n            /**\n             * Measure the current viewport box with or without transforms.\n             * Only measures axis-aligned boxes, rotate and skew must be manually\n             * removed with a re-render to work.\n             */\n            measureViewportBox: function (withTransform) {\n                if (withTransform === void 0) { withTransform = true; }\n                var viewportBox = measureViewportBox(instance, options);\n                if (!withTransform)\n                    removeBoxTransforms(viewportBox, latestValues);\n                return viewportBox;\n            },\n            /**\n             * Get the motion values tracking the layout animations on each\n             * axis. Lazy init if not already created.\n             */\n            getProjectionAnimationProgress: function () {\n                projectionTargetProgress || (projectionTargetProgress = {\n                    x: motionValue(0),\n                    y: motionValue(0),\n                });\n                return projectionTargetProgress;\n            },\n            /**\n             * Update the projection of a single axis. Schedule an update to\n             * the tree layout projection.\n             */\n            setProjectionTargetAxis: function (axis, min, max, isRelative) {\n                if (isRelative === void 0) { isRelative = false; }\n                var target;\n                if (isRelative) {\n                    if (!projection.relativeTarget) {\n                        projection.relativeTarget = axisBox();\n                    }\n                    target = projection.relativeTarget[axis];\n                }\n                else {\n                    projection.relativeTarget = undefined;\n                    target = projection.target[axis];\n                }\n                projection.isHydrated = true;\n                target.min = min;\n                target.max = max;\n                // Flag that we want to fire the onViewportBoxUpdate event handler\n                hasViewportBoxUpdated = true;\n                lifecycles.notifySetAxisTarget();\n            },\n            /**\n             * Rebase the projection target on top of the provided viewport box\n             * or the measured layout. This ensures that non-animating elements\n             * don't fall out of sync differences in measurements vs projections\n             * after a page scroll or other relayout.\n             */\n            rebaseProjectionTarget: function (force, box) {\n                if (box === void 0) { box = layoutState.layout; }\n                var _a = element.getProjectionAnimationProgress(), x = _a.x, y = _a.y;\n                var shouldRebase = !projection.relativeTarget &&\n                    !projection.isTargetLocked &&\n                    !x.isAnimating() &&\n                    !y.isAnimating();\n                if (force || shouldRebase) {\n                    eachAxis(function (axis) {\n                        var _a = box[axis], min = _a.min, max = _a.max;\n                        element.setProjectionTargetAxis(axis, min, max);\n                    });\n                }\n            },\n            /**\n             * Notify the visual element that its layout is up-to-date.\n             * Currently Animate.tsx uses this to check whether a layout animation\n             * needs to be performed.\n             */\n            notifyLayoutReady: function (config) {\n                setCurrentViewportBox(element);\n                element.notifyLayoutUpdate(layoutState.layout, element.prevViewportBox || layoutState.layout, config);\n            }, \n            /**\n             * Temporarily reset the transform of the instance.\n             */\n            resetTransform: function () { return resetTransform(element, instance, props); }, restoreTransform: function () { return restoreTransform(instance, renderState); }, updateLayoutProjection: updateLayoutProjection,\n            updateTreeLayoutProjection: function () {\n                element.layoutTree.forEach(fireResolveRelativeTargetBox);\n                /**\n                 * Schedule the projection updates at the end of the current preRender\n                 * step. This will ensure that all layout trees will first resolve\n                 * relative projection boxes into viewport boxes, and *then*\n                 * update projections.\n                 */\n                sync.preRender(updateTreeLayoutProjection, false, true);\n                // sync.postRender(() => element.scheduleUpdateLayoutProjection())\n            },\n            getProjectionParent: function () {\n                if (projectionParent === undefined) {\n                    var foundParent = false;\n                    // Search backwards through the tree path\n                    for (var i = element.path.length - 1; i >= 0; i--) {\n                        var ancestor = element.path[i];\n                        if (ancestor.projection.isEnabled) {\n                            foundParent = ancestor;\n                            break;\n                        }\n                    }\n                    projectionParent = foundParent;\n                }\n                return projectionParent;\n            },\n            resolveRelativeTargetBox: function () {\n                var relativeParent = element.getProjectionParent();\n                if (!projection.relativeTarget || !relativeParent)\n                    return;\n                calcRelativeBox(projection, relativeParent.projection);\n                if (isDraggable(relativeParent)) {\n                    var target = projection.target;\n                    applyBoxTransforms(target, target, relativeParent.getLatestValues());\n                }\n            },\n            shouldResetTransform: function () {\n                return Boolean(props._layoutResetTransform);\n            },\n            /**\n             *\n             */\n            pointTo: function (newLead) {\n                leadProjection = newLead.projection;\n                leadLatestValues = newLead.getLatestValues();\n                /**\n                 * Subscribe to lead component's layout animations\n                 */\n                unsubscribeFromLeadVisualElement === null || unsubscribeFromLeadVisualElement === void 0 ? void 0 : unsubscribeFromLeadVisualElement();\n                unsubscribeFromLeadVisualElement = pipe(newLead.onSetAxisTarget(element.scheduleUpdateLayoutProjection), newLead.onLayoutAnimationComplete(function () {\n                    var _a;\n                    if (element.isPresent) {\n                        element.presence = Presence.Present;\n                    }\n                    else {\n                        (_a = element.layoutSafeToRemove) === null || _a === void 0 ? void 0 : _a.call(element);\n                    }\n                }));\n            }, \n            // TODO: Clean this up\n            isPresent: true, presence: Presence.Entering });\n        return element;\n    };\n};\nfunction fireResolveRelativeTargetBox(child) {\n    child.resolveRelativeTargetBox();\n}\nfunction fireUpdateLayoutProjection(child) {\n    child.updateLayoutProjection();\n}\nvar variantProps = __spreadArray([\"initial\"], __read(variantPriorityOrder));\nvar numVariantProps = variantProps.length;\n\nexport { visualElement };\n","import { motionValue } from '../../value/index.js';\nimport { isMotionValue } from '../../value/utils/is-motion-value.js';\n\nfunction updateMotionValuesFromProps(element, next, prev) {\n    var _a;\n    for (var key in next) {\n        var nextValue = next[key];\n        var prevValue = prev[key];\n        if (isMotionValue(nextValue)) {\n            /**\n             * If this is a motion value found in props or style, we want to add it\n             * to our visual element's motion value map.\n             */\n            element.addValue(key, nextValue);\n        }\n        else if (isMotionValue(prevValue)) {\n            /**\n             * If we're swapping to a new motion value, create a new motion value\n             * from that\n             */\n            element.addValue(key, motionValue(nextValue));\n        }\n        else if (prevValue !== nextValue) {\n            /**\n             * If this is a flat value that has changed, update the motion value\n             * or create one if it doesn't exist. We only want to do this if we're\n             * not handling the value with our animation state.\n             */\n            if (element.hasValue(key)) {\n                var existingValue = element.getValue(key);\n                // TODO: Only update values that aren't being animated or even looked at\n                !existingValue.hasAnimated && existingValue.set(nextValue);\n            }\n            else {\n                element.addValue(key, motionValue((_a = element.getStaticValue(key)) !== null && _a !== void 0 ? _a : nextValue));\n            }\n        }\n    }\n    // Handle removed values\n    for (var key in prev) {\n        if (next[key] === undefined)\n            element.removeValue(key);\n    }\n    return next;\n}\n\nexport { updateMotionValuesFromProps };\n","import { convertBoundingBoxToAxisBox, transformBoundingBox } from '../../../utils/geometry/index.js';\n\n/**\n * Measure and return the element bounding box.\n *\n * We convert the box into an AxisBox2D to make it easier to work with each axis\n * individually and programmatically.\n *\n * This function optionally accepts a transformPagePoint function which allows us to compensate\n * for, for instance, measuring the element within a scaled plane like a Framer devivce preview component.\n */\nfunction getBoundingBox(element, transformPagePoint) {\n    var box = element.getBoundingClientRect();\n    return convertBoundingBoxToAxisBox(transformBoundingBox(box, transformPagePoint));\n}\n\nexport { getBoundingBox };\n","import { __rest, __assign, __read } from 'tslib';\nimport { invariant } from 'hey-listen';\n\nfunction isCSSVariable(value) {\n    return typeof value === \"string\" && value.startsWith(\"var(--\");\n}\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\nvar cssVariableRegex = /var\\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\\)/;\nfunction parseCSSVariable(current) {\n    var match = cssVariableRegex.exec(current);\n    if (!match)\n        return [,];\n    var _a = __read(match, 3), token = _a[1], fallback = _a[2];\n    return [token, fallback];\n}\nvar maxDepth = 4;\nfunction getVariableValue(current, element, depth) {\n    if (depth === void 0) { depth = 1; }\n    invariant(depth <= maxDepth, \"Max CSS variable fallback depth detected in property \\\"\" + current + \"\\\". This may indicate a circular fallback dependency.\");\n    var _a = __read(parseCSSVariable(current), 2), token = _a[0], fallback = _a[1];\n    // No CSS variable detected\n    if (!token)\n        return;\n    // Attempt to read this CSS variable off the element\n    var resolved = window.getComputedStyle(element).getPropertyValue(token);\n    if (resolved) {\n        return resolved.trim();\n    }\n    else if (isCSSVariable(fallback)) {\n        // The fallback might itself be a CSS variable, in which case we attempt to resolve it too.\n        return getVariableValue(fallback, element, depth + 1);\n    }\n    else {\n        return fallback;\n    }\n}\n/**\n * Resolve CSS variables from\n *\n * @internal\n */\nfunction resolveCSSVariables(visualElement, _a, transitionEnd) {\n    var _b;\n    var target = __rest(_a, []);\n    var element = visualElement.getInstance();\n    if (!(element instanceof HTMLElement))\n        return { target: target, transitionEnd: transitionEnd };\n    // If `transitionEnd` isn't `undefined`, clone it. We could clone `target` and `transitionEnd`\n    // only if they change but I think this reads clearer and this isn't a performance-critical path.\n    if (transitionEnd) {\n        transitionEnd = __assign({}, transitionEnd);\n    }\n    // Go through existing `MotionValue`s and ensure any existing CSS variables are resolved\n    visualElement.forEachValue(function (value) {\n        var current = value.get();\n        if (!isCSSVariable(current))\n            return;\n        var resolved = getVariableValue(current, element);\n        if (resolved)\n            value.set(resolved);\n    });\n    // Cycle through every target property and resolve CSS variables. Currently\n    // we only read single-var properties like `var(--foo)`, not `calc(var(--foo) + 20px)`\n    for (var key in target) {\n        var current = target[key];\n        if (!isCSSVariable(current))\n            continue;\n        var resolved = getVariableValue(current, element);\n        if (!resolved)\n            continue;\n        // Clone target if it hasn't already been\n        target[key] = resolved;\n        // If the user hasn't already set this key on `transitionEnd`, set it to the unresolved\n        // CSS variable. This will ensure that after the animation the component will reflect\n        // changes in the value of the CSS variable.\n        if (transitionEnd)\n            (_b = transitionEnd[key]) !== null && _b !== void 0 ? _b : (transitionEnd[key] = current);\n    }\n    return { target: target, transitionEnd: transitionEnd };\n}\n\nexport { cssVariableRegex, parseCSSVariable, resolveCSSVariables };\n","import { __assign, __read } from 'tslib';\nimport { number, px } from 'style-value-types';\nimport { isKeyframesTarget } from '../../../animation/utils/is-keyframes-target.js';\nimport { invariant } from 'hey-listen';\nimport { transformProps } from '../../html/utils/transform.js';\nimport { findDimensionValueType } from '../value-types/dimensions.js';\n\nvar positionalKeys = new Set([\n    \"width\",\n    \"height\",\n    \"top\",\n    \"left\",\n    \"right\",\n    \"bottom\",\n    \"x\",\n    \"y\",\n]);\nvar isPositionalKey = function (key) { return positionalKeys.has(key); };\nvar hasPositionalKey = function (target) {\n    return Object.keys(target).some(isPositionalKey);\n};\nvar setAndResetVelocity = function (value, to) {\n    // Looks odd but setting it twice doesn't render, it'll just\n    // set both prev and current to the latest value\n    value.set(to, false);\n    value.set(to);\n};\nvar isNumOrPxType = function (v) {\n    return v === number || v === px;\n};\nvar BoundingBoxDimension;\n(function (BoundingBoxDimension) {\n    BoundingBoxDimension[\"width\"] = \"width\";\n    BoundingBoxDimension[\"height\"] = \"height\";\n    BoundingBoxDimension[\"left\"] = \"left\";\n    BoundingBoxDimension[\"right\"] = \"right\";\n    BoundingBoxDimension[\"top\"] = \"top\";\n    BoundingBoxDimension[\"bottom\"] = \"bottom\";\n})(BoundingBoxDimension || (BoundingBoxDimension = {}));\nvar getPosFromMatrix = function (matrix, pos) {\n    return parseFloat(matrix.split(\", \")[pos]);\n};\nvar getTranslateFromMatrix = function (pos2, pos3) { return function (_bbox, _a) {\n    var transform = _a.transform;\n    if (transform === \"none\" || !transform)\n        return 0;\n    var matrix3d = transform.match(/^matrix3d\\((.+)\\)$/);\n    if (matrix3d) {\n        return getPosFromMatrix(matrix3d[1], pos3);\n    }\n    else {\n        var matrix = transform.match(/^matrix\\((.+)\\)$/);\n        if (matrix) {\n            return getPosFromMatrix(matrix[1], pos2);\n        }\n        else {\n            return 0;\n        }\n    }\n}; };\nvar transformKeys = new Set([\"x\", \"y\", \"z\"]);\nvar nonTranslationalTransformKeys = transformProps.filter(function (key) { return !transformKeys.has(key); });\nfunction removeNonTranslationalTransform(visualElement) {\n    var removedTransforms = [];\n    nonTranslationalTransformKeys.forEach(function (key) {\n        var value = visualElement.getValue(key);\n        if (value !== undefined) {\n            removedTransforms.push([key, value.get()]);\n            value.set(key.startsWith(\"scale\") ? 1 : 0);\n        }\n    });\n    // Apply changes to element before measurement\n    if (removedTransforms.length)\n        visualElement.syncRender();\n    return removedTransforms;\n}\nvar positionalValues = {\n    // Dimensions\n    width: function (_a) {\n        var x = _a.x;\n        return x.max - x.min;\n    },\n    height: function (_a) {\n        var y = _a.y;\n        return y.max - y.min;\n    },\n    top: function (_bbox, _a) {\n        var top = _a.top;\n        return parseFloat(top);\n    },\n    left: function (_bbox, _a) {\n        var left = _a.left;\n        return parseFloat(left);\n    },\n    bottom: function (_a, _b) {\n        var y = _a.y;\n        var top = _b.top;\n        return parseFloat(top) + (y.max - y.min);\n    },\n    right: function (_a, _b) {\n        var x = _a.x;\n        var left = _b.left;\n        return parseFloat(left) + (x.max - x.min);\n    },\n    // Transform\n    x: getTranslateFromMatrix(4, 13),\n    y: getTranslateFromMatrix(5, 14),\n};\nvar convertChangedValueTypes = function (target, visualElement, changedKeys) {\n    var originBbox = visualElement.measureViewportBox();\n    var element = visualElement.getInstance();\n    var elementComputedStyle = getComputedStyle(element);\n    var display = elementComputedStyle.display, top = elementComputedStyle.top, left = elementComputedStyle.left, bottom = elementComputedStyle.bottom, right = elementComputedStyle.right, transform = elementComputedStyle.transform;\n    var originComputedStyle = { top: top, left: left, bottom: bottom, right: right, transform: transform };\n    // If the element is currently set to display: \"none\", make it visible before\n    // measuring the target bounding box\n    if (display === \"none\") {\n        visualElement.setStaticValue(\"display\", target.display || \"block\");\n    }\n    // Apply the latest values (as set in checkAndConvertChangedValueTypes)\n    visualElement.syncRender();\n    var targetBbox = visualElement.measureViewportBox();\n    changedKeys.forEach(function (key) {\n        // Restore styles to their **calculated computed style**, not their actual\n        // originally set style. This allows us to animate between equivalent pixel units.\n        var value = visualElement.getValue(key);\n        setAndResetVelocity(value, positionalValues[key](originBbox, originComputedStyle));\n        target[key] = positionalValues[key](targetBbox, elementComputedStyle);\n    });\n    return target;\n};\nvar checkAndConvertChangedValueTypes = function (visualElement, target, origin, transitionEnd) {\n    if (origin === void 0) { origin = {}; }\n    if (transitionEnd === void 0) { transitionEnd = {}; }\n    target = __assign({}, target);\n    transitionEnd = __assign({}, transitionEnd);\n    var targetPositionalKeys = Object.keys(target).filter(isPositionalKey);\n    // We want to remove any transform values that could affect the element's bounding box before\n    // it's measured. We'll reapply these later.\n    var removedTransformValues = [];\n    var hasAttemptedToRemoveTransformValues = false;\n    var changedValueTypeKeys = [];\n    targetPositionalKeys.forEach(function (key) {\n        var value = visualElement.getValue(key);\n        if (!visualElement.hasValue(key))\n            return;\n        var from = origin[key];\n        var to = target[key];\n        var fromType = findDimensionValueType(from);\n        var toType;\n        // TODO: The current implementation of this basically throws an error\n        // if you try and do value conversion via keyframes. There's probably\n        // a way of doing this but the performance implications would need greater scrutiny,\n        // as it'd be doing multiple resize-remeasure operations.\n        if (isKeyframesTarget(to)) {\n            var numKeyframes = to.length;\n            for (var i = to[0] === null ? 1 : 0; i < numKeyframes; i++) {\n                if (!toType) {\n                    toType = findDimensionValueType(to[i]);\n                    invariant(toType === fromType ||\n                        (isNumOrPxType(fromType) && isNumOrPxType(toType)), \"Keyframes must be of the same dimension as the current value\");\n                }\n                else {\n                    invariant(findDimensionValueType(to[i]) === toType, \"All keyframes must be of the same type\");\n                }\n            }\n        }\n        else {\n            toType = findDimensionValueType(to);\n        }\n        if (fromType !== toType) {\n            // If they're both just number or px, convert them both to numbers rather than\n            // relying on resize/remeasure to convert (which is wasteful in this situation)\n            if (isNumOrPxType(fromType) && isNumOrPxType(toType)) {\n                var current = value.get();\n                if (typeof current === \"string\") {\n                    value.set(parseFloat(current));\n                }\n                if (typeof to === \"string\") {\n                    target[key] = parseFloat(to);\n                }\n                else if (Array.isArray(to) && toType === px) {\n                    target[key] = to.map(parseFloat);\n                }\n            }\n            else if ((fromType === null || fromType === void 0 ? void 0 : fromType.transform) &&\n                (toType === null || toType === void 0 ? void 0 : toType.transform) &&\n                (from === 0 || to === 0)) {\n                // If one or the other value is 0, it's safe to coerce it to the\n                // type of the other without measurement\n                if (from === 0) {\n                    value.set(toType.transform(from));\n                }\n                else {\n                    target[key] = fromType.transform(to);\n                }\n            }\n            else {\n                // If we're going to do value conversion via DOM measurements, we first\n                // need to remove non-positional transform values that could affect the bbox measurements.\n                if (!hasAttemptedToRemoveTransformValues) {\n                    removedTransformValues = removeNonTranslationalTransform(visualElement);\n                    hasAttemptedToRemoveTransformValues = true;\n                }\n                changedValueTypeKeys.push(key);\n                transitionEnd[key] =\n                    transitionEnd[key] !== undefined\n                        ? transitionEnd[key]\n                        : target[key];\n                setAndResetVelocity(value, to);\n            }\n        }\n    });\n    if (changedValueTypeKeys.length) {\n        var convertedTarget = convertChangedValueTypes(target, visualElement, changedValueTypeKeys);\n        // If we removed transform values, reapply them before the next render\n        if (removedTransformValues.length) {\n            removedTransformValues.forEach(function (_a) {\n                var _b = __read(_a, 2), key = _b[0], value = _b[1];\n                visualElement.getValue(key).set(value);\n            });\n        }\n        // Reapply original values\n        visualElement.syncRender();\n        return { target: convertedTarget, transitionEnd: transitionEnd };\n    }\n    else {\n        return { target: target, transitionEnd: transitionEnd };\n    }\n};\n/**\n * Convert value types for x/y/width/height/top/left/bottom/right\n *\n * Allows animation between `'auto'` -> `'100%'` or `0` -> `'calc(50% - 10vw)'`\n *\n * @internal\n */\nfunction unitConversion(visualElement, target, origin, transitionEnd) {\n    return hasPositionalKey(target)\n        ? checkAndConvertChangedValueTypes(visualElement, target, origin, transitionEnd)\n        : { target: target, transitionEnd: transitionEnd };\n}\n\nexport { BoundingBoxDimension, unitConversion };\n","import { resolveCSSVariables } from './css-variables-conversion.js';\nimport { unitConversion } from './unit-conversion.js';\n\n/**\n * Parse a DOM variant to make it animatable. This involves resolving CSS variables\n * and ensuring animations like \"20%\" => \"calc(50vw)\" are performed in pixels.\n */\nvar parseDomVariant = function (visualElement, target, origin, transitionEnd) {\n    var resolved = resolveCSSVariables(visualElement, target, transitionEnd);\n    target = resolved.target;\n    transitionEnd = resolved.transitionEnd;\n    return unitConversion(visualElement, target, origin, transitionEnd);\n};\n\nexport { parseDomVariant };\n","import { __rest, __assign } from 'tslib';\nimport { visualElement } from '../index.js';\nimport { getOrigin, checkTargetForNewValues } from '../utils/setters.js';\nimport { getBoundingBox } from '../dom/projection/measure.js';\nimport { buildHTMLStyles } from './utils/build-styles.js';\nimport { isCSSVariable } from '../dom/utils/is-css-variable.js';\nimport { parseDomVariant } from '../dom/utils/parse-dom-variant.js';\nimport { isTransformProp } from './utils/transform.js';\nimport { scrapeMotionValuesFromProps } from './utils/scrape-motion-values.js';\nimport { renderHTML } from './utils/render.js';\nimport { getDefaultValueType } from '../dom/value-types/defaults.js';\nimport { buildLayoutProjectionTransformOrigin, buildLayoutProjectionTransform } from './utils/build-projection-transform.js';\n\nfunction getComputedStyle(element) {\n    return window.getComputedStyle(element);\n}\nvar htmlConfig = {\n    treeType: \"dom\",\n    readValueFromInstance: function (domElement, key) {\n        if (isTransformProp(key)) {\n            var defaultType = getDefaultValueType(key);\n            return defaultType ? defaultType.default || 0 : 0;\n        }\n        else {\n            var computedStyle = getComputedStyle(domElement);\n            return ((isCSSVariable(key)\n                ? computedStyle.getPropertyValue(key)\n                : computedStyle[key]) || 0);\n        }\n    },\n    sortNodePosition: function (a, b) {\n        /**\n         * compareDocumentPosition returns a bitmask, by using the bitwise &\n         * we're returning true if 2 in that bitmask is set to true. 2 is set\n         * to true if b preceeds a.\n         */\n        return a.compareDocumentPosition(b) & 2 ? 1 : -1;\n    },\n    getBaseTarget: function (props, key) {\n        var _a;\n        return (_a = props.style) === null || _a === void 0 ? void 0 : _a[key];\n    },\n    measureViewportBox: function (element, _a) {\n        var transformPagePoint = _a.transformPagePoint;\n        return getBoundingBox(element, transformPagePoint);\n    },\n    /**\n     * Reset the transform on the current Element. This is called as part\n     * of a batched process across the entire layout tree. To remove this write\n     * cycle it'd be interesting to see if it's possible to \"undo\" all the current\n     * layout transforms up the tree in the same way this.getBoundingBoxWithoutTransforms\n     * works\n     */\n    resetTransform: function (element, domElement, props) {\n        var transformTemplate = props.transformTemplate;\n        domElement.style.transform = transformTemplate\n            ? transformTemplate({}, \"\")\n            : \"none\";\n        // Ensure that whatever happens next, we restore our transform on the next frame\n        element.scheduleRender();\n    },\n    restoreTransform: function (instance, mutableState) {\n        instance.style.transform = mutableState.style.transform;\n    },\n    removeValueFromRenderState: function (key, _a) {\n        var vars = _a.vars, style = _a.style;\n        delete vars[key];\n        delete style[key];\n    },\n    /**\n     * Ensure that HTML and Framer-specific value types like `px`->`%` and `Color`\n     * can be animated by Motion.\n     */\n    makeTargetAnimatable: function (element, _a, _b, isMounted) {\n        var transformValues = _b.transformValues;\n        if (isMounted === void 0) { isMounted = true; }\n        var transition = _a.transition, transitionEnd = _a.transitionEnd, target = __rest(_a, [\"transition\", \"transitionEnd\"]);\n        var origin = getOrigin(target, transition || {}, element);\n        /**\n         * If Framer has provided a function to convert `Color` etc value types, convert them\n         */\n        if (transformValues) {\n            if (transitionEnd)\n                transitionEnd = transformValues(transitionEnd);\n            if (target)\n                target = transformValues(target);\n            if (origin)\n                origin = transformValues(origin);\n        }\n        if (isMounted) {\n            checkTargetForNewValues(element, target, origin);\n            var parsed = parseDomVariant(element, target, origin, transitionEnd);\n            transitionEnd = parsed.transitionEnd;\n            target = parsed.target;\n        }\n        return __assign({ transition: transition,\n            transitionEnd: transitionEnd }, target);\n    },\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n    build: function (element, renderState, latestValues, projection, layoutState, options, props) {\n        if (element.isVisible !== undefined) {\n            renderState.style.visibility = element.isVisible\n                ? \"visible\"\n                : \"hidden\";\n        }\n        var isProjectionTranform = projection.isEnabled && layoutState.isHydrated;\n        buildHTMLStyles(renderState, latestValues, projection, layoutState, options, props.transformTemplate, isProjectionTranform ? buildLayoutProjectionTransform : undefined, isProjectionTranform\n            ? buildLayoutProjectionTransformOrigin\n            : undefined);\n    },\n    render: renderHTML,\n};\nvar htmlVisualElement = visualElement(htmlConfig);\n\nexport { getComputedStyle, htmlConfig, htmlVisualElement };\n","import { __assign } from 'tslib';\nimport { visualElement } from '../index.js';\nimport { scrapeMotionValuesFromProps } from './utils/scrape-motion-values.js';\nimport { htmlConfig } from '../html/visual-element.js';\nimport { buildSVGAttrs } from './utils/build-attrs.js';\nimport { camelToDash } from '../dom/utils/camel-to-dash.js';\nimport { camelCaseAttributes } from './utils/camel-case-attrs.js';\nimport { isTransformProp } from '../html/utils/transform.js';\nimport { renderSVG } from './utils/render.js';\nimport { getDefaultValueType } from '../dom/value-types/defaults.js';\nimport { buildLayoutProjectionTransformOrigin, buildLayoutProjectionTransform } from '../html/utils/build-projection-transform.js';\n\nvar svgVisualElement = visualElement(__assign(__assign({}, htmlConfig), { getBaseTarget: function (props, key) {\n        return props[key];\n    },\n    readValueFromInstance: function (domElement, key) {\n        var _a;\n        if (isTransformProp(key)) {\n            return ((_a = getDefaultValueType(key)) === null || _a === void 0 ? void 0 : _a.default) || 0;\n        }\n        key = !camelCaseAttributes.has(key) ? camelToDash(key) : key;\n        return domElement.getAttribute(key);\n    },\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n    build: function (_element, renderState, latestValues, projection, layoutState, options, props) {\n        var isProjectionTranform = projection.isEnabled && layoutState.isHydrated;\n        buildSVGAttrs(renderState, latestValues, projection, layoutState, options, props.transformTemplate, isProjectionTranform ? buildLayoutProjectionTransform : undefined, isProjectionTranform\n            ? buildLayoutProjectionTransformOrigin\n            : undefined);\n    }, render: renderSVG }));\n\nexport { svgVisualElement };\n","import { __assign } from 'tslib';\nimport { animations } from '../../motion/features/animations.js';\nimport { gestureAnimations } from '../../motion/features/gestures.js';\nimport { createDomVisualElement } from './create-visual-element.js';\n\n/**\n * @public\n */\nvar domAnimation = __assign(__assign({ renderer: createDomVisualElement }, animations), gestureAnimations);\n\nexport { domAnimation };\n","import { htmlVisualElement } from '../html/visual-element.js';\nimport { svgVisualElement } from '../svg/visual-element.js';\nimport { isSVGComponent } from './utils/is-svg-component.js';\n\nvar createDomVisualElement = function (Component, options) {\n    return isSVGComponent(Component)\n        ? svgVisualElement(options, { enableHardwareAcceleration: false })\n        : htmlVisualElement(options, { enableHardwareAcceleration: true });\n};\n\nexport { createDomVisualElement };\n"],"sourceRoot":""}